<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, CELL188, CELL189, CELL190, CELL191, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, CELL188, CELL189, CELL190, CELL191 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0            0            0            0            0        26.34            0            0            0            0            0            0            0            0            0            0            0        64.18       52.623 
       CELL2            0            0            0            0            0            0            0            0            0            0            0            0            0            0       19.002            0            0            0            0            0            0            0            0            0            0            0      992.506      608.137 
       CELL3            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.443            0            0            0            0            0            0            0            0            0            0            0     1531.437     1171.291 
       CELL4            0            0            0            0            0            0            0            0            0            0            0            0            0            0        7.484            0            0            0            0            0            0            0            0            0            0            0     2080.812     1488.051 
       CELL5            0            0            0            0            0            0            0            0            0            0            0            0            0            0       11.753            0            0            0            0            0            0            0            0            0            0            0     4503.328     3238.197 
       CELL6            0            0            0            0            0            0            0            0            0            0            0            0            0            0       14.871            0            0            0            0            0            0            0            0            0            0            0     2756.305     2801.309 
       CELL7            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.135            0            0            0            0            0            0            0            0            0            0            0     2337.506     2192.876 
       CELL8            0            0            0            0            0            0            0            0            0            0            0            0            0            0       38.365            0            0            0            0            0            0            0            0            0            0            0     3565.269      3360.53 
       CELL9            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.783            0            0            0            0            0            0            0            0            0            0            0     5588.921     4168.423 
      CELL10            0            0            0            0            0            0            0            0            0            0            0            0            0            0       30.208            0            0            0            0            0            0            0            0            0            0            0     4238.128     3978.028 
      CELL11            0            0            0            0            0            0            0            0            0            0            0            0            0            0        2.511            0            0            0            0            0            0            0            0            0            0            0     3016.678     2837.106 
      CELL12            0            0            0            0            0            0            0            0            0            0            0            0            0            0       41.935            0            0            0            0            0            0            0            0            0            0            0     4351.933     2679.086 
      CELL13            0            0            0            0            0            0            0            0            0            0            0            0            0            0       15.786            0            0            0            0            0            0            0            0            0            0            0     6273.426     3869.428 
      CELL14            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.856            0            0            0            0            0            0            0            0            0            0            0     1721.081      1478.29 
      CELL15            0            0            0            0            0            0            0            0            0            0            0            0            0            0        26.36            0            0            0            0            0            0            0            0            0            0            0      3465.45      3237.93 
      CELL16            0            0            0            0            0            0            0            0            0            0            0            0            0            0        36.74            0            0            0            0            0            0            0            0            0            0            0     6028.666     6139.534 
      CELL17            0            0            0            0            0            0            0            0            0            0            0            0            0            0       21.422            0            0            0            0            0            0            0            0            0            0            0     6071.112     5046.959 
      CELL18            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.001            0            0            0            0            0            0            0            0            0            0            0     5957.284     5069.507 
      CELL19            0            0            0            0            0            0            0            0            0            0            0            0            0            0         48.4            0            0            0            0            0            0            0            0            0            0            0     4504.987     3924.526 
      CELL20            0            0            0            0            0            0            0            0            0            0            0            0            0            0        50.78            0            0            0            0            0            0            0            0            0            0            0     5041.414     2564.394 
      CELL21            0            0            0            0            0            0            0            0            0            0            0            0            0            0        4.999            0            0            0            0            0            0            0            0            0            0            0     6074.491     2551.139 
      CELL22            0            0            0            0            0            0            0            0            0            0            0            0            0            0        23.97            0            0            0            0            0            0            0            0            0            0            0     5936.819     2658.258 
      CELL23            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.758            0            0            0            0            0            0            0            0            0            0            0     3029.521     1934.204 
      CELL24            0            0            0            0            0            0            0            0            0            0            0            0            0            0       46.794            0            0            0            0            0            0            0            0            0            0            0      303.805      315.373 
      CELL25            0            0            0            0            0            0            0            0            0            0            0            0            0            0        51.81            0            0            0            0            0            0            0            0            0            0            0      712.159       378.12 
      CELL26            0            0            0            0            0            0            0            0            0            0            0            0            0            0        52.45            0            0            0            0            0            0            0            0            0            0            0      563.254      372.399 
      CELL27            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      173.495       61.009 
      CELL28            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      628.966      109.055 
      CELL29            0            0            0            0            0            0            0            0            0            0            0            0            0            0       18.562            0            0            0            0            0            0            0            0            0            0            0       2102.2     1396.049 
      CELL30            0            0            0            0            0            0            0            0            0            0            0            0            0            0       19.237            0            0            0            0            0            0            0            0            0            0            0      6192.58     4373.601 
      CELL31            0            0            0            0            0            0            0            0            0            0            0            0            0            0       51.436            0            0            0            0            0            0            0            0            0            0            0     6078.644     3975.437 
      CELL32            0            0            0            0            0            0            0            0            0            0            0            0            0            0       47.565            0            0            0            0            0            0            0            0            0            0            0     6096.338     3728.732 
      CELL33            0            0            0            0            0            0            0            0            0            0            0            0            0            0       50.599            0            0            0            0            0            0            0            0            0            0            0     5609.021     2425.726 
      CELL34            0            0            0            0            0            0            0            0            0            0            0            0            0            0       51.246            0            0            0            0            0            0            0            0            0            0            0     5746.753     2780.349 
      CELL35            0            0            0            0            0            0            0            0            0            0            0            0            0            0       50.221            0            0            0            0            0            0            0            0            0            0            0     6016.919       2509.8 
      CELL36            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.031            0            0            0            0            0            0            0            0            0            0            0     6052.192     2642.532 
      CELL37            0            0            0            0            0            0            0            0            0            0            0            0            0            0       30.163            0            0            0            0            0            0            0            0            0            0            0     5919.504     3305.594 
      CELL38            0            0            0            0            0            0            0            0            0            0            0            0            0            0         46.7            0            0            0            0            0            0            0            0            0            0            0     5054.038     3300.558 
      CELL39            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.403            0            0            0            0            0            0            0            0            0            0            0     5054.432     3918.065 
      CELL40            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.657            0            0            0            0            0            0            0            0            0            0            0      4135.84     2904.713 
      CELL41            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.296            0            0            0            0            0            0            0            0            0            0            0     2287.231     1423.253 
      CELL42            0            0            0            0            0            0            0            0            0            0            0            0            0            0       19.033            0            0            0            0            0            0            0            0            0            0            0       94.595       50.548 
      CELL43            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      313.047      135.859 
      CELL44            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3647.695      567.574 
      CELL45            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1585.067        92.07 
      CELL46            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       83.729        7.532 
      CELL47            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.013            0            0            0            0            0            0            0            0            0            0            0      141.797        93.15 
      CELL48            0            0            0            0            0            0            0            0            0            0            0            0            0            0       13.496            0            0            0            0            0            0            0            0            0            0            0     2503.585     1059.617 
      CELL49            0            0            0            0            0            0            0            0            0            0            0            0            0            0       46.954            0            0            0            0            0            0            0            0            0            0            0      6073.73     3000.338 
      CELL50            0            0            0            0            0            0            0            0            0            0            0            0            0            0       46.093            0            0            0            0            0            0            0            0            0            0            0     5691.297     2544.919 
      CELL51            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4836.588     2702.225 
      CELL52            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5781.675     2932.911 
      CELL53            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.617            0            0            0            0            0            0            0            0            0            0            0      6061.83     2778.728 
      CELL54            0            0            0            0            0            0            0            0            0            0            0            0            0            0       11.756            0            0            0            0            0            0            0            0            0            0            0     5981.745     1490.309 
      CELL55            0            0            0            0            0            0            0            0            0            0            0            0            0            0       22.493            0            0            0            0            0            0            0            0            0            0            0     5797.801     3151.838 
      CELL56            0            0            0            0            0            0            0            0            0            0            0            0            0            0       42.331            0            0            0            0            0            0            0            0            0            0            0      5934.83      2794.91 
      CELL57            0            0            0            0            0            0            0            0            0            0            0            0            0            0       30.686            0            0            0            0            0            0            0            0            0            0            0     5483.941     2398.174 
      CELL58            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.845            0            0            0            0            0            0            0            0            0            0            0     3893.343     2350.168 
      CELL59            0            0            0            0            0            0            0            0            0            0            0            0            0            0        4.083            0            0            0            0            0            0            0            0            0            0            0     4195.429     3464.096 
      CELL60            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.838            0            0            0            0            0            0            0            0            0            0            0      3986.81     2367.088 
      CELL61            0            0            0            0            0            0            0            0            0            0            0            0            0            0        7.179            0            0            0            0            0            0            0            0            0            0            0     1299.222      376.501 
      CELL62            0            0            0            0            0            0            0            0            0            0            0            0            0            0        5.741            0            0            0            0            0            0            0            0            0            0            0     3381.305     1628.079 
      CELL63            0            0            0            0            0            0            0            0            0            0            0            0            0            0        6.156            0            0            0            0            0            0            0            0            0            0            0     3439.031     2253.962 
      CELL64            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2437.867      984.313 
      CELL65            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1996.717     1986.663 
      CELL66            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      809.204       175.98 
      CELL67            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      847.906      188.961 
      CELL68            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.038            0            0            0            0            0            0            0            0            0            0            0      392.061      267.116 
      CELL69            0            0            0            0            0            0            0            0            0            0            0            0            0            0       35.518            0            0            0            0            0            0            0            0            0            0            0      281.063      180.379 
      CELL70            0            0            0            0            0            0            0            0            0            0            0            0            0            0       39.905            0            0            0            0            0            0            0            0            0            0            0     5095.415     2422.938 
      CELL71            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.202            0            0            0            0            0            0            0            0            0            0            0     2974.226     1256.355 
      CELL72            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.855            0            0            0            0            0            0            0            0            0            0            0      4296.08     2173.585 
      CELL73            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5656.779     3453.091 
      CELL74            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.496            0            0            0            0            0            0            0            0            0            0            0       5789.7     2718.842 
      CELL75            0            0            0            0            0            0            0            0            0            0            0            0            0            0       17.321            0            0            0            0            0            0            0            0            0            0            0     5885.307      1902.18 
      CELL76            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.349            0            0            0            0            0            0            0            0            0            0            0     5726.379     2885.237 
      CELL77            0            0            0            0            0            0            0            0            0            0            0            0            0            0        49.12            0            0            0            0            0            0            0            0            0            0            0     6075.285     4041.749 
      CELL78            0            0            0            0            0            0            0            0            0            0            0            0            0            0        52.01            0            0            0            0            0            0            0            0            0            0            0     5882.198     4131.687 
      CELL79            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.573            0            0            0            0            0            0            0            0            0            0            0     5586.597       3745.6 
      CELL80            0            0            0            0            0            0            0            0            0            0            0            0            0            0       39.353            0            0            0            0            0            0            0            0            0            0            0     5067.132     3242.364 
      CELL81            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.332            0            0            0            0            0            0            0            0            0            0            0     6011.642     3553.807 
      CELL82            0            0            0            0            0            0            0            0            0            0            0            0            0            0       33.474            0            0            0            0            0            0            0            0            0            0            0     4838.544     2103.026 
      CELL83            0            0            0            0            0            0            0            0            0            0            0            0            0            0        20.85            0            0            0            0            0            0            0            0            0            0            0     5099.666     1912.106 
      CELL84            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.079            0            0            0            0            0            0            0            0            0            0            0     5810.907     4339.714 
      CELL85            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3921.342     3567.647 
      CELL86            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2730.038     1528.822 
      CELL87            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      582.014      137.472 
      CELL88            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2182.147      661.211 
      CELL89            0            0            0            0            0            0            0            0            0            0            0            0            0            0        10.24            0            0            0            0            0            0            0            0            0            0            0      678.545      615.296 
      CELL90            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.261            0            0            0            0            0            0            0            0            0            0            0       453.35      217.362 
      CELL91            0            0            0            0            0            0            0            0            0            0            0            0            0            0       30.936            0            0            0            0            0            0            0            0            0            0            0     3285.797     1129.157 
      CELL92            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4918.667     1769.802 
      CELL93            0            0            0            0            0            0            0            0            0            0            0            0            0            0       31.204            0            0            0            0            0            0            0            0            0            0            0     5222.482     2879.653 
      CELL94            0            0            0            0            0            0            0            0            0            0            0            0            0            0       16.395            0            0            0            0            0            0            0            0            0            0            0     5255.178     1960.417 
      CELL95            0            0            0            0            0            0            0            0            0            0            0            0            0            0       47.104            0            0            0            0            0            0            0            0            0            0            0     5978.464      2413.93 
      CELL96            0            0            0            0            0            0            0            0            0            0            0            0            0            0       47.139            0            0            0            0            0            0            0            0            0            0            0     5761.975     4278.763 
      CELL97            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.299            0            0            0            0            0            0            0            0            0            0            0     5739.902     3366.199 
      CELL98            0            0            0            0            0            0            0            0            0            0            0            0            0            0       18.225            0            0            0            0            0            0            0            0            0            0            0     5826.795      3501.91 
      CELL99            0            0            0            0            0            0            0            0            0            0            0            0            0            0        33.23            0            0            0            0            0            0            0            0            0            0            0     5904.816     3983.497 
     CELL100            0            0            0            0            0            0            0            0            0            0            0            0            0            0       39.952            0            0            0            0            0            0            0            0            0            0            0     5981.642      4436.62 
     CELL101            0            0            0            0            0            0            0            0            0            0            0            0            0            0       44.196            0            0            0            0            0            0            0            0            0            0            0     5454.552     2588.466 
     CELL102            0            0            0            0            0            0            0            0            0            0            0            0            0            0       12.346            0            0            0            0            0            0            0            0            0            0            0     5013.074      2142.02 
     CELL103            0            0            0            0            0            0            0            0            0            0            0            0            0            0       13.836            0            0            0            0            0            0            0            0            0            0            0     5405.771     1946.344 
     CELL104            0            0            0            0            0            0            0            0            0            0            0            0            0            0       28.994            0            0            0            0            0            0            0            0            0            0            0     5839.247     2284.039 
     CELL105            0            0            0            0            0            0            0            0            0            0            0            0            0            0       11.933            0            0            0            0            0            0            0            0            0            0            0     5379.445      2823.52 
     CELL106            0            0            0            0            0            0            0            0            0            0            0            0            0            0       11.858            0            0            0            0            0            0            0            0            0            0            0     4772.003     1237.554 
     CELL107            0            0            0            0            0            0            0            0            0            0            0            0            0            0       13.525            0            0            0            0            0            0            0            0            0            0            0     5348.644     3551.914 
     CELL108            0            0            0            0            0            0            0            0            0            0            0            0            0            0        3.215            0            0            0            0            0            0            0            0            0            0            0     2617.177     2373.501 
     CELL109            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      514.533      547.077 
     CELL110            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      673.438      572.879 
     CELL111            0            0            0            0            0            0            0            0            0            0            0            0            0            0        5.074            0            0            0            0            0            0            0            0            0            0            0        2.049         1.57 
     CELL112            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.159            0            0            0            0            0            0            0            0            0            0            0     1230.885      470.112 
     CELL113            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4277.824      944.645 
     CELL114            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5500.727     2544.125 
     CELL115            0            0            0            0            0            0            0            0            0            0            0            0            0            0       19.896            0            0            0            0            0            0            0            0            0            0            0     5578.548     3844.043 
     CELL116            0            0            0            0            0            0            0            0            0            0            0            0            0            0       50.329            0            0            0            0            0            0            0            0            0            0            0     5422.684     3064.581 
     CELL117            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.495            0            0            0            0            0            0            0            0            0            0            0     5592.149     2982.575 
     CELL118            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.326            0            0            0            0            0            0            0            0            0            0            0      5624.51     3776.986 
     CELL119            0            0            0            0            0            0            0            0            0            0            0            0            0            0       52.484            0            0            0            0            0            0            0            0            0            0            0     5151.232     2963.262 
     CELL120            0            0            0            0            0            0            0            0            0            0            0            0            0            0       50.874            0            0            0            0            0            0            0            0            0            0            0      5565.31      3270.96 
     CELL121            0            0            0            0            0            0            0            0            0            0            0            0            0            0       13.103            0            0            0            0            0            0            0            0            0            0            0     5719.171       2700.1 
     CELL122            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.525            0            0            0            0            0            0            0            0            0            0            0     5841.548     2566.858 
     CELL123            0            0            0            0            0            0            0            0            0            0            0            0            0            0       39.829            0            0            0            0            0            0            0            0            0            0            0     5830.181     2562.992 
     CELL124            0            0            0            0            0            0            0            0            0            0            0            0            0            0       22.475            0            0            0            0            0            0            0            0            0            0            0     5577.797     2506.565 
     CELL125            0            0            0            0            0            0            0            0            0            0            0            0            0            0        14.49            0            0            0            0            0            0            0            0            0            0            0     2235.267      477.019 
     CELL126            0            0            0            0            0            0            0            0            0            0            0            0            0            0       17.343            0            0            0            0            0            0            0            0            0            0            0      790.941      170.571 
     CELL127            0            0            0            0            0            0            0            0            0            0            0            0            0            0       21.738            0            0            0            0            0            0            0            0            0            0            0     3569.061     1394.299 
     CELL128            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.273            0            0            0            0            0            0            0            0            0            0            0     1310.243      625.763 
     CELL129            0            0            0            0            0            0            0            0            0            0            0            0            0            0       22.854            0            0            0            0            0            0            0            0            0            0            0      331.831       68.456 
     CELL130            0            0            0            0            0            0            0            0            0            0            0            0            0            0       12.602            0            0            0            0            0            0            0            0            0            0            0     1526.493       930.82 
     CELL131            0            0            0            0            0            0            0            0            0            0            0            0            0            0       11.058            0            0            0            0            0            0            0            0            0            0            0     2225.378     2259.079 
     CELL132            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        60.82        28.25 
     CELL133            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.758            0            0            0            0            0            0            0            0            0            0            0     2263.984     1771.855 
     CELL134            0            0            0            0            0            0            0            0            0            0            0            0            0            0       50.045            0            0            0            0            0            0            0            0            0            0            0     5299.911     2985.465 
     CELL135            0            0            0            0            0            0            0            0            0            0            0            0            0            0       52.495            0            0            0            0            0            0            0            0            0            0            0     5396.796     1839.736 
     CELL136            0            0            0            0            0            0            0            0            0            0            0            0            0            0       52.792            0            0            0            0            0            0            0            0            0            0            0     5835.757     2588.841 
     CELL137            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.179            0            0            0            0            0            0            0            0            0            0            0     5806.593     1826.933 
     CELL138            0            0            0            0            0            0            0            0            0            0            0            0            0            0       10.986            0            0            0            0            0            0            0            0            0            0            0     5697.652     1374.259 
     CELL139            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.396            0            0            0            0            0            0            0            0            0            0            0     5125.516     2504.594 
     CELL140            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.643            0            0            0            0            0            0            0            0            0            0            0     3519.344     1426.883 
     CELL141            0            0            0            0            0            0            0            0            0            0            0            0            0            0       49.886            0            0            0            0            0            0            0            0            0            0            0     5682.352     3400.482 
     CELL142            0            0            0            0            0            0            0            0            0            0            0            0            0            0        21.97            0            0            0            0            0            0            0            0            0            0            0     5898.059     3202.712 
     CELL143            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.458            0            0            0            0            0            0            0            0            0            0            0     5672.281     3154.045 
     CELL144            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.155            0            0            0            0            0            0            0            0            0            0            0      5708.71     2293.305 
     CELL145            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.422            0            0            0            0            0            0            0            0            0            0            0     5043.854     1983.142 
     CELL146            0            0            0            0            0            0            0            0            0            0            0            0            0            0       13.893            0            0            0            0            0            0            0            0            0            0            0      348.237       84.891 
     CELL147            0            0            0            0            0            0            0            0            0            0            0            0            0            0        18.35            0            0            0            0            0            0            0            0            0            0            0      258.533      129.519 
     CELL148            0            0            0            0            0            0            0            0            0            0            0            0            0            0       14.009            0            0            0            0            0            0            0            0            0            0            0      119.681      124.242 
     CELL149            0            0            0            0            0            0            0            0            0            0            0            0            0            0       31.104            0            0            0            0            0            0            0            0            0            0            0     3085.569     2178.896 
     CELL150            0            0            0            0            0            0            0            0            0            0            0            0            0            0       55.146            0            0            0            0            0            0            0            0            0            0            0     5824.633     3707.042 
     CELL151            0            0            0            0            0            0            0            0            0            0            0            0            0            0       52.686            0            0            0            0            0            0            0            0            0            0            0     6029.006     4138.238 
     CELL152            0            0            0            0            0            0            0            0            0            0            0            0            0            0       46.484            0            0            0            0            0            0            0            0            0            0            0     5690.244     1378.749 
     CELL153            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.666            0            0            0            0            0            0            0            0            0            0            0     5737.022      1301.33 
     CELL154            0            0            0            0            0            0            0            0            0            0            0            0            0            0       24.016            0            0            0            0            0            0            0            0            0            0            0     5807.393       892.93 
     CELL155            0            0            0            0            0            0            0            0            0            0            0            0            0            0       48.899            0            0            0            0            0            0            0            0            0            0            0     5642.111     1406.581 
     CELL156            0            0            0            0            0            0            0            0            0            0            0            0            0            0       47.502            0            0            0            0            0            0            0            0            0            0            0     5395.108     1383.996 
     CELL157            0            0            0            0            0            0            0            0            0            0            0            0            0            0       31.718            0            0            0            0            0            0            0            0            0            0            0     6054.112     2555.091 
     CELL158            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.913            0            0            0            0            0            0            0            0            0            0            0     5920.003     3251.014 
     CELL159            0            0            0            0            0            0            0            0            0            0            0            0            0            0       31.252            0            0            0            0            0            0            0            0            0            0            0      5938.55     3062.121 
     CELL160            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.573            0            0            0            0            0            0            0            0            0            0            0     5750.723     2988.042 
     CELL161            0            0            0            0            0            0            0            0            0            0            0            0            0            0        24.81            0            0            0            0            0            0            0            0            0            0            0     5146.181     2004.557 
     CELL162            0            0            0            0            0            0            0            0            0            0            0            0            0            0       61.713            0            0            0            0            0            0            0            0            0            0            0      540.282      389.765 
     CELL163            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.839            0            0            0            0            0            0            0            0            0            0            0      113.295       64.829 
     CELL164            0            0            0            0            0            0            0            0            0            0            0            0            0            0       58.285            0            0            0            0            0            0            0            0            0            0            0     1451.593     1096.176 
     CELL165            0            0            0            0            0            0            0            0            0            0            0            0            0            0       42.352            0            0            0            0            0            0            0            0            0            0            0        236.6       88.368 
     CELL166            0            0            0            0            0            0            0            0            0            0            0            0            0            0        47.57            0            0            0            0            0            0            0            0            0            0            0      468.316      121.141 
     CELL167            0            0            0            0            0            0            0            0            0            0            0            0            0            0        31.22            0            0            0            0            0            0            0            0            0            0            0     1474.889        285.5 
     CELL168            0            0            0            0            0            0            0            0            0            0            0            0            0            0       53.816            0            0            0            0            0            0            0            0            0            0            0     5320.359     2414.663 
     CELL169            0            0            0            0            0            0            0            0            0            0            0            0            0            0       26.622            0            0            0            0            0            0            0            0            0            0            0     6217.241     3382.252 
     CELL170            0            0            0            0            0            0            0            0            0            0            0            0            0            0       41.704            0            0            0            0            0            0            0            0            0            0            0     6075.405     2654.721 
     CELL171            0            0            0            0            0            0            0            0            0            0            0            0            0            0       11.525            0            0            0            0            0            0            0            0            0            0            0     6136.499     2424.369 
     CELL172            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.988            0            0            0            0            0            0            0            0            0            0            0       6120.9     2475.803 
     CELL173            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.508            0            0            0            0            0            0            0            0            0            0            0     6165.174     4055.073 
     CELL174            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.095            0            0            0            0            0            0            0            0            0            0            0     5879.346      2622.99 
     CELL175            0            0            0            0            0            0            0            0            0            0            0            0            0            0       17.338            0            0            0            0            0            0            0            0            0            0            0     1301.707      853.904 
     CELL176            0            0            0            0            0            0            0            0            0            0            0            0            0            0        54.27            0            0            0            0            0            0            0            0            0            0            0     3806.168     2180.343 
     CELL177            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     6013.076     3594.126 
     CELL178            0            0            0            0            0            0            0            0            0            0            0            0            0            0       45.947            0            0            0            0            0            0            0            0            0            0            0     6131.095      3376.43 
     CELL179            0            0            0            0            0            0            0            0            0            0            0            0            0            0       44.574            0            0            0            0            0            0            0            0            0            0            0     5785.131     1752.915 
     CELL180            0            0            0            0            0            0            0            0            0            0            0            0            0            0       24.676            0            0            0            0            0            0            0            0            0            0            0     6213.598      2228.68 
     CELL181            0            0            0            0            0            0            0            0            0            0            0            0            0            0       46.767            0            0            0            0            0            0            0            0            0            0            0     5455.029     2683.268 
     CELL182            0            0            0            0            0            0            0            0            0            0            0            0            0            0        37.37            0            0            0            0            0            0            0            0            0            0            0     4064.703     2262.123 
     CELL183            0            0            0            0            0            0            0            0            0            0            0            0            0            0       19.269            0            0            0            0            0            0            0            0            0            0            0       515.63      237.332 
     CELL184            0            0            0            0            0            0            0            0            0            0            0            0            0            0       53.455            0            0            0            0            0            0            0            0            0            0            0      114.612        85.58 
     CELL185            0            0            0            0            0            0            0            0            0            0            0            0            0            0       49.884            0            0            0            0            0            0            0            0            0            0            0     4237.377     2004.615 
     CELL186            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     6435.282     2606.842 
     CELL187            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.528            0            0            0            0            0            0            0            0            0            0            0     5340.375     1359.701 
     CELL188            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.527            0            0            0            0            0            0            0            0            0            0            0     3861.039     1479.108 
     CELL189            0            0            0            0            0            0            0            0            0            0            0            0            0            0       31.565            0            0            0            0            0            0            0            0            0            0            0      721.119      406.283 
     CELL190            0            0            0            0            0            0            0            0            0            0            0            0            0            0       62.426            0            0            0            0            0            0            0            0            0            0            0      370.586      212.016 
     CELL191            0            0            0            0            0            0            0            0            0            0            0            0            0            0       52.888            0            0            0            0            0            0            0            0            0            0            0     1319.101      653.071 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5287.602            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
