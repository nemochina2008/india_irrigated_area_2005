<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0            0       18.526            0            0      106.793            0            0            0            0            0            0            0            0            0            0            0        6.268        6.268 
       CELL2            0            0            0            0            0            0            0            0            0            0            0        1.866            0            0            0            0            0            0            0            0            0            0            0            0            0            0       99.829        31.78 
       CELL3            0            0            0            0            0            0            0            0            0            0            0        0.714            0            0        4.154            0            0            0            0            0            0            0            0            0            0            0       70.565       70.565 
       CELL4            0            0            0            0            0            0            0            0            0            0            0        5.172            0            0       30.739            0            0            0            0            0            0            0            0            0            0            0       409.22       409.22 
       CELL5            0            0            0            0            0            0            0            0            0            0            0       23.161            0            0       137.84            0            0            0            0            0            0            0            0            0            0            0        92.65       92.651 
       CELL6            0            0            0            0            0            0            0            0            0            0            0        0.544            0            0        3.215            0            0            0            0            0            0            0            0            0            0            0      143.073      143.076 
       CELL7            0            0            0            0            0            0            0            0            0            0            0        5.071            0            0        29.89            0            0            0            0            0            0            0            0            0            0            0      645.284      645.284 
       CELL8            0            0            0            0            0            0            0            0            0            0            0         16.9            0            0            0            0            0            0            0            0            0            0            0            0            0            0      761.738      762.138 
       CELL9            0            0            0            0            0            0            0            0            0            0            0       15.493            0            0            0            0            0            0            0            0            0            0            0            0            0            0       69.995       70.375 
      CELL10            0            0            0            0            0            0            0            0            0            0            0        2.585            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.369       70.511 
      CELL11            0            0            0            0            0            0            0            0            0            0            0        1.237            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.696        8.731 
      CELL12            0            0            0            0            0            0            0            0            0            0            0        3.673            0            0       21.773            0            0            0            0            0            0            0            0            0            0            0      1004.02      1004.02 
      CELL13            0            0            0            0            0            0            0            0            0            0            0       12.743            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1639.189     1639.512 
      CELL14            0            0            0            0            0            0            0            0            0            0            0       10.457            0            0            0            0            0            0            0            0            0            0            0            0            0            0      251.733      252.007 
      CELL15            0            0            0            0            0            0            0            0            0            0            0        8.524            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.902       32.267 
      CELL16            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.363       10.954 
      CELL17            0            0            0            0            0            0            0            0            0            0            0       12.157            0            0            0            0            0            0            0            0            0            0            0            0            0            0      218.472      409.328 
      CELL18            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      464.168      464.168 
      CELL19            0            0            0            0            0            0            0            0            0            0            0         8.37            0            0            0            0            0            0            0            0            0            0            0            0            0            0      565.078       584.66 
      CELL20            0            0            0            0            0            0            0            0            0            0            0       15.298            0            0            0            0            0            0            0            0            0            0            0            0            0            0       228.48      373.394 
      CELL21            0            0            0            0            0            0            0            0            0            0            0        13.43            0            0            0            0            0            0            0            0            0            0            0            0            0            0      201.232      232.608 
      CELL22            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.013        8.013 
      CELL23            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      111.624       98.053 
      CELL24            0            0            0            0            0            0            0            0            0            0            0        9.045            0            0            0            0            0            0            0            0            0            0            0            0            0            0       217.13      356.485 
      CELL25            0            0            0            0            0            0            0            0            0            0            0        5.609            0            0            0            0            0            0            0            0            0            0            0            0            0            0        336.2      425.515 
      CELL26            0            0            0            0            0            0            0            0            0            0            0        7.769            0            0            0            0            0            0            0            0            0            0            0            0            0            0      214.632      339.278 
      CELL27            0            0            0            0            0            0            0            0            0            0            0       25.465            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2554.698     2953.143 
      CELL28            0            0            0            0            0            0            0            0            0            0            0       25.268            0            0            0            0            0            0            0            0            0            0            0            0            0            0      872.314     1268.094 
      CELL29            0            0            0            0            0            0            0            0            0            0            0       31.598            0            0            0            0            0            0            0            0            0            0            0            0            0            0      686.898      687.478 
      CELL30            0            0            0            0            0            0            0            0            0            0            0       33.928            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1310.228     1310.818 
      CELL31            0            0            0            0            0            0            0            0            0            0            0       36.032            0            0      210.994            0            0            0            0            0            0            0            0            0            0            0      246.305      246.305 
      CELL32            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.638        24.09 
      CELL33            0            0            0            0            0            0            0            0            0            0            0        6.568            0            0            0            0            0            0            0            0            0            0            0            0            0            0      663.079      764.266 
      CELL34            0            0            0            0            0            0            0            0            0            0            0        9.978            0            0            0            0            0            0            0            0            0            0            0            0            0            0      312.373      466.033 
      CELL35            0            0            0            0            0            0            0            0            0            0            0        6.779            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1372.025     1477.728 
      CELL36            0            0            0            0            0            0            0            0            0            0            0        9.081            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1276.761     1417.884 
      CELL37            0            0            0            0            0            0            0            0            0            0            0       19.116            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4977.269     5272.134 
      CELL38            0            0            0            0            0            0            0            0            0            0            0       15.009            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4070.106     4304.406 
      CELL39            0            0            0            0            0            0            0            0            0            0            0       10.504            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1331.981     1497.921 
      CELL40            0            0            0            0            0            0            0            0            0            0            0       32.119            0            0            0            0            0            0            0            0            0            0            0            0            0            0      3265.04     4301.055 
      CELL41            0            0            0            0            0            0            0            0            0            0            0        18.57            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1229.128     1521.483 
      CELL42            0            0            0            0            0            0            0            0            0            0            0       13.474            0            0       78.633            0            0            0            0            0            0            0            0            0            0            0       44.463       38.202 
      CELL43            0            0            0            0            0            0            0            0            0            0            0       33.064            0            0      188.151            0            0            0            0            0            0            0            0            0            0            0      246.069      135.001 
      CELL44            0            0            0            0            0            0            0            0            0            0            0       41.421            0            0       235.93            0            0            0            0            0            0            0            0            0            0            0      173.876       88.423 
      CELL45            0            0            0            0            0            0            0            0            0            0            0       17.179            0            0            0            0            0            0            0            0            0            0            0            0            0            0      225.099      255.233 
      CELL46            0            0            0            0            0            0            0            0            0            0            0       15.897            0            0            0            0            0            0            0            0            0            0            0            0            0            0       999.36     1240.331 
      CELL47            0            0            0            0            0            0            0            0            0            0            0       14.452            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1438.491     1662.682 
      CELL48            0            0            0            0            0            0            0            0            0            0            0       13.558            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1833.564     2038.713 
      CELL49            0            0            0            0            0            0            0            0            0            0            0       13.229            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2031.554     2234.195 
      CELL50            0            0            0            0            0            0            0            0            0            0            0       11.007            0            0            0            0            0            0            0            0            0            0            0            0            0            0       3687.9     3858.518 
      CELL51            0            0            0            0            0            0            0            0            0            0            0       23.657            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2010.532     2374.372 
      CELL52            0            0            0            0            0            0            0            0            0            0            0       25.447            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2459.464     2850.319 
      CELL53            0            0            0            0            0            0            0            0            0            0            0        16.57            0            0            0            0            0            0            0            0            0            0            0            0            0            0      4050.04     4306.242 
      CELL54            0            0            0            0            0            0            0            0            0            0            0        4.955            0            0       28.939            0            0            0            0            0            0            0            0            0            0            0      664.247      664.247 
      CELL55            0            0            0            0            0            0            0            0            0            0            0       20.801            0            0      118.758            0            0            0            0            0            0            0            0            0            0            0     2235.336     2235.336 
      CELL56            0            0            0            0            0            0            0            0            0            0            0       26.071            0            0      146.828            0            0            0            0            0            0            0            0            0            0            0     4466.035     4466.035 
      CELL57            0            0            0            0            0            0            0            0            0            0            0       35.137            0            0       198.11            0            0            0            0            0            0            0            0            0            0            0     4182.455     3453.144 
      CELL58            0            0            0            0            0            0            0            0            0            0            0       29.826            0            0      170.252            0            0            0            0            0            0            0            0            0            0            0       78.815        73.65 
      CELL59            0            0            0            0            0            0            0            0            0            0            0       12.086            0            0            0            0            0            0            0            0            0            0            0            0            0            0      245.949      422.632 
      CELL60            0            0            0            0            0            0            0            0            0            0            0       11.536            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1726.337     1901.001 
      CELL61            0            0            0            0            0            0            0            0            0            0            0       18.295            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2278.345     2554.144 
      CELL62            0            0            0            0            0            0            0            0            0            0            0       16.168            0            0            0            0            0            0            0            0            0            0            0            0            0            0      2936.94     3183.819 
      CELL63            0            0            0            0            0            0            0            0            0            0            0       10.129            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2725.414     2880.538 
      CELL64            0            0            0            0            0            0            0            0            0            0            0       21.957            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1220.666     1558.429 
      CELL65            0            0            0            0            0            0            0            0            0            0            0       23.142            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1062.883     1418.842 
      CELL66            0            0            0            0            0            0            0            0            0            0            0        5.966            0            0            0            0            0            0            0            0            0            0            0            0            0            0       928.87     1022.588 
      CELL67            0            0            0            0            0            0            0            0            0            0            0       14.445            0            0        82.67            0            0            0            0            0            0            0            0            0            0            0     2503.072     2503.072 
      CELL68            0            0            0            0            0            0            0            0            0            0            0       31.579            0            0      180.008            0            0            0            0            0            0            0            0            0            0            0     4506.248     4506.248 
      CELL69            0            0            0            0            0            0            0            0            0            0            0       22.743            0            0      129.924            0            0            0            0            0            0            0            0            0            0            0     3736.605     3736.606 
      CELL70            0            0            0            0            0            0            0            0            0            0            0       42.561            0            0      240.126            0            0            0            0            0            0            0            0            0            0            0     1907.965     1907.966 
      CELL71            0            0            0            0            0            0            0            0            0            0            0       19.589            0            0      103.253            0            0            0            0            0            0            0            0            0            0            0      200.369      200.369 
      CELL72            0            0            0            0            0            0            0            0            0            0            0        8.573            0            0       46.689            0            0            0            0            0            0            0            0            0            0            0      998.646      998.646 
      CELL73            0            0            0            0            0            0            0            0            0            0            0        11.23            0            0       61.195            0            0            0            0            0            0            0            0            0            0            0     2920.435     2920.435 
      CELL74            0            0            0            0            0            0            0            0            0            0            0       22.286            0            0      122.721            0            0            0            0            0            0            0            0            0            0            0     3644.546     3644.546 
      CELL75            0            0            0            0            0            0            0            0            0            0            0       19.599            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2911.506     2748.446 
      CELL76            0            0            0            0            0            0            0            0            0            0            0       16.139            0            0       90.934            0            0            0            0            0            0            0            0            0            0            0     1240.802     1240.802 
      CELL77            0            0            0            0            0            0            0            0            0            0            0       28.715            0            0      161.677            0            0            0            0            0            0            0            0            0            0            0     1856.791     1609.291 
      CELL78            0            0            0            0            0            0            0            0            0            0            0       13.345            0            0       75.195            0            0            0            0            0            0            0            0            0            0            0     2523.907     1927.684 
      CELL79            0            0            0            0            0            0            0            0            0            0            0       17.792            0            0      100.425            0            0            0            0            0            0            0            0            0            0            0     3248.004     3248.004 
      CELL80            0            0            0            0            0            0            0            0            0            0            0       35.127            0            0      195.916            0            0            0            0            0            0            0            0            0            0            0      4201.89     4201.891 
      CELL81            0            0            0            0            0            0            0            0            0            0            0       41.506            0            0      231.578            0            0            0            0            0            0            0            0            0            0            0     4102.568     4102.568 
      CELL82            0            0            0            0            0            0            0            0            0            0            0       32.325            0            0      180.375            0            0            0            0            0            0            0            0            0            0            0     1433.979     1433.979 
      CELL83            0            0            0            0            0            0            0            0            0            0            0       22.328            0            0      118.995            0            0            0            0            0            0            0            0            0            0            0       496.93       496.93 
      CELL84            0            0            0            0            0            0            0            0            0            0            0       13.956            0            0       75.206            0            0            0            0            0            0            0            0            0            0            0     1456.598     1183.549 
      CELL85            0            0            0            0            0            0            0            0            0            0            0        8.838            0            0       48.174            0            0            0            0            0            0            0            0            0            0            0      5163.58      5163.58 
      CELL86            0            0            0            0            0            0            0            0            0            0            0       15.753            0            0       86.868            0            0            0            0            0            0            0            0            0            0            0     5284.119     5284.119 
      CELL87            0            0            0            0            0            0            0            0            0            0            0       19.464            0            0      108.698            0            0            0            0            0            0            0            0            0            0            0     3130.784     2858.586 
      CELL88            0            0            0            0            0            0            0            0            0            0            0       26.574            0            0      149.849            0            0            0            0            0            0            0            0            0            0            0     4320.642     2378.351 
      CELL89            0            0            0            0            0            0            0            0            0            0            0       29.646            0            0      167.179            0            0            0            0            0            0            0            0            0            0            0     3242.492      2783.86 
      CELL90            0            0            0            0            0            0            0            0            0            0            0       29.302            0            0      165.244            0            0            0            0            0            0            0            0            0            0            0     2815.696      2361.52 
      CELL91            0            0            0            0            0            0            0            0            0            0            0       32.293            0            0       182.04            0            0            0            0            0            0            0            0            0            0            0     3674.133     3460.323 
      CELL92            0            0            0            0            0            0            0            0            0            0            0       30.253            0            0      168.703            0            0            0            0            0            0            0            0            0            0            0     4633.792     4402.369 
      CELL93            0            0            0            0            0            0            0            0            0            0            0       37.555            0            0      209.368            0            0            0            0            0            0            0            0            0            0            0     4515.279     3898.107 
      CELL94            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1944.384      878.901 
      CELL95            0            0            0            0            0            0            0            0            0            0            0       27.968            0            0      149.373            0            0            0            0            0            0            0            0            0            0            0      140.853      140.854 
      CELL96            0            0            0            0            0            0            0            0            0            0            0       19.817            0            0      106.944            0            0            0            0            0            0            0            0            0            0            0     2876.116       923.79 
      CELL97            0            0            0            0            0            0            0            0            0            0            0       15.962            0            0       88.053            0            0            0            0            0            0            0            0            0            0            0     3828.183     3658.153 
      CELL98            0            0            0            0            0            0            0            0            0            0            0        26.54            0            0      146.612            0            0            0            0            0            0            0            0            0            0            0     4597.507     2548.613 
      CELL99            0            0            0            0            0            0            0            0            0            0            0       23.029            0            0       130.04            0            0            0            0            0            0            0            0            0            0            0     4213.019     3581.438 
     CELL100            0            0            0            0            0            0            0            0            0            0            0       17.275            0            0       97.511            0            0            0            0            0            0            0            0            0            0            0     4337.521     4095.042 
     CELL101            0            0            0            0            0            0            0            0            0            0            0       27.049            0            0       152.63            0            0            0            0            0            0            0            0            0            0            0     4309.954      2643.95 
     CELL102            0            0            0            0            0            0            0            0            0            0            0       27.577            0            0      157.399            0            0            0            0            0            0            0            0            0            0            0     4822.146      772.938 
     CELL103            0            0            0            0            0            0            0            0            0            0            0       29.352            0            0      165.659            0            0            0            0            0            0            0            0            0            0            0      919.838      465.128 
     CELL104            0            0            0            0            0            0            0            0            0            0            0       27.458            0            0      154.967            0            0            0            0            0            0            0            0            0            0            0     3274.434     2850.417 
     CELL105            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      915.029      367.149 
     CELL106            0            0            0            0            0            0            0            0            0            0            0       28.091            0            0      151.845            0            0            0            0            0            0            0            0            0            0            0      936.414      936.414 
     CELL107            0            0            0            0            0            0            0            0            0            0            0        29.35            0            0      162.167            0            0            0            0            0            0            0            0            0            0            0     3044.401      2920.47 
     CELL108            0            0            0            0            0            0            0            0            0            0            0         26.7            0            0      151.146            0            0            0            0            0            0            0            0            0            0            0     3636.798     2248.268 
     CELL109            0            0            0            0            0            0            0            0            0            0            0       24.731            0            0       139.93            0            0            0            0            0            0            0            0            0            0            0     4230.212     3337.498 
     CELL110            0            0            0            0            0            0            0            0            0            0            0       14.004            0            0       79.173            0            0            0            0            0            0            0            0            0            0            0     4690.732     3735.353 
     CELL111            0            0            0            0            0            0            0            0            0            0            0        28.12            0            0      158.891            0            0            0            0            0            0            0            0            0            0            0     4364.656     3343.772 
     CELL112            0            0            0            0            0            0            0            0            0            0            0       28.294            0            0      161.608            0            0            0            0            0            0            0            0            0            0            0     4842.359      447.657 
     CELL113            0            0            0            0            0            0            0            0            0            0            0       21.799            0            0      123.194            0            0            0            0            0            0            0            0            0            0            0      4085.61      908.409 
     CELL114            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       559.07       53.015 
     CELL115            0            0            0            0            0            0            0            0            0            0            0       25.441            0            0      137.794            0            0            0            0            0            0            0            0            0            0            0      968.755      968.755 
     CELL116            0            0            0            0            0            0            0            0            0            0            0       29.581            0            0      163.706            0            0            0            0            0            0            0            0            0            0            0     1392.063     1195.398 
     CELL117            0            0            0            0            0            0            0            0            0            0            0       20.944            0            0      116.029            0            0            0            0            0            0            0            0            0            0            0     3849.124     3001.312 
     CELL118            0            0            0            0            0            0            0            0            0            0            0        21.66            0            0      119.962            0            0            0            0            0            0            0            0            0            0            0      4728.14     3854.028 
     CELL119            0            0            0            0            0            0            0            0            0            0            0       27.218            0            0      152.252            0            0            0            0            0            0            0            0            0            0            0     5033.806     3658.943 
     CELL120            0            0            0            0            0            0            0            0            0            0            0       14.287            0            0       79.886            0            0            0            0            0            0            0            0            0            0            0     4810.887      3605.08 
     CELL121            0            0            0            0            0            0            0            0            0            0            0        27.69            0            0      156.593            0            0            0            0            0            0            0            0            0            0            0     3345.048     2304.963 
     CELL122            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      696.548      696.548 
     CELL123            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0 
     CELL124            0            0            0            0            0            0            0            0            0            0            0       29.214            0            0      158.596            0            0            0            0            0            0            0            0            0            0            0       767.79      688.397 
     CELL125            0            0            0            0            0            0            0            0            0            0            0       26.304            0            0      144.331            0            0            0            0            0            0            0            0            0            0            0     3415.258     1341.984 
     CELL126            0            0            0            0            0            0            0            0            0            0            0       22.037            0            0      122.273            0            0            0            0            0            0            0            0            0            0            0     5698.012     3583.577 
     CELL127            0            0            0            0            0            0            0            0            0            0            0       23.129            0            0      128.336            0            0            0            0            0            0            0            0            0            0            0     5271.419      2936.75 
     CELL128            0            0            0            0            0            0            0            0            0            0            0       16.116            0            0       90.329            0            0            0            0            0            0            0            0            0            0            0     5582.155     3711.279 
     CELL129            0            0            0            0            0            0            0            0            0            0            0       27.017            0            0      153.031            0            0            0            0            0            0            0            0            0            0            0     5605.689     3724.957 
     CELL130            0            0            0            0            0            0            0            0            0            0            0       21.766            0            0      123.285            0            0            0            0            0            0            0            0            0            0            0     3971.115     3640.064 
     CELL131            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        20.84        20.84 
     CELL132            0            0            0            0            0            0            0            0            0            0            0       20.336            0            0            0            0            0            0            0            0            0            0            0            0            0            0        0.329        0.471 
     CELL133            0            0            0            0            0            0            0            0            0            0            0       26.856            0            0      147.611            0            0            0            0            0            0            0            0            0            0            0      331.211      263.662 
     CELL134            0            0            0            0            0            0            0            0            0            0            0       25.863            0            0      142.146            0            0            0            0            0            0            0            0            0            0            0      3482.12      1698.52 
     CELL135            0            0            0            0            0            0            0            0            0            0            0       27.293            0            0      151.632            0            0            0            0            0            0            0            0            0            0            0     5305.889     1832.773 
     CELL136            0            0            0            0            0            0            0            0            0            0            0       10.442            0            0           58            0            0            0            0            0            0            0            0            0            0            0     6060.776     1855.039 
     CELL137            0            0            0            0            0            0            0            0            0            0            0       24.863            0            0      141.089            0            0            0            0            0            0            0            0            0            0            0     5602.196     3533.446 
     CELL138            0            0            0            0            0            0            0            0            0            0            0       19.333            0            0      109.693            0            0            0            0            0            0            0            0            0            0            0     5144.712     2605.152 
     CELL139            0            0            0            0            0            0            0            0            0            0            0       15.937            0            0       91.427            0            0            0            0            0            0            0            0            0            0            0     4725.895     2359.813 
     CELL140            0            0            0            0            0            0            0            0            0            0            0        5.908            0            0            0            0            0            0            0            0            0            0            0            0            0            0      112.445      204.243 
     CELL141            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        5.794        5.794 
     CELL142            0            0            0            0            0            0            0            0            0            0            0       27.943            0            0      155.457            0            0            0            0            0            0            0            0            0            0            0     1905.963      781.239 
     CELL143            0            0            0            0            0            0            0            0            0            0            0       20.081            0            0      112.942            0            0            0            0            0            0            0            0            0            0            0     4965.789      2617.79 
     CELL144            0            0            0            0            0            0            0            0            0            0            0       15.355            0            0       86.349            0            0            0            0            0            0            0            0            0            0            0     4588.302     1531.168 
     CELL145            0            0            0            0            0            0            0            0            0            0            0       25.736            0            0      146.307            0            0            0            0            0            0            0            0            0            0            0     4688.057     2033.214 
     CELL146            0            0            0            0            0            0            0            0            0            0            0       17.957            0            0      103.191            0            0            0            0            0            0            0            0            0            0            0     3430.496       941.86 
     CELL147            0            0            0            0            0            0            0            0            0            0            0       17.215            0            0       98.951            0            0            0            0            0            0            0            0            0            0            0     2806.545     1029.239 
     CELL148            0            0            0            0            0            0            0            0            0            0            0        3.521            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1170.857      509.471 
     CELL149            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       28.981       28.981 
     CELL150            0            0            0            0            0            0            0            0            0            0            0       22.203            0            0      123.768            0            0            0            0            0            0            0            0            0            0            0      177.271       38.215 
     CELL151            0            0            0            0            0            0            0            0            0            0            0       16.795            0            0       94.588            0            0            0            0            0            0            0            0            0            0            0     4560.727     2652.272 
     CELL152            0            0            0            0            0            0            0            0            0            0            0       20.045            0            0      114.173            0            0            0            0            0            0            0            0            0            0            0     5465.642     2547.625 
     CELL153            0            0            0            0            0            0            0            0            0            0            0       28.182            0            0      160.486            0            0            0            0            0            0            0            0            0            0            0     3436.003     2378.657 
     CELL154            0            0            0            0            0            0            0            0            0            0            0       23.598            0            0      135.894            0            0            0            0            0            0            0            0            0            0            0     2441.565     2278.642 
     CELL155            0            0            0            0            0            0            0            0            0            0            0       14.316            0            0       82.425            0            0            0            0            0            0            0            0            0            0            0     4305.227     2182.805 
     CELL156            0            0            0            0            0            0            0            0            0            0            0        6.636            0            0       38.199            0            0            0            0            0            0            0            0            0            0            0     1924.771       218.26 
     CELL157            0            0            0            0            0            0            0            0            0            0            0       27.171            0            0      153.309            0            0            0            0            0            0            0            0            0            0            0       30.611       14.076 
     CELL158            0            0            0            0            0            0            0            0            0            0            0       12.783            0            0       72.917            0            0            0            0            0            0            0            0            0            0            0      3072.22      562.211 
     CELL159            0            0            0            0            0            0            0            0            0            0            0       19.624            0            0      111.886            0            0            0            0            0            0            0            0            0            0            0     2287.354      296.765 
     CELL160            0            0            0            0            0            0            0            0            0            0            0       15.773            0            0       89.917            0            0            0            0            0            0            0            0            0            0            0     5109.289     4127.231 
     CELL161            0            0            0            0            0            0            0            0            0            0            0        12.22            0            0       69.623            0            0            0            0            0            0            0            0            0            0            0     4809.456     3239.031 
     CELL162            0            0            0            0            0            0            0            0            0            0            0        2.557            0            0       14.737            0            0            0            0            0            0            0            0            0            0            0     1867.929      728.982 
     CELL163            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      384.346      125.811 
     CELL164            0            0            0            0            0            0            0            0            0            0            0       26.633            0            0      152.203            0            0            0            0            0            0            0            0            0            0            0      587.955      235.371 
     CELL165            0            0            0            0            0            0            0            0            0            0            0       18.354            0            0      104.865            0            0            0            0            0            0            0            0            0            0            0     2249.092      541.044 
     CELL166            0            0            0            0            0            0            0            0            0            0            0       18.467            0            0      105.502            0            0            0            0            0            0            0            0            0            0            0     4197.051      352.908 
     CELL167            0            0            0            0            0            0            0            0            0            0            0       24.323            0            0      140.428            0            0            0            0            0            0            0            0            0            0            0     2726.313      418.005 
     CELL168            0            0            0            0            0            0            0            0            0            0            0        5.866            0            0       34.145            0            0            0            0            0            0            0            0            0            0            0     3355.204      467.602 
     CELL169            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      416.485      100.037 
     CELL170            0            0            0            0            0            0            0            0            0            0            0        20.06            0            0      114.739            0            0            0            0            0            0            0            0            0            0            0     1165.074      498.873 
     CELL171            0            0            0            0            0            0            0            0            0            0            0       21.336            0            0      123.328            0            0            0            0            0            0            0            0            0            0            0     2303.226      276.527 
     CELL172            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      3485.86       378.72 
     CELL173            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1336.93       67.748 
     CELL174            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      296.766            0 
     CELL175            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      600.643       41.128 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0            0         3034            0            0    13099.483            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
