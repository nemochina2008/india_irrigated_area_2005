<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0        0.005         1.85            0            0        2.134            0            0            0            0            0            0            0            0            0            0            0     1854.184     1247.234 
       CELL2            0            0            0            0            0            0            0            0            0            0        0.011        3.731            0            0        4.303            0            0            0            0            0            0            0            0            0            0            0      548.421      267.397 
       CELL3            0            0            0            0            0            0            0            0            0            0        0.016        5.578            0            0        6.411            0            0            0            0            0            0            0            0            0            0            0      399.371       71.878 
       CELL4            0            0            0            0            0            0            0            0            0            0            0        3.735            0            0            0            0            0            0            0            0            0            0            0            0            0            0      595.777      525.984 
       CELL5            0            0            0            0            0            0            0            0            0            0         0.01        3.455            0            0        3.981            0            0            0            0            0            0            0            0            0            0            0     5968.102     4919.647 
       CELL6            0            0            0            0            0            0            0            0            0            0        0.003        1.237            0            0        1.425            0            0            0            0            0            0            0            0            0            0            0     5532.614     3294.019 
       CELL7            0            0            0            0            0            0            0            0            0            0        0.012         4.13            0            0        4.755            0            0            0            0            0            0            0            0            0            0            0     2190.026     1042.918 
       CELL8            0            0            0            0            0            0            0            0            0            0        0.014        4.794            0            0        5.519            0            0            0            0            0            0            0            0            0            0            0     1502.149      702.043 
       CELL9            0            0            0            0            0            0            0            0            0            0         0.01        3.701            0            0        4.271            0            0            0            0            0            0            0            0            0            0            0     1142.195      638.754 
      CELL10            0            0            0            0            0            0            0            0            0            0        0.018        6.455            0            0        7.456            0            0            0            0            0            0            0            0            0            0            0      541.743      329.043 
      CELL11            0            0            0            0            0            0            0            0            0            0        0.022        7.648            0            0        8.822            0            0            0            0            0            0            0            0            0            0            0      169.398      107.411 
      CELL12            0            0            0            0            0            0            0            0            0            0        0.021         7.39            0            0        8.511            0            0            0            0            0            0            0            0            0            0            0     1452.311      984.959 
      CELL13            0            0            0            0            0            0            0            0            0            0         0.01        3.573            0            0        4.115            0            0            0            0            0            0            0            0            0            0            0     5662.648     3063.522 
      CELL14            0            0            0            0            0            0            0            0            0            0         0.02        6.976            0            0        8.038            0            0            0            0            0            0            0            0            0            0            0     3978.339     2860.856 
      CELL15            0            0            0            0            0            0            0            0            0            0        0.014        5.071            0            0        5.841            0            0            0            0            0            0            0            0            0            0            0     5831.034     1935.084 
      CELL16            0            0            0            0            0            0            0            0            0            0        0.016        5.696            0            0        6.561            0            0            0            0            0            0            0            0            0            0            0     5546.145     1173.764 
      CELL17            0            0            0            0            0            0            0            0            0            0        0.011        3.746            0            0        4.306            0            0            0            0            0            0            0            0            0            0            0     4296.067       667.99 
      CELL18            0            0            0            0            0            0            0            0            0            0        0.018        6.476            0            0        7.422            0            0            0            0            0            0            0            0            0            0            0      313.944      123.706 
      CELL19            0            0            0            0            0            0            0            0            0            0         0.01        3.424            0            0        3.943            0            0            0            0            0            0            0            0            0            0            0     5131.359     4480.054 
      CELL20            0            0            0            0            0            0            0            0            0            0        0.009        3.247            0            0         3.74            0            0            0            0            0            0            0            0            0            0            0     5927.625      4367.65 
      CELL21            0            0            0            0            0            0            0            0            0            0        0.005        1.847            0            0        2.126            0            0            0            0            0            0            0            0            0            0            0     6344.517     2851.577 
      CELL22            0            0            0            0            0            0            0            0            0            0        0.017        5.959            0            0        6.858            0            0            0            0            0            0            0            0            0            0            0     5273.753     2658.827 
      CELL23            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      989.029      195.179 
      CELL24            0            0            0            0            0            0            0            0            0            0        0.015        5.452            0            0        6.277            0            0            0            0            0            0            0            0            0            0            0      448.847      322.609 
      CELL25            0            0            0            0            0            0            0            0            0            0         0.02        7.149            0            0        8.234            0            0            0            0            0            0            0            0            0            0            0      224.572      135.473 
      CELL26            0            0            0            0            0            0            0            0            0            0        0.022        7.731            0            0        8.914            0            0            0            0            0            0            0            0            0            0            0     5072.004     2773.596 
      CELL27            0            0            0            0            0            0            0            0            0            0        0.022        7.845            0            0        9.048            0            0            0            0            0            0            0            0            0            0            0     3801.364     2370.906 
      CELL28            0            0            0            0            0            0            0            0            0            0        0.024        8.337            0            0        9.618            0            0            0            0            0            0            0            0            0            0            0     3798.312     1675.457 
      CELL29            0            0            0            0            0            0            0            0            0            0        0.023        8.255            0            0        9.516            0            0            0            0            0            0            0            0            0            0            0     4136.903     2116.935 
      CELL30            0            0            0            0            0            0            0            0            0            0        0.022        7.833            0            0        9.034            0            0            0            0            0            0            0            0            0            0            0      6090.88     5198.784 
      CELL31            0            0            0            0            0            0            0            0            0            0        0.022        7.936            0            0        9.149            0            0            0            0            0            0            0            0            0            0            0     5792.968     3985.206 
      CELL32            0            0            0            0            0            0            0            0            0            0        0.022        7.838            0            0        9.038            0            0            0            0            0            0            0            0            0            0            0     5668.461     3034.219 
      CELL33            0            0            0            0            0            0            0            0            0            0        0.019        6.817            0            0        7.865            0            0            0            0            0            0            0            0            0            0            0     5970.669     1692.601 
      CELL34            0            0            0            0            0            0            0            0            0            0        0.023         7.99            0            0        9.207            0            0            0            0            0            0            0            0            0            0            0     5765.669     3115.594 
      CELL35            0            0            0            0            0            0            0            0            0            0        0.014         4.97            0            0         5.72            0            0            0            0            0            0            0            0            0            0            0     5759.489     2905.173 
      CELL36            0            0            0            0            0            0            0            0            0            0        0.018        6.511            0            0        7.484            0            0            0            0            0            0            0            0            0            0            0     1526.032      786.147 
      CELL37            0            0            0            0            0            0            0            0            0            0        0.009         3.05            0            0        3.515            0            0            0            0            0            0            0            0            0            0            0     1144.908      789.973 
      CELL38            0            0            0            0            0            0            0            0            0            0        0.004        1.291            0            0        1.486            0            0            0            0            0            0            0            0            0            0            0     5699.814     4518.745 
      CELL39            0            0            0            0            0            0            0            0            0            0        0.012        4.298            0            0        4.956            0            0            0            0            0            0            0            0            0            0            0      6021.23      4923.63 
      CELL40            0            0            0            0            0            0            0            0            0            0        0.011         3.79            0            0        4.365            0            0            0            0            0            0            0            0            0            0            0     6331.779     4330.477 
      CELL41            0            0            0            0            0            0            0            0            0            0        0.015        5.187            0            0        5.967            0            0            0            0            0            0            0            0            0            0            0     6012.185     2052.779 
      CELL42            0            0            0            0            0            0            0            0            0            0        0.015        5.201            0            0        5.985            0            0            0            0            0            0            0            0            0            0            0     4851.597     2671.915 
      CELL43            0            0            0            0            0            0            0            0            0            0        0.018        6.239            0            0         7.18            0            0            0            0            0            0            0            0            0            0            0     5380.699     2068.986 
      CELL44            0            0            0            0            0            0            0            0            0            0        0.022        7.628            0            0        8.785            0            0            0            0            0            0            0            0            0            0            0     5483.265     3508.642 
      CELL45            0            0            0            0            0            0            0            0            0            0        0.023        8.272            0            0         9.53            0            0            0            0            0            0            0            0            0            0            0     5942.803     4331.703 
      CELL46            0            0            0            0            0            0            0            0            0            0        0.021        7.402            0            0        8.532            0            0            0            0            0            0            0            0            0            0            0     6079.778     3904.052 
      CELL47            0            0            0            0            0            0            0            0            0            0         0.02        7.142            0            0        8.238            0            0            0            0            0            0            0            0            0            0            0     5588.536      2405.48 
      CELL48            0            0            0            0            0            0            0            0            0            0        0.023        8.049            0            0        9.288            0            0            0            0            0            0            0            0            0            0            0     5837.161     3217.538 
      CELL49            0            0            0            0            0            0            0            0            0            0        0.025         8.87            0            0        10.24            0            0            0            0            0            0            0            0            0            0            0     5884.886      4636.04 
      CELL50            0            0            0            0            0            0            0            0            0            0        0.017        6.066            0            0            7            0            0            0            0            0            0            0            0            0            0            0     5533.719     3949.148 
      CELL51            0            0            0            0            0            0            0            0            0            0        0.017        6.108            0            0        7.045            0            0            0            0            0            0            0            0            0            0            0     5704.043     2845.999 
      CELL52            0            0            0            0            0            0            0            0            0            0         0.02        7.261            0            0        8.378            0            0            0            0            0            0            0            0            0            0            0     5991.561     1834.982 
      CELL53            0            0            0            0            0            0            0            0            0            0        0.025        8.696            0            0       10.025            0            0            0            0            0            0            0            0            0            0            0     5769.442     2906.431 
      CELL54            0            0            0            0            0            0            0            0            0            0        0.012        4.243            0            0         4.89            0            0            0            0            0            0            0            0            0            0            0     5247.487     3464.272 
      CELL55            0            0            0            0            0            0            0            0            0            0        0.018        6.406            0            0        7.372            0            0            0            0            0            0            0            0            0            0            0     4301.334     3062.805 
      CELL56            0            0            0            0            0            0            0            0            0            0        0.017        5.979            0            0         6.88            0            0            0            0            0            0            0            0            0            0            0     1310.432      539.301 
      CELL57            0            0            0            0            0            0            0            0            0            0        0.006        2.209            0            0        2.543            0            0            0            0            0            0            0            0            0            0            0     2243.986     1319.761 
      CELL58            0            0            0            0            0            0            0            0            0            0        0.008        2.993            0            0        3.447            0            0            0            0            0            0            0            0            0            0            0     5953.305     4041.615 
      CELL59            0            0            0            0            0            0            0            0            0            0        0.014        5.063            0            0        5.838            0            0            0            0            0            0            0            0            0            0            0     5926.739     3405.929 
      CELL60            0            0            0            0            0            0            0            0            0            0        0.015        5.149            0            0        5.937            0            0            0            0            0            0            0            0            0            0            0     6221.968      3630.07 
      CELL61            0            0            0            0            0            0            0            0            0            0         0.02        7.002            0            0        8.072            0            0            0            0            0            0            0            0            0            0            0     6166.033     2708.778 
      CELL62            0            0            0            0            0            0            0            0            0            0        0.024        8.335            0            0        9.607            0            0            0            0            0            0            0            0            0            0            0     6186.028     2622.319 
      CELL63            0            0            0            0            0            0            0            0            0            0        0.023        8.302            0            0        9.566            0            0            0            0            0            0            0            0            0            0            0     6043.744     3698.912 
      CELL64            0            0            0            0            0            0            0            0            0            0        0.026        9.328            0            0       10.753            0            0            0            0            0            0            0            0            0            0            0     5757.702      2334.31 
      CELL65            0            0            0            0            0            0            0            0            0            0        0.026         9.06            0            0       10.457            0            0            0            0            0            0            0            0            0            0            0     5992.228     2513.682 
      CELL66            0            0            0            0            0            0            0            0            0            0        0.021        7.367            0            0          8.5            0            0            0            0            0            0            0            0            0            0            0      6258.28     3806.993 
      CELL67            0            0            0            0            0            0            0            0            0            0        0.027        9.672            0            0       11.167            0            0            0            0            0            0            0            0            0            0            0     5914.638     4712.575 
      CELL68            0            0            0            0            0            0            0            0            0            0        0.015        5.278            0            0        6.096            0            0            0            0            0            0            0            0            0            0            0     5901.318     4408.812 
      CELL69            0            0            0            0            0            0            0            0            0            0        0.021        7.415            0            0        8.565            0            0            0            0            0            0            0            0            0            0            0     5574.787     4015.851 
      CELL70            0            0            0            0            0            0            0            0            0            0        0.021        7.263            0            0        8.387            0            0            0            0            0            0            0            0            0            0            0      5726.73     2529.617 
      CELL71            0            0            0            0            0            0            0            0            0            0        0.014        4.892            0            0         5.65            0            0            0            0            0            0            0            0            0            0            0     5167.891     1256.796 
      CELL72            0            0            0            0            0            0            0            0            0            0        0.026        9.384            0            0       10.832            0            0            0            0            0            0            0            0            0            0            0     3615.726     1373.364 
      CELL73            0            0            0            0            0            0            0            0            0            0        0.024        8.592            0            0        9.912            0            0            0            0            0            0            0            0            0            0            0      280.218      123.531 
      CELL74            0            0            0            0            0            0            0            0            0            0            0        6.952            0            0            0            0            0            0            0            0            0            0            0            0            0            0      513.267      383.397 
      CELL75            0            0            0            0            0            0            0            0            0            0        0.015        5.314            0            0        6.125            0            0            0            0            0            0            0            0            0            0            0     5448.627     1613.087 
      CELL76            0            0            0            0            0            0            0            0            0            0        0.017        6.111            0            0        7.038            0            0            0            0            0            0            0            0            0            0            0     5684.727      978.914 
      CELL77            0            0            0            0            0            0            0            0            0            0        0.018        6.537            0            0        7.524            0            0            0            0            0            0            0            0            0            0            0     4901.433     1269.129 
      CELL78            0            0            0            0            0            0            0            0            0            0        0.015        5.307            0            0        6.112            0            0            0            0            0            0            0            0            0            0            0     5268.801     2639.386 
      CELL79            0            0            0            0            0            0            0            0            0            0        0.019        6.701            0            0        7.723            0            0            0            0            0            0            0            0            0            0            0     5913.915     2561.183 
      CELL80            0            0            0            0            0            0            0            0            0            0        0.025        8.948            0            0       10.317            0            0            0            0            0            0            0            0            0            0            0     6141.243     2978.665 
      CELL81            0            0            0            0            0            0            0            0            0            0        0.022         7.71            0            0        8.892            0            0            0            0            0            0            0            0            0            0            0     6231.541     2620.701 
      CELL82            0            0            0            0            0            0            0            0            0            0        0.028         9.97            0            0       11.507            0            0            0            0            0            0            0            0            0            0            0     5951.507     2340.651 
      CELL83            0            0            0            0            0            0            0            0            0            0        0.016         5.63            0            0        6.498            0            0            0            0            0            0            0            0            0            0            0     6203.767     3017.588 
      CELL84            0            0            0            0            0            0            0            0            0            0        0.029       10.343            0            0       11.943            0            0            0            0            0            0            0            0            0            0            0     6018.699     2537.206 
      CELL85            0            0            0            0            0            0            0            0            0            0         0.03       10.517            0            0       12.141            0            0            0            0            0            0            0            0            0            0            0     5919.868     4700.204 
      CELL86            0            0            0            0            0            0            0            0            0            0         0.02         6.95            0            0        8.034            0            0            0            0            0            0            0            0            0            0            0     5985.263     3413.568 
      CELL87            0            0            0            0            0            0            0            0            0            0        0.027         9.45            0            0       10.927            0            0            0            0            0            0            0            0            0            0            0     5703.659     4248.302 
      CELL88            0            0            0            0            0            0            0            0            0            0        0.021        7.563            0            0        8.741            0            0            0            0            0            0            0            0            0            0            0     5722.421     4799.413 
      CELL89            0            0            0            0            0            0            0            0            0            0        0.028        9.866            0            0       11.403            0            0            0            0            0            0            0            0            0            0            0     5226.102     2126.387 
      CELL90            0            0            0            0            0            0            0            0            0            0        0.016        5.752            0            0        6.651            0            0            0            0            0            0            0            0            0            0            0     1102.097      466.627 
      CELL91            0            0            0            0            0            0            0            0            0            0        0.021        7.352            0            0         8.62            0            0            0            0            0            0            0            0            0            0            0     3277.486     2202.025 
      CELL92            0            0            0            0            0            0            0            0            0            0        0.014        4.944            0            0        5.797            0            0            0            0            0            0            0            0            0            0            0     5847.095     2770.136 
      CELL93            0            0            0            0            0            0            0            0            0            0        0.003        1.132            0            0        1.328            0            0            0            0            0            0            0            0            0            0            0     6136.344     2443.055 
      CELL94            0            0            0            0            0            0            0            0            0            0        0.003        1.033            0            0          1.2            0            0            0            0            0            0            0            0            0            0            0     5933.433     1890.579 
      CELL95            0            0            0            0            0            0            0            0            0            0        0.005        1.635            0            0        1.884            0            0            0            0            0            0            0            0            0            0            0     2660.131      406.428 
      CELL96            0            0            0            0            0            0            0            0            0            0        0.007        2.341            0            0        2.699            0            0            0            0            0            0            0            0            0            0            0      5382.97     1893.059 
      CELL97            0            0            0            0            0            0            0            0            0            0         0.02        6.991            0            0         8.06            0            0            0            0            0            0            0            0            0            0            0     6138.956     3073.703 
      CELL98            0            0            0            0            0            0            0            0            0            0        0.025        8.826            0            0       10.167            0            0            0            0            0            0            0            0            0            0            0      6064.59     4016.058 
      CELL99            0            0            0            0            0            0            0            0            0            0        0.024        8.644            0            0         9.98            0            0            0            0            0            0            0            0            0            0            0     5967.245     1370.929 
     CELL100            0            0            0            0            0            0            0            0            0            0        0.025        8.705            0            0       10.055            0            0            0            0            0            0            0            0            0            0            0     5936.103     2473.682 
     CELL101            0            0            0            0            0            0            0            0            0            0         0.03       10.681            0            0       12.346            0            0            0            0            0            0            0            0            0            0            0      5759.14     2785.163 
     CELL102            0            0            0            0            0            0            0            0            0            0        0.031       11.116            0            0        12.85            0            0            0            0            0            0            0            0            0            0            0     6015.769     3522.555 
     CELL103            0            0            0            0            0            0            0            0            0            0        0.028       10.099            0            0       11.677            0            0            0            0            0            0            0            0            0            0            0     5881.969     3465.296 
     CELL104            0            0            0            0            0            0            0            0            0            0        0.023        8.163            0            0        9.449            0            0            0            0            0            0            0            0            0            0            0      5818.87     2417.483 
     CELL105            0            0            0            0            0            0            0            0            0            0        0.027        9.598            0            0         11.1            0            0            0            0            0            0            0            0            0            0            0     5411.751     4197.911 
     CELL106            0            0            0            0            0            0            0            0            0            0        0.028        9.765            0            0       11.286            0            0            0            0            0            0            0            0            0            0            0     5426.621     4796.024 
     CELL107            0            0            0            0            0            0            0            0            0            0        0.014        5.097            0            0        5.888            0            0            0            0            0            0            0            0            0            0            0     1824.781      449.396 
     CELL108            0            0            0            0            0            0            0            0            0            0        0.019        6.737            0            0        7.838            0            0            0            0            0            0            0            0            0            0            0     1373.969       972.81 
     CELL109            0            0            0            0            0            0            0            0            0            0        0.021        7.302            0            0        8.568            0            0            0            0            0            0            0            0            0            0            0     4575.869     2840.705 
     CELL110            0            0            0            0            0            0            0            0            0            0        0.018        6.456            0            0        7.568            0            0            0            0            0            0            0            0            0            0            0     5725.772     4436.217 
     CELL111            0            0            0            0            0            0            0            0            0            0        0.014         5.13            0            0        6.018            0            0            0            0            0            0            0            0            0            0            0     5782.747     2766.209 
     CELL112            0            0            0            0            0            0            0            0            0            0        0.013        4.733            0            0        5.549            0            0            0            0            0            0            0            0            0            0            0     5891.752     2067.874 
     CELL113            0            0            0            0            0            0            0            0            0            0        0.012        4.138            0            0        4.772            0            0            0            0            0            0            0            0            0            0            0     4049.189     1561.155 
     CELL114            0            0            0            0            0            0            0            0            0            0         0.01        3.646            0            0        4.204            0            0            0            0            0            0            0            0            0            0            0     5140.847     1859.646 
     CELL115            0            0            0            0            0            0            0            0            0            0         0.02        6.935            0            0        7.994            0            0            0            0            0            0            0            0            0            0            0     6220.441     3132.794 
     CELL116            0            0            0            0            0            0            0            0            0            0        0.026        9.206            0            0       10.611            0            0            0            0            0            0            0            0            0            0            0      5811.86     3192.792 
     CELL117            0            0            0            0            0            0            0            0            0            0        0.027        9.455            0            0       10.906            0            0            0            0            0            0            0            0            0            0            0     5813.537     3250.363 
     CELL118            0            0            0            0            0            0            0            0            0            0        0.029       10.317            0            0       11.928            0            0            0            0            0            0            0            0            0            0            0     4480.662      1833.38 
     CELL119            0            0            0            0            0            0            0            0            0            0         0.03       10.809            0            0       12.513            0            0            0            0            0            0            0            0            0            0            0     5181.422     1359.591 
     CELL120            0            0            0            0            0            0            0            0            0            0        0.032       11.373            0            0       13.167            0            0            0            0            0            0            0            0            0            0            0     3721.674     1635.107 
     CELL121            0            0            0            0            0            0            0            0            0            0         0.03       10.793            0            0        12.49            0            0            0            0            0            0            0            0            0            0            0     3841.973     1077.839 
     CELL122            0            0            0            0            0            0            0            0            0            0        0.032       11.281            0            0       13.052            0            0            0            0            0            0            0            0            0            0            0      4343.31     1534.448 
     CELL123            0            0            0            0            0            0            0            0            0            0        0.025        8.742            0            0       10.116            0            0            0            0            0            0            0            0            0            0            0     4682.311      1619.94 
     CELL124            0            0            0            0            0            0            0            0            0            0        0.026        9.322            0            0       10.779            0            0            0            0            0            0            0            0            0            0            0     2893.004     1531.948 
     CELL125            0            0            0            0            0            0            0            0            0            0        0.026        9.213            0            0       10.644            0            0            0            0            0            0            0            0            0            0            0      106.752       39.537 
     CELL126            0            0            0            0            0            0            0            0            0            0        0.021        7.341            0            0        8.617            0            0            0            0            0            0            0            0            0            0            0     3461.673     1166.658 
     CELL127            0            0            0            0            0            0            0            0            0            0         0.01        3.699            0            0        4.309            0            0            0            0            0            0            0            0            0            0            0     5888.539     1924.802 
     CELL128            0            0            0            0            0            0            0            0            0            0        0.019        6.853            0            0        7.977            0            0            0            0            0            0            0            0            0            0            0     5582.317     3004.053 
     CELL129            0            0            0            0            0            0            0            0            0            0        0.025        9.044            0            0       10.526            0            0            0            0            0            0            0            0            0            0            0     5407.496     3703.843 
     CELL130            0            0            0            0            0            0            0            0            0            0        0.024        8.539            0            0        9.856            0            0            0            0            0            0            0            0            0            0            0     2917.899      402.334 
     CELL131            0            0            0            0            0            0            0            0            0            0        0.029       10.274            0            0       11.861            0            0            0            0            0            0            0            0            0            0            0     4227.609     1509.725 
     CELL132            0            0            0            0            0            0            0            0            0            0        0.028        9.788            0            0       11.299            0            0            0            0            0            0            0            0            0            0            0     5882.441     2805.563 
     CELL133            0            0            0            0            0            0            0            0            0            0        0.025         9.01            0            0       10.396            0            0            0            0            0            0            0            0            0            0            0     5388.613     3074.968 
     CELL134            0            0            0            0            0            0            0            0            0            0        0.031       10.909            0            0       12.584            0            0            0            0            0            0            0            0            0            0            0     5462.867     2233.303 
     CELL135            0            0            0            0            0            0            0            0            0            0        0.022        7.933            0            0        9.154            0            0            0            0            0            0            0            0            0            0            0     5657.845     3153.547 
     CELL136            0            0            0            0            0            0            0            0            0            0        0.017        6.155            0            0        7.117            0            0            0            0            0            0            0            0            0            0            0     5023.266     2281.666 
     CELL137            0            0            0            0            0            0            0            0            0            0        0.033       11.746            0            0       13.599            0            0            0            0            0            0            0            0            0            0            0     2219.152          940 
     CELL138            0            0            0            0            0            0            0            0            0            0        0.013         4.54            0            0        5.277            0            0            0            0            0            0            0            0            0            0            0      682.962       64.905 
     CELL139            0            0            0            0            0            0            0            0            0            0        0.005        1.876            0            0        2.184            0            0            0            0            0            0            0            0            0            0            0     1773.609      464.915 
     CELL140            0            0            0            0            0            0            0            0            0            0        0.019        6.793            0            0        7.847            0            0            0            0            0            0            0            0            0            0            0     3499.128     1833.652 
     CELL141            0            0            0            0            0            0            0            0            0            0        0.023        8.015            0            0         9.34            0            0            0            0            0            0            0            0            0            0            0     3345.376      2722.96 
     CELL142            0            0            0            0            0            0            0            0            0            0        0.026        9.269            0            0       10.713            0            0            0            0            0            0            0            0            0            0            0      168.299       24.927 
     CELL143            0            0            0            0            0            0            0            0            0            0        0.026        9.227            0            0       10.664            0            0            0            0            0            0            0            0            0            0            0      319.118       89.506 
     CELL144            0            0            0            0            0            0            0            0            0            0        0.018        6.406            0            0        7.406            0            0            0            0            0            0            0            0            0            0            0     4145.495     2198.751 
     CELL145            0            0            0            0            0            0            0            0            0            0        0.018        6.513            0            0        7.529            0            0            0            0            0            0            0            0            0            0            0     5736.298     3943.071 
     CELL146            0            0            0            0            0            0            0            0            0            0        0.033       11.584            0            0       13.392            0            0            0            0            0            0            0            0            0            0            0     5570.505     4336.288 
     CELL147            0            0            0            0            0            0            0            0            0            0        0.033       11.773            0            0         13.6            0            0            0            0            0            0            0            0            0            0            0     5311.897     3403.757 
     CELL148            0            0            0            0            0            0            0            0            0            0        0.032       11.261            0            0       13.018            0            0            0            0            0            0            0            0            0            0            0     5162.979     2629.371 
     CELL149            0            0            0            0            0            0            0            0            0            0        0.026        9.216            0            0       10.675            0            0            0            0            0            0            0            0            0            0            0     1048.375      363.951 
     CELL150            0            0            0            0            0            0            0            0            0            0        0.018        6.416            0            0        7.429            0            0            0            0            0            0            0            0            0            0            0      380.901      224.019 
     CELL151            0            0            0            0            0            0            0            0            0            0        0.029       10.411            0            0       12.054            0            0            0            0            0            0            0            0            0            0            0     1372.873      964.783 
     CELL152            0            0            0            0            0            0            0            0            0            0        0.034       12.035            0            0       13.938            0            0            0            0            0            0            0            0            0            0            0     1397.942     1375.558 
     CELL153            0            0            0            0            0            0            0            0            0            0        0.033        11.87            0            0       13.733            0            0            0            0            0            0            0            0            0            0            0     2698.659     1915.466 
     CELL154            0            0            0            0            0            0            0            0            0            0        0.032       11.313            0            0       13.093            0            0            0            0            0            0            0            0            0            0            0     2398.501     1507.022 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0            3         1074            0            0     1228.494            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
