<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0        2.519        0.451            0            0       15.782            0            0            0            0            0            0            0            0            0            0            0     1483.129      253.308 
       CELL2            0            0            0            0            0            0            0            0            0            0        2.498        0.447            0            0       15.922            0            0            0            0            0            0            0            0            0            0            0     2585.552       467.62 
       CELL3            0            0            0            0            0            0            0            0            0            0        2.218        0.399            0            0       13.317            0            0            0            0            0            0            0            0            0            0            0      162.285       23.807 
       CELL4            0            0            0            0            0            0            0            0            0            0        1.098        0.197            0            0        6.647            0            0            0            0            0            0            0            0            0            0            0     2020.868      238.329 
       CELL5            0            0            0            0            0            0            0            0            0            0        1.225         0.22            0            0         7.48            0            0            0            0            0            0            0            0            0            0            0     3182.349      888.668 
       CELL6            0            0            0            0            0            0            0            0            0            0        2.076        0.372            0            0       12.672            0            0            0            0            0            0            0            0            0            0            0     1150.516      208.069 
       CELL7            0            0            0            0            0            0            0            0            0            0        1.657        0.297            0            0       10.297            0            0            0            0            0            0            0            0            0            0            0      342.463       64.681 
       CELL8            0            0            0            0            0            0            0            0            0            0        2.127         0.38            0            0       13.446            0            0            0            0            0            0            0            0            0            0            0     3926.505      603.539 
       CELL9            0            0            0            0            0            0            0            0            0            0          2.6        0.465            0            0       16.725            0            0            0            0            0            0            0            0            0            0            0     3172.086      718.721 
      CELL10            0            0            0            0            0            0            0            0            0            0         0.37        0.067            0            0        2.223            0            0            0            0            0            0            0            0            0            0            0     1775.424      420.724 
      CELL11            0            0            0            0            0            0            0            0            0            0        0.627        0.113            0            0        3.766            0            0            0            0            0            0            0            0            0            0            0     3750.928      368.809 
      CELL12            0            0            0            0            0            0            0            0            0            0        0.779         0.14            0            0        4.722            0            0            0            0            0            0            0            0            0            0            0     5628.022     1054.111 
      CELL13            0            0            0            0            0            0            0            0            0            0        2.364        0.425            0            0        14.44            0            0            0            0            0            0            0            0            0            0            0     5992.249     1795.125 
      CELL14            0            0            0            0            0            0            0            0            0            0         2.23          0.4            0            0        13.74            0            0            0            0            0            0            0            0            0            0            0     6014.839     2841.255 
      CELL15            0            0            0            0            0            0            0            0            0            0        1.117          0.2            0            0        6.997            0            0            0            0            0            0            0            0            0            0            0     5318.816      1302.58 
      CELL16            0            0            0            0            0            0            0            0            0            0        1.241        0.222            0            0        7.842            0            0            0            0            0            0            0            0            0            0            0     4820.904      566.238 
      CELL17            0            0            0            0            0            0            0            0            0            0        2.303        0.411            0            0       15.242            0            0            0            0            0            0            0            0            0            0            0     3283.291     1163.086 
      CELL18            0            0            0            0            0            0            0            0            0            0        2.672        0.476            0            0       17.661            0            0            0            0            0            0            0            0            0            0            0     5386.434     3031.796 
      CELL19            0            0            0            0            0            0            0            0            0            0        1.172        0.209            0            0        7.817            0            0            0            0            0            0            0            0            0            0            0     2643.131     1151.727 
      CELL20            0            0            0            0            0            0            0            0            0            0        2.078        0.369            0            0       14.122            0            0            0            0            0            0            0            0            0            0            0      2416.44      879.011 
      CELL21            0            0            0            0            0            0            0            0            0            0         3.48        0.617            0            0       23.656            0            0            0            0            0            0            0            0            0            0            0     1160.658      370.245 
      CELL22            0            0            0            0            0            0            0            0            0            0        4.097        0.726            0            0       28.119            0            0            0            0            0            0            0            0            0            0            0       241.65      173.505 
      CELL23            0            0            0            0            0            0            0            0            0            0        1.554         0.28            0            0        9.348            0            0            0            0            0            0            0            0            0            0            0      167.592        0.522 
      CELL24            0            0            0            0            0            0            0            0            0            0        1.536        0.276            0            0        9.243            0            0            0            0            0            0            0            0            0            0            0     1921.854      202.787 
      CELL25            0            0            0            0            0            0            0            0            0            0        1.487        0.267            0            0        8.943            0            0            0            0            0            0            0            0            0            0            0     5027.065       870.14 
      CELL26            0            0            0            0            0            0            0            0            0            0        0.876        0.158            0            0        5.266            0            0            0            0            0            0            0            0            0            0            0     5562.147      1672.63 
      CELL27            0            0            0            0            0            0            0            0            0            0        2.078        0.373            0            0       12.481            0            0            0            0            0            0            0            0            0            0            0     5923.479     1836.102 
      CELL28            0            0            0            0            0            0            0            0            0            0        2.268        0.407            0            0       13.628            0            0            0            0            0            0            0            0            0            0            0      6214.36     2160.596 
      CELL29            0            0            0            0            0            0            0            0            0            0        1.552        0.278            0            0        9.486            0            0            0            0            0            0            0            0            0            0            0     6116.631     2563.624 
      CELL30            0            0            0            0            0            0            0            0            0            0        2.579        0.462            0            0       16.313            0            0            0            0            0            0            0            0            0            0            0      6315.13      1863.69 
      CELL31            0            0            0            0            0            0            0            0            0            0        1.833        0.327            0            0       11.904            0            0            0            0            0            0            0            0            0            0            0     6322.927     2200.268 
      CELL32            0            0            0            0            0            0            0            0            0            0        2.022        0.361            0            0         13.5            0            0            0            0            0            0            0            0            0            0            0       6159.7     2204.347 
      CELL33            0            0            0            0            0            0            0            0            0            0        0.906        0.161            0            0        6.102            0            0            0            0            0            0            0            0            0            0            0     5842.066     3504.993 
      CELL34            0            0            0            0            0            0            0            0            0            0        2.636        0.469            0            0       17.921            0            0            0            0            0            0            0            0            0            0            0     6264.493     3950.477 
      CELL35            0            0            0            0            0            0            0            0            0            0        1.238         0.22            0            0        8.497            0            0            0            0            0            0            0            0            0            0            0     5485.097      4043.73 
      CELL36            0            0            0            0            0            0            0            0            0            0        2.114        0.375            0            0       14.791            0            0            0            0            0            0            0            0            0            0            0     5113.209     3044.806 
      CELL37            0            0            0            0            0            0            0            0            0            0        3.198        0.566            0            0        22.37            0            0            0            0            0            0            0            0            0            0            0     4837.048     2046.347 
      CELL38            0            0            0            0            0            0            0            0            0            0         3.37        0.596            0            0       23.813            0            0            0            0            0            0            0            0            0            0            0     5185.835     1954.535 
      CELL39            0            0            0            0            0            0            0            0            0            0        3.853         0.68            0            0       27.491            0            0            0            0            0            0            0            0            0            0            0      2684.45     1577.543 
      CELL40            0            0            0            0            0            0            0            0            0            0        4.136         0.73            0            0       29.817            0            0            0            0            0            0            0            0            0            0            0      216.027      100.172 
      CELL41            0            0            0            0            0            0            0            0            0            0            0        0.045            0            0            0            0            0            0            0            0            0            0            0            0            0            0      543.125        4.268 
      CELL42            0            0            0            0            0            0            0            0            0            0            0        0.226            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4255.922      168.022 
      CELL43            0            0            0            0            0            0            0            0            0            0            0        0.218            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5644.529      381.551 
      CELL44            0            0            0            0            0            0            0            0            0            0        1.721        0.309            0            0       10.347            0            0            0            0            0            0            0            0            0            0            0     5572.617     1013.331 
      CELL45            0            0            0            0            0            0            0            0            0            0        1.121        0.201            0            0        6.743            0            0            0            0            0            0            0            0            0            0            0     5425.286     1125.543 
      CELL46            0            0            0            0            0            0            0            0            0            0        1.512        0.271            0            0        9.089            0            0            0            0            0            0            0            0            0            0            0     6212.085      2642.47 
      CELL47            0            0            0            0            0            0            0            0            0            0        1.782        0.319            0            0       10.893            0            0            0            0            0            0            0            0            0            0            0     6163.991     1809.688 
      CELL48            0            0            0            0            0            0            0            0            0            0        1.845         0.33            0            0        11.78            0            0            0            0            0            0            0            0            0            0            0     6217.586      2106.85 
      CELL49            0            0            0            0            0            0            0            0            0            0        2.112        0.377            0            0       14.103            0            0            0            0            0            0            0            0            0            0            0     6189.753     2470.903 
      CELL50            0            0            0            0            0            0            0            0            0            0        2.704        0.482            0            0       18.404            0            0            0            0            0            0            0            0            0            0            0     5988.467     1867.024 
      CELL51            0            0            0            0            0            0            0            0            0            0        2.827        0.503            0            0       19.592            0            0            0            0            0            0            0            0            0            0            0     6292.923     2430.915 
      CELL52            0            0            0            0            0            0            0            0            0            0        2.895        0.514            0            0       20.257            0            0            0            0            0            0            0            0            0            0            0     6160.926      3945.72 
      CELL53            0            0            0            0            0            0            0            0            0            0        2.831        0.502            0            0       20.013            0            0            0            0            0            0            0            0            0            0            0     5993.251      2922.81 
      CELL54            0            0            0            0            0            0            0            0            0            0        3.084        0.546            0            0       22.007            0            0            0            0            0            0            0            0            0            0            0      5989.65      4206.19 
      CELL55            0            0            0            0            0            0            0            0            0            0        2.761        0.488            0            0       19.708            0            0            0            0            0            0            0            0            0            0            0     5595.837     3256.058 
      CELL56            0            0            0            0            0            0            0            0            0            0        3.417        0.603            0            0       24.623            0            0            0            0            0            0            0            0            0            0            0     5767.053     2038.611 
      CELL57            0            0            0            0            0            0            0            0            0            0         3.57        0.629            0            0       25.993            0            0            0            0            0            0            0            0            0            0            0     5909.065     2966.331 
      CELL58            0            0            0            0            0            0            0            0            0            0         3.75        0.661            0            0       27.313            0            0            0            0            0            0            0            0            0            0            0     3031.061      2856.79 
      CELL59            0            0            0            0            0            0            0            0            0            0        3.802        0.669            0            0       27.967            0            0            0            0            0            0            0            0            0            0            0      319.787      269.217 
      CELL60            0            0            0            0            0            0            0            0            0            0            0        0.233            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1595.572        4.529 
      CELL61            0            0            0            0            0            0            0            0            0            0            0        0.251            0            0            0            0            0            0            0            0            0            0            0            0            0            0      5368.97      281.323 
      CELL62            0            0            0            0            0            0            0            0            0            0            0        0.191            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5937.658      324.251 
      CELL63            0            0            0            0            0            0            0            0            0            0            0        0.297            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5760.451      573.637 
      CELL64            0            0            0            0            0            0            0            0            0            0            0        0.251            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5653.581      499.216 
      CELL65            0            0            0            0            0            0            0            0            0            0            0        0.161            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5260.677      607.075 
      CELL66            0            0            0            0            0            0            0            0            0            0            0        0.325            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5667.083     1137.799 
      CELL67            0            0            0            0            0            0            0            0            0            0            0        0.204            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5640.067      693.501 
      CELL68            0            0            0            0            0            0            0            0            0            0        1.684          0.3            0            0       11.258            0            0            0            0            0            0            0            0            0            0            0     6047.498     1150.038 
      CELL69            0            0            0            0            0            0            0            0            0            0        2.572        0.457            0            0       17.676            0            0            0            0            0            0            0            0            0            0            0     6201.132      930.663 
      CELL70            0            0            0            0            0            0            0            0            0            0        1.476        0.262            0            0       10.332            0            0            0            0            0            0            0            0            0            0            0     6312.449     2164.971 
      CELL71            0            0            0            0            0            0            0            0            0            0        3.007        0.533            0            0       21.255            0            0            0            0            0            0            0            0            0            0            0     6157.022     2023.742 
      CELL72            0            0            0            0            0            0            0            0            0            0        3.165         0.56            0            0       22.592            0            0            0            0            0            0            0            0            0            0            0     6307.743     1718.144 
      CELL73            0            0            0            0            0            0            0            0            0            0        3.008        0.532            0            0       21.907            0            0            0            0            0            0            0            0            0            0            0     6250.024     2424.878 
      CELL74            0            0            0            0            0            0            0            0            0            0        3.483        0.615            0            0       24.862            0            0            0            0            0            0            0            0            0            0            0     6162.054     2933.022 
      CELL75            0            0            0            0            0            0            0            0            0            0        3.308        0.583            0            0       23.844            0            0            0            0            0            0            0            0            0            0            0     5582.623     2827.999 
      CELL76            0            0            0            0            0            0            0            0            0            0        3.771        0.664            0            0       27.729            0            0            0            0            0            0            0            0            0            0            0     6123.146     2365.741 
      CELL77            0            0            0            0            0            0            0            0            0            0        3.832        0.674            0            0       28.474            0            0            0            0            0            0            0            0            0            0            0     6032.291     4947.049 
      CELL78            0            0            0            0            0            0            0            0            0            0        2.092        0.367            0            0       15.708            0            0            0            0            0            0            0            0            0            0            0     3754.491     2470.771 
      CELL79            0            0            0            0            0            0            0            0            0            0            0        0.092            0            0            0            0            0            0            0            0            0            0            0            0            0            0       858.51        6.506 
      CELL80            0            0            0            0            0            0            0            0            0            0            0        0.181            0            0            0            0            0            0            0            0            0            0            0            0            0            0      5298.49       491.59 
      CELL81            0            0            0            0            0            0            0            0            0            0            0        0.128            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4555.952      334.984 
      CELL82            0            0            0            0            0            0            0            0            0            0            0        0.043            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1420.729      157.353 
      CELL83            0            0            0            0            0            0            0            0            0            0            0        0.205            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2407.338      112.009 
      CELL84            0            0            0            0            0            0            0            0            0            0            0        0.276            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5497.126      597.167 
      CELL85            0            0            0            0            0            0            0            0            0            0            0        0.244            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5590.944      794.279 
      CELL86            0            0            0            0            0            0            0            0            0            0            0        0.397            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5549.068      534.148 
      CELL87            0            0            0            0            0            0            0            0            0            0        1.581        0.281            0            0       10.467            0            0            0            0            0            0            0            0            0            0            0     6026.693     2126.567 
      CELL88            0            0            0            0            0            0            0            0            0            0        2.514        0.446            0            0       17.268            0            0            0            0            0            0            0            0            0            0            0     6290.605     1152.545 
      CELL89            0            0            0            0            0            0            0            0            0            0        2.177        0.386            0            0       15.241            0            0            0            0            0            0            0            0            0            0            0     6322.686       957.18 
      CELL90            0            0            0            0            0            0            0            0            0            0        2.219        0.393            0            0        15.84            0            0            0            0            0            0            0            0            0            0            0     6464.471     1083.525 
      CELL91            0            0            0            0            0            0            0            0            0            0         3.36        0.594            0            0       23.978            0            0            0            0            0            0            0            0            0            0            0     6201.185     4422.262 
      CELL92            0            0            0            0            0            0            0            0            0            0         3.37        0.595            0            0        24.31            0            0            0            0            0            0            0            0            0            0            0     6073.214      2060.03 
      CELL93            0            0            0            0            0            0            0            0            0            0          3.3        0.582            0            0        24.03            0            0            0            0            0            0            0            0            0            0            0      5751.72     1819.891 
      CELL94            0            0            0            0            0            0            0            0            0            0        3.677        0.648            0            0        26.77            0            0            0            0            0            0            0            0            0            0            0     4021.051     2221.953 
      CELL95            0            0            0            0            0            0            0            0            0            0        3.308        0.581            0            0       24.075            0            0            0            0            0            0            0            0            0            0            0     6051.226      775.779 
      CELL96            0            0            0            0            0            0            0            0            0            0        3.623        0.636            0            0       27.207            0            0            0            0            0            0            0            0            0            0            0     6163.518     4275.265 
      CELL97            0            0            0            0            0            0            0            0            0            0        3.381        0.593            0            0       25.653            0            0            0            0            0            0            0            0            0            0            0     5866.609     3344.065 
      CELL98            0            0            0            0            0            0            0            0            0            0         2.36        0.413            0            0       18.102            0            0            0            0            0            0            0            0            0            0            0     2354.446     1145.279 
      CELL99            0            0            0            0            0            0            0            0            0            0            0        0.205            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1196.612        24.93 
     CELL100            0            0            0            0            0            0            0            0            0            0            0        0.205            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1290.014       19.351 
     CELL101            0            0            0            0            0            0            0            0            0            0            0        0.052            0            0            0            0            0            0            0            0            0            0            0            0            0            0      107.647        0.044 
     CELL102            0            0            0            0            0            0            0            0            0            0            0        0.215            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1384.632       64.304 
     CELL103            0            0            0            0            0            0            0            0            0            0            0        0.252            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4960.487      116.314 
     CELL104            0            0            0            0            0            0            0            0            0            0        1.439        0.256            0            0        9.196            0            0            0            0            0            0            0            0            0            0            0     4343.891      263.914 
     CELL105            0            0            0            0            0            0            0            0            0            0        2.472         0.44            0            0       16.213            0            0            0            0            0            0            0            0            0            0            0     5696.476     2059.946 
     CELL106            0            0            0            0            0            0            0            0            0            0        1.919        0.341            0            0       12.933            0            0            0            0            0            0            0            0            0            0            0     6201.756     1157.928 
     CELL107            0            0            0            0            0            0            0            0            0            0        2.307        0.409            0            0       15.687            0            0            0            0            0            0            0            0            0            0            0     6112.823     2081.471 
     CELL108            0            0            0            0            0            0            0            0            0            0        3.008        0.532            0            0       21.456            0            0            0            0            0            0            0            0            0            0            0     5856.801     1931.457 
     CELL109            0            0            0            0            0            0            0            0            0            0        2.243        0.396            0            0       16.003            0            0            0            0            0            0            0            0            0            0            0     6153.438     2243.059 
     CELL110            0            0            0            0            0            0            0            0            0            0        1.874        0.331            0            0       13.505            0            0            0            0            0            0            0            0            0            0            0     5958.615     3353.182 
     CELL111            0            0            0            0            0            0            0            0            0            0        3.192        0.563            0            0       23.721            0            0            0            0            0            0            0            0            0            0            0      5240.45      1470.51 
     CELL112            0            0            0            0            0            0            0            0            0            0        3.382        0.595            0            0       25.121            0            0            0            0            0            0            0            0            0            0            0      5897.47     2028.033 
     CELL113            0            0            0            0            0            0            0            0            0            0        3.415          0.6            0            0       25.363            0            0            0            0            0            0            0            0            0            0            0     6052.547     1576.152 
     CELL114            0            0            0            0            0            0            0            0            0            0        3.372        0.592            0            0       25.308            0            0            0            0            0            0            0            0            0            0            0     6242.738     3465.855 
     CELL115            0            0            0            0            0            0            0            0            0            0        3.341        0.586            0            0       25.085            0            0            0            0            0            0            0            0            0            0            0     6001.636     5348.794 
     CELL116            0            0            0            0            0            0            0            0            0            0        3.226        0.565            0            0       24.222            0            0            0            0            0            0            0            0            0            0            0     7199.912     7199.912 
     CELL117            0            0            0            0            0            0            0            0            0            0        2.364        0.413            0            0       18.329            0            0            0            0            0            0            0            0            0            0            0     5192.923     3915.779 
     CELL118            0            0            0            0            0            0            0            0            0            0         2.29          0.4            0            0       17.954            0            0            0            0            0            0            0            0            0            0            0       49.049       49.049 
     CELL119            0            0            0            0            0            0            0            0            0            0            0        0.133            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1907.991      268.382 
     CELL120            0            0            0            0            0            0            0            0            0            0        0.655        0.117            0            0        4.182            0            0            0            0            0            0            0            0            0            0            0     5419.102     1736.139 
     CELL121            0            0            0            0            0            0            0            0            0            0        2.326        0.413            0            0       15.251            0            0            0            0            0            0            0            0            0            0            0     5831.907     1649.154 
     CELL122            0            0            0            0            0            0            0            0            0            0         1.85        0.329            0            0       12.463            0            0            0            0            0            0            0            0            0            0            0      5585.45     2231.729 
     CELL123            0            0            0            0            0            0            0            0            0            0        2.739        0.485            0            0       18.805            0            0            0            0            0            0            0            0            0            0            0     3071.383      899.754 
     CELL124            0            0            0            0            0            0            0            0            0            0        2.731        0.483            0            0       19.291            0            0            0            0            0            0            0            0            0            0            0     2013.403      722.859 
     CELL125            0            0            0            0            0            0            0            0            0            0        1.302         0.23            0            0        9.195            0            0            0            0            0            0            0            0            0            0            0     4777.133     1758.337 
     CELL126            0            0            0            0            0            0            0            0            0            0        2.813        0.497            0            0       20.265            0            0            0            0            0            0            0            0            0            0            0     5721.687     2491.663 
     CELL127            0            0            0            0            0            0            0            0            0            0        2.692        0.474            0            0       19.784            0            0            0            0            0            0            0            0            0            0            0     5447.933     2452.924 
     CELL128            0            0            0            0            0            0            0            0            0            0        2.381        0.419            0            0       17.498            0            0            0            0            0            0            0            0            0            0            0     5291.525     2063.512 
     CELL129            0            0            0            0            0            0            0            0            0            0        2.182        0.384            0            0       16.208            0            0            0            0            0            0            0            0            0            0            0     6226.439      2233.14 
     CELL130            0            0            0            0            0            0            0            0            0            0        2.551        0.448            0            0        19.55            0            0            0            0            0            0            0            0            0            0            0     6411.491     2099.078 
     CELL131            0            0            0            0            0            0            0            0            0            0         3.13        0.549            0            0       23.738            0            0            0            0            0            0            0            0            0            0            0     6936.878     6936.878 
     CELL132            0            0            0            0            0            0            0            0            0            0        2.595        0.454            0            0       20.106            0            0            0            0            0            0            0            0            0            0            0     6510.251     6510.251 
     CELL133            0            0            0            0            0            0            0            0            0            0        2.967        0.519            0            0       22.996            0            0            0            0            0            0            0            0            0            0            0     6625.381     6625.381 
     CELL134            0            0            0            0            0            0            0            0            0            0        2.921         0.51            0            0       22.646            0            0            0            0            0            0            0            0            0            0            0     6080.716     3940.865 
     CELL135            0            0            0            0            0            0            0            0            0            0         2.83        0.494            0            0       21.944            0            0            0            0            0            0            0            0            0            0            0     1490.764     1117.478 
     CELL136            0            0            0            0            0            0            0            0            0            0         1.64        0.292            0            0       10.646            0            0            0            0            0            0            0            0            0            0            0     1246.526      246.987 
     CELL137            0            0            0            0            0            0            0            0            0            0        2.282        0.406            0            0       14.952            0            0            0            0            0            0            0            0            0            0            0     5540.112     1405.942 
     CELL138            0            0            0            0            0            0            0            0            0            0        2.428        0.431            0            0       16.195            0            0            0            0            0            0            0            0            0            0            0     5818.991     1198.361 
     CELL139            0            0            0            0            0            0            0            0            0            0        2.289        0.406            0            0       15.705            0            0            0            0            0            0            0            0            0            0            0      5596.38     1557.686 
     CELL140            0            0            0            0            0            0            0            0            0            0        1.275        0.226            0            0        8.923            0            0            0            0            0            0            0            0            0            0            0     3682.303     1284.035 
     CELL141            0            0            0            0            0            0            0            0            0            0        0.934        0.165            0            0        6.731            0            0            0            0            0            0            0            0            0            0            0      932.965      432.289 
     CELL142            0            0            0            0            0            0            0            0            0            0        2.689        0.474            0            0       19.562            0            0            0            0            0            0            0            0            0            0            0     4095.829     2639.287 
     CELL143            0            0            0            0            0            0            0            0            0            0        2.687        0.473            0            0       19.544            0            0            0            0            0            0            0            0            0            0            0     3866.671     1380.193 
     CELL144            0            0            0            0            0            0            0            0            0            0        2.344        0.412            0            0       17.404            0            0            0            0            0            0            0            0            0            0            0     3568.898     1156.714 
     CELL145            0            0            0            0            0            0            0            0            0            0        2.602        0.457            0            0       19.324            0            0            0            0            0            0            0            0            0            0            0     5612.085     2086.436 
     CELL146            0            0            0            0            0            0            0            0            0            0        2.098        0.368            0            0       15.585            0            0            0            0            0            0            0            0            0            0            0     6118.369      1816.79 
     CELL147            0            0            0            0            0            0            0            0            0            0        3.015        0.528            0            0       22.628            0            0            0            0            0            0            0            0            0            0            0     6120.458     4937.933 
     CELL148            0            0            0            0            0            0            0            0            0            0        2.365        0.414            0            0       17.941            0            0            0            0            0            0            0            0            0            0            0     6933.722     6933.722 
     CELL149            0            0            0            0            0            0            0            0            0            0        2.423        0.423            0            0       18.781            0            0            0            0            0            0            0            0            0            0            0      5762.13     5026.915 
     CELL150            0            0            0            0            0            0            0            0            0            0        2.433        0.424            0            0       19.067            0            0            0            0            0            0            0            0            0            0            0     5994.812     3355.097 
     CELL151            0            0            0            0            0            0            0            0            0            0        2.432        0.424            0            0       19.063            0            0            0            0            0            0            0            0            0            0            0     2841.582     1669.803 
     CELL152            0            0            0            0            0            0            0            0            0            0        2.034        0.362            0            0       13.451            0            0            0            0            0            0            0            0            0            0            0     1489.988      254.126 
     CELL153            0            0            0            0            0            0            0            0            0            0        2.217        0.394            0            0       15.071            0            0            0            0            0            0            0            0            0            0            0     5507.592     2648.467 
     CELL154            0            0            0            0            0            0            0            0            0            0        1.079        0.191            0            0        7.477            0            0            0            0            0            0            0            0            0            0            0     5799.472     1208.122 
     CELL155            0            0            0            0            0            0            0            0            0            0        2.134        0.378            0            0       14.925            0            0            0            0            0            0            0            0            0            0            0     5101.824     1086.693 
     CELL156            0            0            0            0            0            0            0            0            0            0        2.054        0.363            0            0       14.364            0            0            0            0            0            0            0            0            0            0            0     4363.332     1553.422 
     CELL157            0            0            0            0            0            0            0            0            0            0        2.052         0.36            0            0       15.083            0            0            0            0            0            0            0            0            0            0            0     2622.366     2022.473 
     CELL158            0            0            0            0            0            0            0            0            0            0        2.126        0.373            0            0       15.954            0            0            0            0            0            0            0            0            0            0            0     6326.622      1946.41 
     CELL159            0            0            0            0            0            0            0            0            0            0        2.299        0.402            0            0        17.25            0            0            0            0            0            0            0            0            0            0            0     6235.762     4181.244 
     CELL160            0            0            0            0            0            0            0            0            0            0        1.765        0.308            0            0       13.249            0            0            0            0            0            0            0            0            0            0            0     5702.882     4319.721 
     CELL161            0            0            0            0            0            0            0            0            0            0        2.517        0.439            0            0       19.092            0            0            0            0            0            0            0            0            0            0            0     5605.309     2346.118 
     CELL162            0            0            0            0            0            0            0            0            0            0            0        0.295            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5342.922     1918.313 
     CELL163            0            0            0            0            0            0            0            0            0            0        1.066        0.186            0            0         8.27            0            0            0            0            0            0            0            0            0            0            0     3406.126     1486.548 
     CELL164            0            0            0            0            0            0            0            0            0            0            0        0.188            0            0            0            0            0            0            0            0            0            0            0            0            0            0      449.263      125.245 
     CELL165            0            0            0            0            0            0            0            0            0            0        0.426        0.075            0            0        3.012            0            0            0            0            0            0            0            0            0            0            0     3839.823     1068.981 
     CELL166            0            0            0            0            0            0            0            0            0            0        1.309        0.231            0            0        9.247            0            0            0            0            0            0            0            0            0            0            0       997.86      486.854 
     CELL167            0            0            0            0            0            0            0            0            0            0        0.875        0.154            0            0        6.175            0            0            0            0            0            0            0            0            0            0            0       89.851       27.666 
     CELL168            0            0            0            0            0            0            0            0            0            0         2.07        0.363            0            0       15.209            0            0            0            0            0            0            0            0            0            0            0      752.166      418.819 
     CELL169            0            0            0            0            0            0            0            0            0            0         2.25        0.394            0            0       16.708            0            0            0            0            0            0            0            0            0            0            0     4246.968     1330.473 
     CELL170            0            0            0            0            0            0            0            0            0            0        1.637        0.286            0            0       12.161            0            0            0            0            0            0            0            0            0            0            0      5275.15     1102.508 
     CELL171            0            0            0            0            0            0            0            0            0            0        2.008         0.35            0            0       15.066            0            0            0            0            0            0            0            0            0            0            0     4358.984      485.154 
     CELL172            0            0            0            0            0            0            0            0            0            0            0        0.337            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3677.407      240.353 
     CELL173            0            0            0            0            0            0            0            0            0            0            0        0.026            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3392.575      346.831 
     CELL174            0            0            0            0            0            0            0            0            0            0        1.164        0.202            0            0        8.924            0            0            0            0            0            0            0            0            0            0            0     2092.392      367.445 
     CELL175            0            0            0            0            0            0            0            0            0            0        1.369        0.242            0            0        9.487            0            0            0            0            0            0            0            0            0            0            0      195.794      104.822 
     CELL176            0            0            0            0            0            0            0            0            0            0         1.32        0.233            0            0        9.138            0            0            0            0            0            0            0            0            0            0            0      305.492       119.22 
     CELL177            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2369.757      356.592 
     CELL178            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       73.739       20.169 
     CELL179            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      180.907       22.361 
     CELL180            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        5.349        0.971 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0          340           66            0            0     2396.344            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
