<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.729            0            0            0            0            0            0            0            0            0            0            0      455.264      265.962 
       CELL2            0            0            0            0            0            0            0            0            0            0            0            0            0            0       60.263            0            0            0            0            0            0            0            0            0            0            0     2694.165     1244.607 
       CELL3            0            0            0            0            0            0            0            0            0            0            0            0            0            0       22.425            0            0            0            0            0            0            0            0            0            0            0     4038.366     2543.272 
       CELL4            0            0            0            0            0            0            0            0            0            0            0            0            0            0       38.205            0            0            0            0            0            0            0            0            0            0            0     1066.238       166.28 
       CELL5            0            0            0            0            0            0            0            0            0            0            0            0            0            0       69.199            0            0            0            0            0            0            0            0            0            0            0     4014.549     2539.191 
       CELL6            0            0            0            0            0            0            0            0            0            0            0            0            0            0       56.362            0            0            0            0            0            0            0            0            0            0            0     3061.578     2099.824 
       CELL7            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.415            0            0            0            0            0            0            0            0            0            0            0      563.207      530.634 
       CELL8            0            0            0            0            0            0            0            0            0            0            0            0            0            0       52.635            0            0            0            0            0            0            0            0            0            0            0     1608.437     1023.798 
       CELL9            0            0            0            0            0            0            0            0            0            0            0            0            0            0       13.935            0            0            0            0            0            0            0            0            0            0            0     4679.144     3610.379 
      CELL10            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.269            0            0            0            0            0            0            0            0            0            0            0     6179.738     3766.447 
      CELL11            0            0            0            0            0            0            0            0            0            0            0            0            0            0       21.154            0            0            0            0            0            0            0            0            0            0            0     5923.549     4517.524 
      CELL12            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.449            0            0            0            0            0            0            0            0            0            0            0      4003.63       4092.9 
      CELL13            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.059            0            0            0            0            0            0            0            0            0            0            0     5795.064     5460.558 
      CELL14            0            0            0            0            0            0            0            0            0            0            0            0            0            0       14.379            0            0            0            0            0            0            0            0            0            0            0     6400.747     4091.491 
      CELL15            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.567            0            0            0            0            0            0            0            0            0            0            0     2446.421     2302.572 
      CELL16            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      357.386      102.587 
      CELL17            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.113            0            0            0            0            0            0            0            0            0            0            0     4694.063     2095.516 
      CELL18            0            0            0            0            0            0            0            0            0            0            0            0            0            0       61.461            0            0            0            0            0            0            0            0            0            0            0     5562.211      4410.26 
      CELL19            0            0            0            0            0            0            0            0            0            0            0            0            0            0       39.042            0            0            0            0            0            0            0            0            0            0            0     6256.665     3248.246 
      CELL20            0            0            0            0            0            0            0            0            0            0            0            0            0            0       57.553            0            0            0            0            0            0            0            0            0            0            0     6101.634     2754.972 
      CELL21            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.991            0            0            0            0            0            0            0            0            0            0            0     6353.451     3918.576 
      CELL22            0            0            0            0            0            0            0            0            0            0            0            0            0            0       65.296            0            0            0            0            0            0            0            0            0            0            0     5827.632     5039.459 
      CELL23            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.488            0            0            0            0            0            0            0            0            0            0            0     6166.299     4958.342 
      CELL24            0            0            0            0            0            0            0            0            0            0            0            0            0            0       26.879            0            0            0            0            0            0            0            0            0            0            0     6320.435     3396.999 
      CELL25            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.748            0            0            0            0            0            0            0            0            0            0            0     3857.621     2504.022 
      CELL26            0            0            0            0            0            0            0            0            0            0            0            0            0            0       20.568            0            0            0            0            0            0            0            0            0            0            0      150.063       66.844 
      CELL27            0            0            0            0            0            0            0            0            0            0            0            0            0            0       66.073            0            0            0            0            0            0            0            0            0            0            0     2935.871     1463.871 
      CELL28            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.383            0            0            0            0            0            0            0            0            0            0            0     5920.214     3908.954 
      CELL29            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.345            0            0            0            0            0            0            0            0            0            0            0     6103.871     3774.435 
      CELL30            0            0            0            0            0            0            0            0            0            0            0            0            0            0       73.875            0            0            0            0            0            0            0            0            0            0            0     5755.716     2956.729 
      CELL31            0            0            0            0            0            0            0            0            0            0            0            0            0            0       71.952            0            0            0            0            0            0            0            0            0            0            0     5573.274     2585.754 
      CELL32            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.229            0            0            0            0            0            0            0            0            0            0            0     5262.575     2052.618 
      CELL33            0            0            0            0            0            0            0            0            0            0            0            0            0            0       47.705            0            0            0            0            0            0            0            0            0            0            0     6069.806     4427.294 
      CELL34            0            0            0            0            0            0            0            0            0            0            0            0            0            0       49.662            0            0            0            0            0            0            0            0            0            0            0     6132.948     3573.071 
      CELL35            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.204            0            0            0            0            0            0            0            0            0            0            0     6113.039      3193.59 
      CELL36            0            0            0            0            0            0            0            0            0            0            0            0            0            0       44.408            0            0            0            0            0            0            0            0            0            0            0     4495.936     2857.191 
      CELL37            0            0            0            0            0            0            0            0            0            0            0            0            0            0       18.722            0            0            0            0            0            0            0            0            0            0            0     2754.179     1124.917 
      CELL38            0            0            0            0            0            0            0            0            0            0            0            0            0            0       61.311            0            0            0            0            0            0            0            0            0            0            0      612.353      159.637 
      CELL39            0            0            0            0            0            0            0            0            0            0            0            0            0            0       68.088            0            0            0            0            0            0            0            0            0            0            0     5559.737     4110.216 
      CELL40            0            0            0            0            0            0            0            0            0            0            0            0            0            0        73.28            0            0            0            0            0            0            0            0            0            0            0     5776.854     3469.099 
      CELL41            0            0            0            0            0            0            0            0            0            0            0            0            0            0       58.436            0            0            0            0            0            0            0            0            0            0            0     5844.846     3302.538 
      CELL42            0            0            0            0            0            0            0            0            0            0            0            0            0            0       72.824            0            0            0            0            0            0            0            0            0            0            0     4002.611     1198.814 
      CELL43            0            0            0            0            0            0            0            0            0            0            0            0            0            0       73.663            0            0            0            0            0            0            0            0            0            0            0      5184.59     2215.762 
      CELL44            0            0            0            0            0            0            0            0            0            0            0            0            0            0       72.111            0            0            0            0            0            0            0            0            0            0            0     5918.341     3615.583 
      CELL45            0            0            0            0            0            0            0            0            0            0            0            0            0            0       28.861            0            0            0            0            0            0            0            0            0            0            0     6129.132     2741.955 
      CELL46            0            0            0            0            0            0            0            0            0            0            0            0            0            0       35.379            0            0            0            0            0            0            0            0            0            0            0     6227.855     3036.142 
      CELL47            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.496            0            0            0            0            0            0            0            0            0            0            0     5888.829     2540.044 
      CELL48            0            0            0            0            0            0            0            0            0            0            0            0            0            0       20.822            0            0            0            0            0            0            0            0            0            0            0     1665.693     1533.942 
      CELL49            0            0            0            0            0            0            0            0            0            0            0            0            0            0        49.27            0            0            0            0            0            0            0            0            0            0            0      1354.36      850.781 
      CELL50            0            0            0            0            0            0            0            0            0            0            0            0            0            0       55.355            0            0            0            0            0            0            0            0            0            0            0       46.278       21.957 
      CELL51            0            0            0            0            0            0            0            0            0            0            0            0            0            0       57.708            0            0            0            0            0            0            0            0            0            0            0     2582.939      891.279 
      CELL52            0            0            0            0            0            0            0            0            0            0            0            0            0            0        9.805            0            0            0            0            0            0            0            0            0            0            0     3799.609     1101.845 
      CELL53            0            0            0            0            0            0            0            0            0            0            0            0            0            0        9.483            0            0            0            0            0            0            0            0            0            0            0     6185.856     2509.023 
      CELL54            0            0            0            0            0            0            0            0            0            0            0            0            0            0       64.409            0            0            0            0            0            0            0            0            0            0            0     5991.647     2677.141 
      CELL55            0            0            0            0            0            0            0            0            0            0            0            0            0            0       33.398            0            0            0            0            0            0            0            0            0            0            0     5799.548     3390.966 
      CELL56            0            0            0            0            0            0            0            0            0            0            0            0            0            0       13.567            0            0            0            0            0            0            0            0            0            0            0     2001.605       702.01 
      CELL57            0            0            0            0            0            0            0            0            0            0            0            0            0            0       69.691            0            0            0            0            0            0            0            0            0            0            0     4305.065      2710.89 
      CELL58            0            0            0            0            0            0            0            0            0            0            0            0            0            0       42.895            0            0            0            0            0            0            0            0            0            0            0     4778.759     2273.788 
      CELL59            0            0            0            0            0            0            0            0            0            0            0            0            0            0        44.13            0            0            0            0            0            0            0            0            0            0            0     5963.173     4097.168 
      CELL60            0            0            0            0            0            0            0            0            0            0            0            0            0            0        52.73            0            0            0            0            0            0            0            0            0            0            0     5675.392     2753.438 
      CELL61            0            0            0            0            0            0            0            0            0            0            0            0            0            0       48.995            0            0            0            0            0            0            0            0            0            0            0     4795.354     1847.596 
      CELL62            0            0            0            0            0            0            0            0            0            0            0            0            0            0       47.526            0            0            0            0            0            0            0            0            0            0            0     1601.564      734.631 
      CELL63            0            0            0            0            0            0            0            0            0            0            0            0            0            0       42.914            0            0            0            0            0            0            0            0            0            0            0      222.378       76.375 
      CELL64            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1391.535       205.67 
      CELL65            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      5866.76     2350.773 
      CELL66            0            0            0            0            0            0            0            0            0            0            0            0            0            0       22.387            0            0            0            0            0            0            0            0            0            0            0     5930.057     1123.598 
      CELL67            0            0            0            0            0            0            0            0            0            0            0            0            0            0       16.088            0            0            0            0            0            0            0            0            0            0            0     6042.183     2264.288 
      CELL68            0            0            0            0            0            0            0            0            0            0            0            0            0            0       55.151            0            0            0            0            0            0            0            0            0            0            0     5372.631     1937.849 
      CELL69            0            0            0            0            0            0            0            0            0            0            0            0            0            0       18.232            0            0            0            0            0            0            0            0            0            0            0     3712.121     1749.376 
      CELL70            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.252            0            0            0            0            0            0            0            0            0            0            0     2402.895     2492.108 
      CELL71            0            0            0            0            0            0            0            0            0            0            0            0            0            0       28.347            0            0            0            0            0            0            0            0            0            0            0     3049.254     2755.131 
      CELL72            0            0            0            0            0            0            0            0            0            0            0            0            0            0       65.345            0            0            0            0            0            0            0            0            0            0            0      3786.46     2535.773 
      CELL73            0            0            0            0            0            0            0            0            0            0            0            0            0            0       65.355            0            0            0            0            0            0            0            0            0            0            0     3672.405     3007.257 
      CELL74            0            0            0            0            0            0            0            0            0            0            0            0            0            0       50.164            0            0            0            0            0            0            0            0            0            0            0     3373.663      1859.33 
      CELL75            0            0            0            0            0            0            0            0            0            0            0            0            0            0       38.761            0            0            0            0            0            0            0            0            0            0            0     2139.209      1149.04 
      CELL76            0            0            0            0            0            0            0            0            0            0            0            0            0            0       50.159            0            0            0            0            0            0            0            0            0            0            0      830.612      305.801 
      CELL77            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3420.885     1383.017 
      CELL78            0            0            0            0            0            0            0            0            0            0            0            0            0            0       28.672            0            0            0            0            0            0            0            0            0            0            0     6179.311     2385.892 
      CELL79            0            0            0            0            0            0            0            0            0            0            0            0            0            0       38.221            0            0            0            0            0            0            0            0            0            0            0     6004.686      2015.43 
      CELL80            0            0            0            0            0            0            0            0            0            0            0            0            0            0       46.669            0            0            0            0            0            0            0            0            0            0            0     5862.225     1374.993 
      CELL81            0            0            0            0            0            0            0            0            0            0            0            0            0            0       56.343            0            0            0            0            0            0            0            0            0            0            0     5749.333     1982.658 
      CELL82            0            0            0            0            0            0            0            0            0            0            0            0            0            0       52.463            0            0            0            0            0            0            0            0            0            0            0     3650.276     2080.095 
      CELL83            0            0            0            0            0            0            0            0            0            0            0            0            0            0        47.49            0            0            0            0            0            0            0            0            0            0            0     3304.023     2425.913 
      CELL84            0            0            0            0            0            0            0            0            0            0            0            0            0            0       57.968            0            0            0            0            0            0            0            0            0            0            0     5825.971     5964.938 
      CELL85            0            0            0            0            0            0            0            0            0            0            0            0            0            0       33.323            0            0            0            0            0            0            0            0            0            0            0      5419.16     4452.723 
      CELL86            0            0            0            0            0            0            0            0            0            0            0            0            0            0       70.297            0            0            0            0            0            0            0            0            0            0            0     5104.592     5028.469 
      CELL87            0            0            0            0            0            0            0            0            0            0            0            0            0            0       46.899            0            0            0            0            0            0            0            0            0            0            0      5541.47     5654.159 
      CELL88            0            0            0            0            0            0            0            0            0            0            0            0            0            0       57.129            0            0            0            0            0            0            0            0            0            0            0     5507.911     5645.313 
      CELL89            0            0            0            0            0            0            0            0            0            0            0            0            0            0       56.539            0            0            0            0            0            0            0            0            0            0            0      1922.01     1484.009 
      CELL90            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       892.93      534.333 
      CELL91            0            0            0            0            0            0            0            0            0            0            0            0            0            0        21.46            0            0            0            0            0            0            0            0            0            0            0     3684.184     2514.935 
      CELL92            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.285            0            0            0            0            0            0            0            0            0            0            0     5256.585     2742.125 
      CELL93            0            0            0            0            0            0            0            0            0            0            0            0            0            0        35.99            0            0            0            0            0            0            0            0            0            0            0     6279.403     2041.829 
      CELL94            0            0            0            0            0            0            0            0            0            0            0            0            0            0       35.834            0            0            0            0            0            0            0            0            0            0            0     6098.166     2689.001 
      CELL95            0            0            0            0            0            0            0            0            0            0            0            0            0            0       45.279            0            0            0            0            0            0            0            0            0            0            0     3257.217      879.597 
      CELL96            0            0            0            0            0            0            0            0            0            0            0            0            0            0       28.505            0            0            0            0            0            0            0            0            0            0            0     3678.593     1487.402 
      CELL97            0            0            0            0            0            0            0            0            0            0            0            0            0            0        66.01            0            0            0            0            0            0            0            0            0            0            0     5101.278     5259.784 
      CELL98            0            0            0            0            0            0            0            0            0            0            0            0            0            0        74.76            0            0            0            0            0            0            0            0            0            0            0      4785.42     4114.912 
      CELL99            0            0            0            0            0            0            0            0            0            0            0            0            0            0       63.117            0            0            0            0            0            0            0            0            0            0            0     5214.879     5366.539 
     CELL100            0            0            0            0            0            0            0            0            0            0            0            0            0            0       79.575            0            0            0            0            0            0            0            0            0            0            0     5885.126     5475.962 
     CELL101            0            0            0            0            0            0            0            0            0            0            0            0            0            0       77.652            0            0            0            0            0            0            0            0            0            0            0     5828.518     4824.258 
     CELL102            0            0            0            0            0            0            0            0            0            0            0            0            0            0       43.147            0            0            0            0            0            0            0            0            0            0            0     2226.391     1543.962 
     CELL103            0            0            0            0            0            0            0            0            0            0            0            0            0            0       14.332            0            0            0            0            0            0            0            0            0            0            0       545.69      330.326 
     CELL104            0            0            0            0            0            0            0            0            0            0            0            0            0            0       47.832            0            0            0            0            0            0            0            0            0            0            0     3751.184     1863.095 
     CELL105            0            0            0            0            0            0            0            0            0            0            0            0            0            0       55.515            0            0            0            0            0            0            0            0            0            0            0     4433.335     2212.268 
     CELL106            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      5015.56     1823.397 
     CELL107            0            0            0            0            0            0            0            0            0            0            0            0            0            0       74.073            0            0            0            0            0            0            0            0            0            0            0     4377.028     2222.045 
     CELL108            0            0            0            0            0            0            0            0            0            0            0            0            0            0       42.113            0            0            0            0            0            0            0            0            0            0            0     5334.743     3239.879 
     CELL109            0            0            0            0            0            0            0            0            0            0            0            0            0            0       42.961            0            0            0            0            0            0            0            0            0            0            0     3013.311     1769.156 
     CELL110            0            0            0            0            0            0            0            0            0            0            0            0            0            0       74.995            0            0            0            0            0            0            0            0            0            0            0     4424.797     2805.335 
     CELL111            0            0            0            0            0            0            0            0            0            0            0            0            0            0       88.737            0            0            0            0            0            0            0            0            0            0            0     5561.395      3672.21 
     CELL112            0            0            0            0            0            0            0            0            0            0            0            0            0            0       56.915            0            0            0            0            0            0            0            0            0            0            0     6120.147      3470.82 
     CELL113            0            0            0            0            0            0            0            0            0            0            0            0            0            0       85.607            0            0            0            0            0            0            0            0            0            0            0     3588.745     2532.085 
     CELL114            0            0            0            0            0            0            0            0            0            0            0            0            0            0       68.977            0            0            0            0            0            0            0            0            0            0            0       423.53      224.363 
     CELL115            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2101.687      414.756 
     CELL116            0            0            0            0            0            0            0            0            0            0            0            0            0            0       63.137            0            0            0            0            0            0            0            0            0            0            0      4677.31     3470.924 
     CELL117            0            0            0            0            0            0            0            0            0            0            0            0            0            0       82.824            0            0            0            0            0            0            0            0            0            0            0     5503.004     3466.693 
     CELL118            0            0            0            0            0            0            0            0            0            0            0            0            0            0       89.665            0            0            0            0            0            0            0            0            0            0            0      251.388      144.633 
     CELL119            0            0            0            0            0            0            0            0            0            0            0            0            0            0        91.01            0            0            0            0            0            0            0            0            0            0            0       454.37      296.054 
     CELL120            0            0            0            0            0            0            0            0            0            0            0            0            0            0       96.738            0            0            0            0            0            0            0            0            0            0            0     1429.987      698.512 
     CELL121            0            0            0            0            0            0            0            0            0            0            0            0            0            0       95.718            0            0            0            0            0            0            0            0            0            0            0     1786.603      981.679 
     CELL122            0            0            0            0            0            0            0            0            0            0            0            0            0            0       72.215            0            0            0            0            0            0            0            0            0            0            0       50.093       20.874 
     CELL123            0            0            0            0            0            0            0            0            0            0            0            0            0            0       88.365            0            0            0            0            0            0            0            0            0            0            0      270.835      178.801 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5682.484            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
