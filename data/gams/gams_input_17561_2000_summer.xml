<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, CELL188, CELL189, CELL190, CELL191, CELL192, CELL193, CELL194, CELL195, CELL196, CELL197, CELL198, CELL199, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, CELL188, CELL189, CELL190, CELL191, CELL192, CELL193, CELL194, CELL195, CELL196, CELL197, CELL198, CELL199 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0            0        0.291            0            0            0            0            0            0            0            0            0            0            0            0            0            0       80.679        1.005 
       CELL2            0            0            0            0            0            0            0            0            0            0            0        0.076            0            0            0            0            0            0            0            0            0            0            0            0            0            0      400.937       10.813 
       CELL3            0            0            0            0            0            0            0            0            0            0        3.942        0.196            0            0        1.184            0            0            0            0            0            0            0            0            0            0            0      509.817       20.281 
       CELL4            0            0            0            0            0            0            0            0            0            0       16.137        0.803            0            0        4.796            0            0            0            0            0            0            0            0            0            0            0      113.422        3.388 
       CELL5            0            0            0            0            0            0            0            0            0            0            0        0.172            0            0            0            0            0            0            0            0            0            0            0            0            0            0      722.352       50.792 
       CELL6            0            0            0            0            0            0            0            0            0            0            0        0.256            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3790.656       66.408 
       CELL7            0            0            0            0            0            0            0            0            0            0            0        0.045            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3619.715       35.285 
       CELL8            0            0            0            0            0            0            0            0            0            0            0        0.019            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5218.202       77.898 
       CELL9            0            0            0            0            0            0            0            0            0            0            0        0.159            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4668.776      440.056 
      CELL10            0            0            0            0            0            0            0            0            0            0            0        0.253            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3128.791      350.924 
      CELL11            0            0            0            0            0            0            0            0            0            0            0        0.132            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1845.081      194.317 
      CELL12            0            0            0            0            0            0            0            0            0            0        1.242        0.061            0            0        0.372            0            0            0            0            0            0            0            0            0            0            0     1652.462        51.69 
      CELL13            0            0            0            0            0            0            0            0            0            0       13.474        0.667            0            0        4.038            0            0            0            0            0            0            0            0            0            0            0     1979.697      175.104 
      CELL14            0            0            0            0            0            0            0            0            0            0        6.112        0.302            0            0        1.813            0            0            0            0            0            0            0            0            0            0            0     1500.119      977.969 
      CELL15            0            0            0            0            0            0            0            0            0            0            0        1.633            0            0            0            0            0            0            0            0            0            0            0            0            0            0      303.641       22.546 
      CELL16            0            0            0            0            0            0            0            0            0            0            0        1.713            0            0            0            0            0            0            0            0            0            0            0            0            0            0      199.839       64.007 
      CELL17            0            0            0            0            0            0            0            0            0            0            0          0.1            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1000.445       16.742 
      CELL18            0            0            0            0            0            0            0            0            0            0            0        0.059            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4193.955       82.418 
      CELL19            0            0            0            0            0            0            0            0            0            0            0        0.261            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5082.974      157.007 
      CELL20            0            0            0            0            0            0            0            0            0            0            0        0.118            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5378.373       226.56 
      CELL21            0            0            0            0            0            0            0            0            0            0            0        0.154            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4930.432      523.684 
      CELL22            0            0            0            0            0            0            0            0            0            0            0        0.154            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5463.133      344.528 
      CELL23            0            0            0            0            0            0            0            0            0            0            0        0.013            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5614.475      537.182 
      CELL24            0            0            0            0            0            0            0            0            0            0        3.496        0.173            0            0        1.048            0            0            0            0            0            0            0            0            0            0            0     5730.139      558.866 
      CELL25            0            0            0            0            0            0            0            0            0            0       16.853        0.833            0            0        4.954            0            0            0            0            0            0            0            0            0            0            0     5585.848      423.748 
      CELL26            0            0            0            0            0            0            0            0            0            0       17.379        0.857            0            0        4.967            0            0            0            0            0            0            0            0            0            0            0     3521.417      393.822 
      CELL27            0            0            0            0            0            0            0            0            0            0            0         1.63            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3244.727      259.192 
      CELL28            0            0            0            0            0            0            0            0            0            0       30.274        1.487            0            0        8.982            0            0            0            0            0            0            0            0            0            0            0     5101.291      231.905 
      CELL29            0            0            0            0            0            0            0            0            0            0            0         1.21            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3259.538      708.117 
      CELL30            0            0            0            0            0            0            0            0            0            0        5.082        0.254            0            0        1.511            0            0            0            0            0            0            0            0            0            0            0      102.631        1.488 
      CELL31            0            0            0            0            0            0            0            0            0            0            0        0.018            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1698.783            0 
      CELL32            0            0            0            0            0            0            0            0            0            0            0        0.046            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2815.821       47.592 
      CELL33            0            0            0            0            0            0            0            0            0            0            0        0.462            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4092.473       184.75 
      CELL34            0            0            0            0            0            0            0            0            0            0            0        0.285            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5535.955      528.718 
      CELL35            0            0            0            0            0            0            0            0            0            0            0        0.259            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5388.193      506.207 
      CELL36            0            0            0            0            0            0            0            0            0            0            0        0.364            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5462.115      420.819 
      CELL37            0            0            0            0            0            0            0            0            0            0            0        0.248            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5521.326     1021.589 
      CELL38            0            0            0            0            0            0            0            0            0            0       11.563        0.571            0            0        3.337            0            0            0            0            0            0            0            0            0            0            0     5412.295     1228.337 
      CELL39            0            0            0            0            0            0            0            0            0            0        5.796        0.286            0            0        1.656            0            0            0            0            0            0            0            0            0            0            0     5212.824     1238.703 
      CELL40            0            0            0            0            0            0            0            0            0            0        33.64        1.654            0            0        9.608            0            0            0            0            0            0            0            0            0            0            0     5306.851     1231.563 
      CELL41            0            0            0            0            0            0            0            0            0            0       30.756        1.509            0            0        8.948            0            0            0            0            0            0            0            0            0            0            0     5303.043     1138.833 
      CELL42            0            0            0            0            0            0            0            0            0            0       19.698        0.968            0            0        5.785            0            0            0            0            0            0            0            0            0            0            0     4961.512       813.43 
      CELL43            0            0            0            0            0            0            0            0            0            0        1.342        0.067            0            0        0.412            0            0            0            0            0            0            0            0            0            0            0     1369.864        0.089 
      CELL44            0            0            0            0            0            0            0            0            0            0            0         0.06            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3452.482       24.207 
      CELL45            0            0            0            0            0            0            0            0            0            0            0        0.224            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4742.619      151.318 
      CELL46            0            0            0            0            0            0            0            0            0            0            0        0.374            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5115.456      392.428 
      CELL47            0            0            0            0            0            0            0            0            0            0            0        0.072            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5406.689      338.857 
      CELL48            0            0            0            0            0            0            0            0            0            0        10.78        0.533            0            0         3.14            0            0            0            0            0            0            0            0            0            0            0     5145.555       529.56 
      CELL49            0            0            0            0            0            0            0            0            0            0        4.815        0.238            0            0        1.402            0            0            0            0            0            0            0            0            0            0            0     5340.039      1908.53 
      CELL50            0            0            0            0            0            0            0            0            0            0       30.517        1.505            0            0         8.72            0            0            0            0            0            0            0            0            0            0            0     5278.177     1486.488 
      CELL51            0            0            0            0            0            0            0            0            0            0        9.575        0.471            0            0        2.761            0            0            0            0            0            0            0            0            0            0            0     5306.144     1636.658 
      CELL52            0            0            0            0            0            0            0            0            0            0       19.329         0.95            0            0        5.571            0            0            0            0            0            0            0            0            0            0            0     5503.213     1933.562 
      CELL53            0            0            0            0            0            0            0            0            0            0       26.839        1.319            0            0        7.734            0            0            0            0            0            0            0            0            0            0            0     5281.724     2688.762 
      CELL54            0            0            0            0            0            0            0            0            0            0       14.297        0.702            0            0        4.199            0            0            0            0            0            0            0            0            0            0            0     5548.651     1893.271 
      CELL55            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       477.73      112.157 
      CELL56            0            0            0            0            0            0            0            0            0            0       12.997        0.646            0            0        3.826            0            0            0            0            0            0            0            0            0            0            0      343.762        2.458 
      CELL57            0            0            0            0            0            0            0            0            0            0       10.803        0.536            0            0        3.212            0            0            0            0            0            0            0            0            0            0            0     3914.409       56.159 
      CELL58            0            0            0            0            0            0            0            0            0            0        3.689        0.183            0            0        1.107            0            0            0            0            0            0            0            0            0            0            0     4854.312       10.902 
      CELL59            0            0            0            0            0            0            0            0            0            0            0        0.323            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5412.933      401.722 
      CELL60            0            0            0            0            0            0            0            0            0            0       10.693        0.529            0            0        3.144            0            0            0            0            0            0            0            0            0            0            0      5446.68      619.861 
      CELL61            0            0            0            0            0            0            0            0            0            0        7.611        0.376            0            0        2.216            0            0            0            0            0            0            0            0            0            0            0     5290.009     1077.624 
      CELL62            0            0            0            0            0            0            0            0            0            0        9.701        0.479            0            0        2.851            0            0            0            0            0            0            0            0            0            0            0     5423.399      525.354 
      CELL63            0            0            0            0            0            0            0            0            0            0        7.693        0.379            0            0        2.218            0            0            0            0            0            0            0            0            0            0            0     5358.985     1317.275 
      CELL64            0            0            0            0            0            0            0            0            0            0            0        0.685            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5307.025     1285.437 
      CELL65            0            0            0            0            0            0            0            0            0            0            0        0.644            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5669.697     1969.293 
      CELL66            0            0            0            0            0            0            0            0            0            0            0        1.522            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5435.636      1538.79 
      CELL67            0            0            0            0            0            0            0            0            0            0       27.945         1.37            0            0        8.129            0            0            0            0            0            0            0            0            0            0            0      5862.51     1103.777 
      CELL68            0            0            0            0            0            0            0            0            0            0        5.871        0.288            0            0         1.74            0            0            0            0            0            0            0            0            0            0            0      1861.37      797.094 
      CELL69            0            0            0            0            0            0            0            0            0            0        6.026        0.299            0            0        1.772            0            0            0            0            0            0            0            0            0            0            0       41.803        0.664 
      CELL70            0            0            0            0            0            0            0            0            0            0        3.526        0.175            0            0         1.07            0            0            0            0            0            0            0            0            0            0            0     3762.067       24.284 
      CELL71            0            0            0            0            0            0            0            0            0            0        5.491        0.272            0            0         1.63            0            0            0            0            0            0            0            0            0            0            0     4072.158      377.014 
      CELL72            0            0            0            0            0            0            0            0            0            0        2.477        0.122            0            0        0.735            0            0            0            0            0            0            0            0            0            0            0     4994.526      539.817 
      CELL73            0            0            0            0            0            0            0            0            0            0        2.712        0.134            0            0        0.782            0            0            0            0            0            0            0            0            0            0            0     5151.382      708.694 
      CELL74            0            0            0            0            0            0            0            0            0            0         6.18        0.305            0            0        1.799            0            0            0            0            0            0            0            0            0            0            0     5373.627      1252.77 
      CELL75            0            0            0            0            0            0            0            0            0            0       16.061        0.792            0            0        4.674            0            0            0            0            0            0            0            0            0            0            0     5298.892     1618.073 
      CELL76            0            0            0            0            0            0            0            0            0            0       12.338        0.608            0            0        3.523            0            0            0            0            0            0            0            0            0            0            0     5400.731     2516.259 
      CELL77            0            0            0            0            0            0            0            0            0            0       10.751        0.529            0            0        3.042            0            0            0            0            0            0            0            0            0            0            0     5332.036     1769.335 
      CELL78            0            0            0            0            0            0            0            0            0            0            0          0.3            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5556.372     1821.114 
      CELL79            0            0            0            0            0            0            0            0            0            0       16.138        0.792            0            0         4.65            0            0            0            0            0            0            0            0            0            0            0      5512.61      665.212 
      CELL80            0            0            0            0            0            0            0            0            0            0       26.069        1.278            0            0        7.653            0            0            0            0            0            0            0            0            0            0            0     5761.201     2401.981 
      CELL81            0            0            0            0            0            0            0            0            0            0       25.391        1.245            0            0        7.525            0            0            0            0            0            0            0            0            0            0            0     4080.146     2104.248 
      CELL82            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       35.568       17.566 
      CELL83            0            0            0            0            0            0            0            0            0            0        7.997        0.396            0            0        2.421            0            0            0            0            0            0            0            0            0            0            0      306.133        7.732 
      CELL84            0            0            0            0            0            0            0            0            0            0        2.958        0.146            0            0        0.896            0            0            0            0            0            0            0            0            0            0            0     2766.695      194.652 
      CELL85            0            0            0            0            0            0            0            0            0            0       12.413        0.613            0            0        3.719            0            0            0            0            0            0            0            0            0            0            0     4743.151     1499.806 
      CELL86            0            0            0            0            0            0            0            0            0            0       14.722        0.727            0            0        4.285            0            0            0            0            0            0            0            0            0            0            0     4594.677     1227.997 
      CELL87            0            0            0            0            0            0            0            0            0            0        7.005        0.346            0            0        2.057            0            0            0            0            0            0            0            0            0            0            0     4462.074     1526.808 
      CELL88            0            0            0            0            0            0            0            0            0            0        7.016        0.346            0            0        2.061            0            0            0            0            0            0            0            0            0            0            0     4678.118     1491.713 
      CELL89            0            0            0            0            0            0            0            0            0            0       12.064        0.594            0            0        3.445            0            0            0            0            0            0            0            0            0            0            0     4552.951     2771.782 
      CELL90            0            0            0            0            0            0            0            0            0            0       20.136         0.99            0            0        5.696            0            0            0            0            0            0            0            0            0            0            0     4712.658     3616.579 
      CELL91            0            0            0            0            0            0            0            0            0            0        29.01        1.424            0            0         8.28            0            0            0            0            0            0            0            0            0            0            0     4467.488     3492.315 
      CELL92            0            0            0            0            0            0            0            0            0            0        34.42        1.689            0            0        9.916            0            0            0            0            0            0            0            0            0            0            0     5548.598     3618.981 
      CELL93            0            0            0            0            0            0            0            0            0            0       18.558        0.911            0            0        5.398            0            0            0            0            0            0            0            0            0            0            0      5706.52     3670.454 
      CELL94            0            0            0            0            0            0            0            0            0            0       19.079        0.935            0            0        5.654            0            0            0            0            0            0            0            0            0            0            0      4326.11     2741.664 
      CELL95            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      465.862      144.327 
      CELL96            0            0            0            0            0            0            0            0            0            0            0        0.458            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1170.575       20.157 
      CELL97            0            0            0            0            0            0            0            0            0            0            0        0.305            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4438.919      884.465 
      CELL98            0            0            0            0            0            0            0            0            0            0       11.438        0.564            0            0        3.332            0            0            0            0            0            0            0            0            0            0            0     4936.175        623.7 
      CELL99            0            0            0            0            0            0            0            0            0            0       19.791        0.975            0            0        5.816            0            0            0            0            0            0            0            0            0            0            0      5242.45      1512.43 
     CELL100            0            0            0            0            0            0            0            0            0            0       16.611        0.818            0            0        4.976            0            0            0            0            0            0            0            0            0            0            0     5350.316     2138.254 
     CELL101            0            0            0            0            0            0            0            0            0            0         9.33        0.459            0            0        2.689            0            0            0            0            0            0            0            0            0            0            0     5249.003     1724.125 
     CELL102            0            0            0            0            0            0            0            0            0            0            0        0.873            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5335.502     1678.918 
     CELL103            0            0            0            0            0            0            0            0            0            0            0        0.557            0            0            0            0            0            0            0            0            0            0            0            0            0            0      5115.55     2259.345 
     CELL104            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4191.848     2234.436 
     CELL105            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4202.609     2842.688 
     CELL106            0            0            0            0            0            0            0            0            0            0       19.841        0.972            0            0        5.936            0            0            0            0            0            0            0            0            0            0            0     5235.455     2807.289 
     CELL107            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      713.541      196.614 
     CELL108            0            0            0            0            0            0            0            0            0            0         1.82         0.09            0            0        0.558            0            0            0            0            0            0            0            0            0            0            0       96.141        1.387 
     CELL109            0            0            0            0            0            0            0            0            0            0            0        0.076            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2509.607       48.778 
     CELL110            0            0            0            0            0            0            0            0            0            0            0        0.489            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3557.157      413.428 
     CELL111            0            0            0            0            0            0            0            0            0            0       20.012        0.984            0            0        5.938            0            0            0            0            0            0            0            0            0            0            0     4999.821       902.04 
     CELL112            0            0            0            0            0            0            0            0            0            0       10.271        0.506            0            0        3.047            0            0            0            0            0            0            0            0            0            0            0     5223.456     1796.586 
     CELL113            0            0            0            0            0            0            0            0            0            0       27.619        1.359            0            0        8.038            0            0            0            0            0            0            0            0            0            0            0     5373.984     2727.078 
     CELL114            0            0            0            0            0            0            0            0            0            0            0        1.468            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5438.017     1478.447 
     CELL115            0            0            0            0            0            0            0            0            0            0            0        0.763            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5358.885      772.557 
     CELL116            0            0            0            0            0            0            0            0            0            0       36.055        1.766            0            0       10.584            0            0            0            0            0            0            0            0            0            0            0     4163.946     1043.495 
     CELL117            0            0            0            0            0            0            0            0            0            0        35.41        1.734            0            0       10.595            0            0            0            0            0            0            0            0            0            0            0     5753.284     2396.581 
     CELL118            0            0            0            0            0            0            0            0            0            0        6.688        0.327            0            0        2.021            0            0            0            0            0            0            0            0            0            0            0     5541.395      2037.54 
     CELL119            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      409.073       14.938 
     CELL120            0            0            0            0            0            0            0            0            0            0            0        0.106            0            0            0            0            0            0            0            0            0            0            0            0            0            0      370.781       15.481 
     CELL121            0            0            0            0            0            0            0            0            0            0            0        0.542            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2807.585      128.335 
     CELL122            0            0            0            0            0            0            0            0            0            0       15.554        0.765            0            0         4.66            0            0            0            0            0            0            0            0            0            0            0     4962.421     1381.498 
     CELL123            0            0            0            0            0            0            0            0            0            0        27.79        1.365            0            0        8.406            0            0            0            0            0            0            0            0            0            0            0     4278.555     1343.181 
     CELL124            0            0            0            0            0            0            0            0            0            0       27.761        1.368            0            0        8.076            0            0            0            0            0            0            0            0            0            0            0      5333.77     1995.636 
     CELL125            0            0            0            0            0            0            0            0            0            0       36.197        1.779            0            0       10.428            0            0            0            0            0            0            0            0            0            0            0     5323.596     2998.228 
     CELL126            0            0            0            0            0            0            0            0            0            0       27.028        1.325            0            0        7.858            0            0            0            0            0            0            0            0            0            0            0     5361.552     2102.967 
     CELL127            0            0            0            0            0            0            0            0            0            0       35.004        1.714            0            0       10.274            0            0            0            0            0            0            0            0            0            0            0     4794.836      940.087 
     CELL128            0            0            0            0            0            0            0            0            0            0       21.665         1.06            0            0        6.358            0            0            0            0            0            0            0            0            0            0            0     5679.589     3582.817 
     CELL129            0            0            0            0            0            0            0            0            0            0       18.815         0.92            0            0        5.574            0            0            0            0            0            0            0            0            0            0            0      4679.24     1264.845 
     CELL130            0            0            0            0            0            0            0            0            0            0            0        0.887            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1017.305        9.787 
     CELL131            0            0            0            0            0            0            0            0            0            0            0        1.381            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5350.047      1247.66 
     CELL132            0            0            0            0            0            0            0            0            0            0       27.681        1.363            0            0        8.628            0            0            0            0            0            0            0            0            0            0            0     5017.741      796.686 
     CELL133            0            0            0            0            0            0            0            0            0            0       32.234        1.586            0            0        9.562            0            0            0            0            0            0            0            0            0            0            0     4911.722     1899.884 
     CELL134            0            0            0            0            0            0            0            0            0            0       20.327        0.997            0            0        5.855            0            0            0            0            0            0            0            0            0            0            0     5071.731     1852.225 
     CELL135            0            0            0            0            0            0            0            0            0            0       41.184        2.017            0            0       11.975            0            0            0            0            0            0            0            0            0            0            0     5427.058     2540.286 
     CELL136            0            0            0            0            0            0            0            0            0            0       10.325        0.505            0            0        3.001            0            0            0            0            0            0            0            0            0            0            0     5583.368     2275.716 
     CELL137            0            0            0            0            0            0            0            0            0            0        9.094        0.444            0            0        2.669            0            0            0            0            0            0            0            0            0            0            0     5645.363     2031.553 
     CELL138            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2728.889      229.341 
     CELL139            0            0            0            0            0            0            0            0            0            0            0        0.416            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1308.08        9.859 
     CELL140            0            0            0            0            0            0            0            0            0            0       28.957        1.422            0            0        9.022            0            0            0            0            0            0            0            0            0            0            0     5464.274      343.619 
     CELL141            0            0            0            0            0            0            0            0            0            0       10.196        0.502            0            0        3.176            0            0            0            0            0            0            0            0            0            0            0     5494.349      960.477 
     CELL142            0            0            0            0            0            0            0            0            0            0       23.271        1.143            0            0        7.175            0            0            0            0            0            0            0            0            0            0            0     5154.055     2814.783 
     CELL143            0            0            0            0            0            0            0            0            0            0       31.012        1.519            0            0        9.655            0            0            0            0            0            0            0            0            0            0            0     5062.272     3381.857 
     CELL144            0            0            0            0            0            0            0            0            0            0       38.867        1.903            0            0       11.977            0            0            0            0            0            0            0            0            0            0            0     5440.256     1378.484 
     CELL145            0            0            0            0            0            0            0            0            0            0       14.134        0.691            0            0        4.312            0            0            0            0            0            0            0            0            0            0            0     4815.785     1164.261 
     CELL146            0            0            0            0            0            0            0            0            0            0        7.493        0.366            0            0        2.309            0            0            0            0            0            0            0            0            0            0            0     5178.583     1157.841 
     CELL147            0            0            0            0            0            0            0            0            0            0            0         0.13            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2648.303      144.053 
     CELL148            0            0            0            0            0            0            0            0            0            0            0        0.247            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1533.806            0 
     CELL149            0            0            0            0            0            0            0            0            0            0       23.714        1.165            0            0        7.466            0            0            0            0            0            0            0            0            0            0            0     5349.256      165.608 
     CELL150            0            0            0            0            0            0            0            0            0            0       32.375         1.59            0            0       10.293            0            0            0            0            0            0            0            0            0            0            0     5343.846     1284.359 
     CELL151            0            0            0            0            0            0            0            0            0            0       35.386        1.738            0            0       11.366            0            0            0            0            0            0            0            0            0            0            0      5360.68     1835.257 
     CELL152            0            0            0            0            0            0            0            0            0            0       31.587        1.551            0            0       10.046            0            0            0            0            0            0            0            0            0            0            0     4768.583     2073.264 
     CELL153            0            0            0            0            0            0            0            0            0            0       41.672        2.042            0            0       12.977            0            0            0            0            0            0            0            0            0            0            0     5317.731     1392.982 
     CELL154            0            0            0            0            0            0            0            0            0            0       32.032        1.566            0            0       10.179            0            0            0            0            0            0            0            0            0            0            0     5254.767      925.257 
     CELL155            0            0            0            0            0            0            0            0            0            0       36.391        1.777            0            0       11.564            0            0            0            0            0            0            0            0            0            0            0     5171.134     2791.124 
     CELL156            0            0            0            0            0            0            0            0            0            0       20.769        1.013            0            0        6.597            0            0            0            0            0            0            0            0            0            0            0     3000.648       984.22 
     CELL157            0            0            0            0            0            0            0            0            0            0            0        0.373            0            0            0            0            0            0            0            0            0            0            0            0            0            0      366.631       78.334 
     CELL158            0            0            0            0            0            0            0            0            0            0       22.903        1.124            0            0        7.362            0            0            0            0            0            0            0            0            0            0            0     5372.476      275.117 
     CELL159            0            0            0            0            0            0            0            0            0            0       35.106        1.722            0            0       11.278            0            0            0            0            0            0            0            0            0            0            0      5562.89      912.591 
     CELL160            0            0            0            0            0            0            0            0            0            0       23.939        1.176            0            0        7.857            0            0            0            0            0            0            0            0            0            0            0     5341.523     1321.559 
     CELL161            0            0            0            0            0            0            0            0            0            0       26.991        1.324            0            0        8.857            0            0            0            0            0            0            0            0            0            0            0     5026.441      986.421 
     CELL162            0            0            0            0            0            0            0            0            0            0       43.038        2.107            0            0       14.115            0            0            0            0            0            0            0            0            0            0            0     5187.618     2050.189 
     CELL163            0            0            0            0            0            0            0            0            0            0       24.439        1.193            0            0        7.847            0            0            0            0            0            0            0            0            0            0            0     5552.768     2865.261 
     CELL164            0            0            0            0            0            0            0            0            0            0       38.595        1.882            0            0       12.521            0            0            0            0            0            0            0            0            0            0            0     5485.273     1720.373 
     CELL165            0            0            0            0            0            0            0            0            0            0       45.574         2.22            0            0       14.477            0            0            0            0            0            0            0            0            0            0            0     5047.129      578.763 
     CELL166            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      279.575       35.235 
     CELL167            0            0            0            0            0            0            0            0            0            0            0        1.221            0            0            0            0            0            0            0            0            0            0            0            0            0            0       159.39        9.677 
     CELL168            0            0            0            0            0            0            0            0            0            0       24.707        1.213            0            0        8.115            0            0            0            0            0            0            0            0            0            0            0      906.172       31.605 
     CELL169            0            0            0            0            0            0            0            0            0            0       41.127        2.019            0            0       13.499            0            0            0            0            0            0            0            0            0            0            0     4337.501      342.066 
     CELL170            0            0            0            0            0            0            0            0            0            0       28.775        1.411            0            0        9.442            0            0            0            0            0            0            0            0            0            0            0     2435.288      328.588 
     CELL171            0            0            0            0            0            0            0            0            0            0       26.433        1.295            0            0        8.765            0            0            0            0            0            0            0            0            0            0            0     2658.156      623.972 
     CELL172            0            0            0            0            0            0            0            0            0            0       45.078        2.203            0            0       15.109            0            0            0            0            0            0            0            0            0            0            0     4871.281      1688.15 
     CELL173            0            0            0            0            0            0            0            0            0            0       36.671        1.789            0            0       12.291            0            0            0            0            0            0            0            0            0            0            0     5013.274      534.291 
     CELL174            0            0            0            0            0            0            0            0            0            0       49.216        2.398            0            0       16.136            0            0            0            0            0            0            0            0            0            0            0     5284.255      406.779 
     CELL175            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5077.303       96.934 
     CELL176            0            0            0            0            0            0            0            0            0            0            0         1.37            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2115.405            0 
     CELL177            0            0            0            0            0            0            0            0            0            0       32.268        1.581            0            0       10.702            0            0            0            0            0            0            0            0            0            0            0      214.448       28.397 
     CELL178            0            0            0            0            0            0            0            0            0            0       22.728        1.109            0            0        7.616            0            0            0            0            0            0            0            0            0            0            0     3515.747      516.702 
     CELL179            0            0            0            0            0            0            0            0            0            0       52.102        2.539            0            0       17.454            0            0            0            0            0            0            0            0            0            0            0     5441.078      598.757 
     CELL180            0            0            0            0            0            0            0            0            0            0       50.259        2.446            0            0       16.834            0            0            0            0            0            0            0            0            0            0            0      4841.68      324.521 
     CELL181            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      3588.09       26.818 
     CELL182            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3260.164         77.2 
     CELL183            0            0            0            0            0            0            0            0            0            0       44.553        2.176            0            0       15.096            0            0            0            0            0            0            0            0            0            0            0     3074.171      774.088 
     CELL184            0            0            0            0            0            0            0            0            0            0       42.144        2.054            0            0       14.116            0            0            0            0            0            0            0            0            0            0            0     4853.725      1422.07 
     CELL185            0            0            0            0            0            0            0            0            0            0       43.131        2.097            0            0       14.606            0            0            0            0            0            0            0            0            0            0            0     4928.966     1780.321 
     CELL186            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1714.124       22.713 
     CELL187            0            0            0            0            0            0            0            0            0            0            0        0.942            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2750.807      454.503 
     CELL188            0            0            0            0            0            0            0            0            0            0       44.947        2.187            0            0       15.524            0            0            0            0            0            0            0            0            0            0            0     1469.099      442.788 
     CELL189            0            0            0            0            0            0            0            0            0            0       47.988        2.332            0            0       16.567            0            0            0            0            0            0            0            0            0            0            0     4839.517      842.539 
     CELL190            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       1268.6        5.881 
     CELL191            0            0            0            0            0            0            0            0            0            0            0        2.098            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2176.219       91.458 
     CELL192            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0 
     CELL193            0            0            0            0            0            0            0            0            0            0        57.78         2.81            0            0       20.124            0            0            0            0            0            0            0            0            0            0            0     1884.991      282.272 
     CELL194            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      738.267       10.197 
     CELL195            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      199.457        10.58 
     CELL196            0            0            0            0            0            0            0            0            0            0         62.4        3.023            0            0        21.92            0            0            0            0            0            0            0            0            0            0            0      266.801       23.776 
     CELL197            0            0            0            0            0            0            0            0            0            0       39.635        1.917            0            0       13.802            0            0            0            0            0            0            0            0            0            0            0      402.622      194.833 
     CELL198            0            0            0            0            0            0            0            0            0            0       50.413        2.439            0            0       17.548            0            0            0            0            0            0            0            0            0            0            0      793.651      100.794 
     CELL199            0            0            0            0            0            0            0            0            0            0        53.18        2.574            0            0       18.515            0            0            0            0            0            0            0            0            0            0            0      718.164      237.347 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0         2878          170            0            0       901.13            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
