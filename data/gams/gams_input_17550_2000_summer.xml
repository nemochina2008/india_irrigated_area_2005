<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, CELL188, CELL189, CELL190, CELL191, CELL192, CELL193, CELL194, CELL195, CELL196, CELL197, CELL198, CELL199, CELL200, CELL201, CELL202, CELL203, CELL204, CELL205, CELL206, CELL207, CELL208, CELL209, CELL210, CELL211, CELL212, CELL213, CELL214, CELL215, CELL216, CELL217, CELL218, CELL219, CELL220, CELL221, CELL222, CELL223, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, CELL188, CELL189, CELL190, CELL191, CELL192, CELL193, CELL194, CELL195, CELL196, CELL197, CELL198, CELL199, CELL200, CELL201, CELL202, CELL203, CELL204, CELL205, CELL206, CELL207, CELL208, CELL209, CELL210, CELL211, CELL212, CELL213, CELL214, CELL215, CELL216, CELL217, CELL218, CELL219, CELL220, CELL221, CELL222, CELL223 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0            0        0.349            0            0            0            0            0            0            0            0            0            0            0            0            0            0       28.229            0 
       CELL2            0            0            0            0            0            0            0            0            0            0            0        4.383            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1553.23      104.389 
       CELL3            0            0            0            0            0            0            0            0            0            0            0        0.922            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1127.07       75.906 
       CELL4            0            0            0            0            0            0            0            0            0            0            0        1.639            0            0            0            0            0            0            0            0            0            0            0            0            0            0      139.081        1.051 
       CELL5            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      180.745            0 
       CELL6            0            0            0            0            0            0            0            0            0            0            0         1.15            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3720.297      532.345 
       CELL7            0            0            0            0            0            0            0            0            0            0        8.247        1.116            0            0        4.155            0            0            0            0            0            0            0            0            0            0            0      4734.88        278.8 
       CELL8            0            0            0            0            0            0            0            0            0            0            0         1.63            0            0            0            0            0            0            0            0            0            0            0            0            0            0      2462.15      106.405 
       CELL9            0            0            0            0            0            0            0            0            0            0         1.61        0.219            0            0        0.737            0            0            0            0            0            0            0            0            0            0            0     3219.823       270.97 
      CELL10            0            0            0            0            0            0            0            0            0            0       56.589        7.711            0            0       25.877            0            0            0            0            0            0            0            0            0            0            0     1358.786        91.93 
      CELL11            0            0            0            0            0            0            0            0            0            0        5.784        0.788            0            0        2.644            0            0            0            0            0            0            0            0            0            0            0     2277.768      250.877 
      CELL12            0            0            0            0            0            0            0            0            0            0       60.548         8.24            0            0       27.677            0            0            0            0            0            0            0            0            0            0            0      809.786       74.621 
      CELL13            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        29.06        1.457 
      CELL14            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       59.259       11.338 
      CELL15            0            0            0            0            0            0            0            0            0            0        1.912        0.259            0            0        0.946            0            0            0            0            0            0            0            0            0            0            0     4533.104      215.009 
      CELL16            0            0            0            0            0            0            0            0            0            0       22.649        3.061            0            0       11.509            0            0            0            0            0            0            0            0            0            0            0     5696.067      694.313 
      CELL17            0            0            0            0            0            0            0            0            0            0            0        1.122            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3753.115      264.117 
      CELL18            0            0            0            0            0            0            0            0            0            0            0        0.361            0            0            0            0            0            0            0            0            0            0            0            0            0            0      936.124      109.835 
      CELL19            0            0            0            0            0            0            0            0            0            0            0        4.222            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2115.381       114.25 
      CELL20            0            0            0            0            0            0            0            0            0            0       68.502        9.312            0            0       31.348            0            0            0            0            0            0            0            0            0            0            0     4331.733      459.225 
      CELL21            0            0            0            0            0            0            0            0            0            0       34.101        4.638            0            0         15.6            0            0            0            0            0            0            0            0            0            0            0     3153.216      427.038 
      CELL22            0            0            0            0            0            0            0            0            0            0       63.973        8.705            0            0       29.245            0            0            0            0            0            0            0            0            0            0            0     5097.422      671.272 
      CELL23            0            0            0            0            0            0            0            0            0            0       59.107        8.041            0            0        27.02            0            0            0            0            0            0            0            0            0            0            0     1112.407      149.377 
      CELL24            0            0            0            0            0            0            0            0            0            0       50.001        6.795            0            0        22.86            0            0            0            0            0            0            0            0            0            0            0      720.226      111.105 
      CELL25            0            0            0            0            0            0            0            0            0            0            0        0.128            0            0            0            0            0            0            0            0            0            0            0            0            0            0      361.411            0 
      CELL26            0            0            0            0            0            0            0            0            0            0            0        0.031            0            0            0            0            0            0            0            0            0            0            0            0            0            0      145.804            0 
      CELL27            0            0            0            0            0            0            0            0            0            0        2.202        0.298            0            0        1.099            0            0            0            0            0            0            0            0            0            0            0      4133.58       83.046 
      CELL28            0            0            0            0            0            0            0            0            0            0       36.995        4.997            0            0       18.968            0            0            0            0            0            0            0            0            0            0            0     5525.013      138.404 
      CELL29            0            0            0            0            0            0            0            0            0            0            0        0.651            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4554.847        76.27 
      CELL30            0            0            0            0            0            0            0            0            0            0        48.65        6.607            0            0       22.273            0            0            0            0            0            0            0            0            0            0            0     4646.352       919.48 
      CELL31            0            0            0            0            0            0            0            0            0            0       12.942         1.76            0            0        5.942            0            0            0            0            0            0            0            0            0            0            0     5031.317      345.155 
      CELL32            0            0            0            0            0            0            0            0            0            0        7.624        1.037            0            0         3.49            0            0            0            0            0            0            0            0            0            0            0     3411.733      260.293 
      CELL33            0            0            0            0            0            0            0            0            0            0       80.919       11.007            0            0       37.006            0            0            0            0            0            0            0            0            0            0            0     4892.626     1150.093 
      CELL34            0            0            0            0            0            0            0            0            0            0       76.268       10.364            0            0       34.866            0            0            0            0            0            0            0            0            0            0            0     4881.742      363.189 
      CELL35            0            0            0            0            0            0            0            0            0            0       65.476        8.904            0            0       29.928            0            0            0            0            0            0            0            0            0            0            0     5472.889      817.383 
      CELL36            0            0            0            0            0            0            0            0            0            0       94.331       12.809            0            0       43.108            0            0            0            0            0            0            0            0            0            0            0     5636.449      790.573 
      CELL37            0            0            0            0            0            0            0            0            0            0       17.027        2.306            0            0        7.922            0            0            0            0            0            0            0            0            0            0            0     3464.691      115.165 
      CELL38            0            0            0            0            0            0            0            0            0            0            0        5.448            0            0            0            0            0            0            0            0            0            0            0            0            0            0      969.873       66.643 
      CELL39            0            0            0            0            0            0            0            0            0            0       53.723        7.257            0            0       27.051            0            0            0            0            0            0            0            0            0            0            0     4151.718       39.775 
      CELL40            0            0            0            0            0            0            0            0            0            0        3.343        0.451            0            0        1.697            0            0            0            0            0            0            0            0            0            0            0     5493.253      104.579 
      CELL41            0            0            0            0            0            0            0            0            0            0       12.227        1.652            0            0        6.451            0            0            0            0            0            0            0            0            0            0            0       5389.8       71.137 
      CELL42            0            0            0            0            0            0            0            0            0            0            0        0.118            0            0            0            0            0            0            0            0            0            0            0            0            0            0      393.688            0 
      CELL43            0            0            0            0            0            0            0            0            0            0      100.212       13.581            0            0       45.884            0            0            0            0            0            0            0            0            0            0            0     1049.391       175.36 
      CELL44            0            0            0            0            0            0            0            0            0            0       88.432       11.998            0            0       40.478            0            0            0            0            0            0            0            0            0            0            0     5282.314     1165.131 
      CELL45            0            0            0            0            0            0            0            0            0            0       89.557       12.154            0            0       40.983            0            0            0            0            0            0            0            0            0            0            0     5434.047     1246.144 
      CELL46            0            0            0            0            0            0            0            0            0            0        13.32        1.808            0            0         6.11            0            0            0            0            0            0            0            0            0            0            0     3770.579      261.276 
      CELL47            0            0            0            0            0            0            0            0            0            0       91.204       12.384            0            0       41.723            0            0            0            0            0            0            0            0            0            0            0     4962.536       247.71 
      CELL48            0            0            0            0            0            0            0            0            0            0       99.105       13.466            0            0       45.306            0            0            0            0            0            0            0            0            0            0            0     4663.255      323.347 
      CELL49            0            0            0            0            0            0            0            0            0            0       63.787        8.662            0            0       29.153            0            0            0            0            0            0            0            0            0            0            0     4849.383      135.108 
      CELL50            0            0            0            0            0            0            0            0            0            0      101.424       13.761            0            0       46.341            0            0            0            0            0            0            0            0            0            0            0     5586.065     1497.656 
      CELL51            0            0            0            0            0            0            0            0            0            0       81.403       11.026            0            0       37.833            0            0            0            0            0            0            0            0            0            0            0     5174.439     1349.929 
      CELL52            0            0            0            0            0            0            0            0            0            0            0        8.241            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4779.835       589.96 
      CELL53            0            0            0            0            0            0            0            0            0            0       58.449        7.893            0            0       29.712            0            0            0            0            0            0            0            0            0            0            0     3867.238      102.869 
      CELL54            0            0            0            0            0            0            0            0            0            0        2.253        0.304            0            0        1.165            0            0            0            0            0            0            0            0            0            0            0     5375.051       69.162 
      CELL55            0            0            0            0            0            0            0            0            0            0       39.184        5.287            0            0       20.456            0            0            0            0            0            0            0            0            0            0            0     5621.707      247.194 
      CELL56            0            0            0            0            0            0            0            0            0            0        3.229        0.435            0            0        1.759            0            0            0            0            0            0            0            0            0            0            0     2223.266        0.145 
      CELL57            0            0            0            0            0            0            0            0            0            0       48.854        6.617            0            0        22.37            0            0            0            0            0            0            0            0            0            0            0      258.627       70.377 
      CELL58            0            0            0            0            0            0            0            0            0            0       58.378        7.919            0            0       26.723            0            0            0            0            0            0            0            0            0            0            0     4467.848      531.426 
      CELL59            0            0            0            0            0            0            0            0            0            0            0        1.016            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5527.728      408.097 
      CELL60            0            0            0            0            0            0            0            0            0            0            0        7.045            0            0            0            0            0            0            0            0            0            0            0            0            0            0      4774.09      443.651 
      CELL61            0            0            0            0            0            0            0            0            0            0       79.409       10.776            0            0       36.347            0            0            0            0            0            0            0            0            0            0            0     4569.171      281.931 
      CELL62            0            0            0            0            0            0            0            0            0            0        31.57        4.284            0            0       14.434            0            0            0            0            0            0            0            0            0            0            0     4327.029      331.273 
      CELL63            0            0            0            0            0            0            0            0            0            0       106.51       14.447            0            0       48.665            0            0            0            0            0            0            0            0            0            0            0     4736.651     1265.864 
      CELL64            0            0            0            0            0            0            0            0            0            0        81.62       11.061            0            0       37.282            0            0            0            0            0            0            0            0            0            0            0     5399.428     1488.733 
      CELL65            0            0            0            0            0            0            0            0            0            0       88.804        12.03            0            0       41.255            0            0            0            0            0            0            0            0            0            0            0     5567.907     1472.146 
      CELL66            0            0            0            0            0            0            0            0            0            0       80.932       10.941            0            0       39.272            0            0            0            0            0            0            0            0            0            0            0     5468.346      988.317 
      CELL67            0            0            0            0            0            0            0            0            0            0            0        9.936            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4605.378       69.102 
      CELL68            0            0            0            0            0            0            0            0            0            0       55.679        7.515            0            0       28.818            0            0            0            0            0            0            0            0            0            0            0     5045.555       33.074 
      CELL69            0            0            0            0            0            0            0            0            0            0       44.745        6.031            0            0       23.128            0            0            0            0            0            0            0            0            0            0            0     5373.543      632.362 
      CELL70            0            0            0            0            0            0            0            0            0            0       31.271         4.21            0            0       16.329            0            0            0            0            0            0            0            0            0            0            0      4541.66       28.234 
      CELL71            0            0            0            0            0            0            0            0            0            0         7.95        1.076            0            0        3.642            0            0            0            0            0            0            0            0            0            0            0       51.557       14.881 
      CELL72            0            0            0            0            0            0            0            0            0            0       68.577        9.302            0            0       31.403            0            0            0            0            0            0            0            0            0            0            0     3258.247      784.008 
      CELL73            0            0            0            0            0            0            0            0            0            0       52.979        7.187            0            0       24.251            0            0            0            0            0            0            0            0            0            0            0     5303.647      966.392 
      CELL74            0            0            0            0            0            0            0            0            0            0            0        2.508            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4902.828      454.046 
      CELL75            0            0            0            0            0            0            0            0            0            0       75.929       10.292            0            0       34.746            0            0            0            0            0            0            0            0            0            0            0     4850.139       91.276 
      CELL76            0            0            0            0            0            0            0            0            0            0        78.46       10.632            0            0       35.873            0            0            0            0            0            0            0            0            0            0            0      4218.64      307.922 
      CELL77            0            0            0            0            0            0            0            0            0            0      103.298       13.996            0            0       47.205            0            0            0            0            0            0            0            0            0            0            0     4570.866      533.837 
      CELL78            0            0            0            0            0            0            0            0            0            0       75.117       10.176            0            0       34.316            0            0            0            0            0            0            0            0            0            0            0     5196.869     1328.839 
      CELL79            0            0            0            0            0            0            0            0            0            0       80.258       10.864            0            0       37.588            0            0            0            0            0            0            0            0            0            0            0     5439.392     2062.846 
      CELL80            0            0            0            0            0            0            0            0            0            0       80.016       10.815            0            0        38.81            0            0            0            0            0            0            0            0            0            0            0     5104.571     1218.699 
      CELL81            0            0            0            0            0            0            0            0            0            0            0        0.412            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1237.97            0 
      CELL82            0            0            0            0            0            0            0            0            0            0        2.921        0.393            0            0        1.563            0            0            0            0            0            0            0            0            0            0            0     1865.162       11.711 
      CELL83            0            0            0            0            0            0            0            0            0            0       62.945        8.472            0            0       32.845            0            0            0            0            0            0            0            0            0            0            0     5016.251      158.254 
      CELL84            0            0            0            0            0            0            0            0            0            0       14.498        1.949            0            0        7.563            0            0            0            0            0            0            0            0            0            0            0      4936.69        63.74 
      CELL85            0            0            0            0            0            0            0            0            0            0        8.483         1.14            0            0        4.566            0            0            0            0            0            0            0            0            0            0            0      198.133         1.55 
      CELL86            0            0            0            0            0            0            0            0            0            0            0        6.012            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1165.15      259.938 
      CELL87            0            0            0            0            0            0            0            0            0            0            0         6.54            0            0            0            0            0            0            0            0            0            0            0            0            0            0       2879.5      587.106 
      CELL88            0            0            0            0            0            0            0            0            0            0       19.999        2.709            0            0        9.162            0            0            0            0            0            0            0            0            0            0            0     4355.107     1083.995 
      CELL89            0            0            0            0            0            0            0            0            0            0        40.28        5.457            0            0       18.432            0            0            0            0            0            0            0            0            0            0            0     4544.678      911.427 
      CELL90            0            0            0            0            0            0            0            0            0            0       40.261        5.455            0            0       18.419            0            0            0            0            0            0            0            0            0            0            0     4616.682      242.031 
      CELL91            0            0            0            0            0            0            0            0            0            0        8.029        1.087            0            0        3.674            0            0            0            0            0            0            0            0            0            0            0      4996.42      190.838 
      CELL92            0            0            0            0            0            0            0            0            0            0       30.201        4.087            0            0       13.808            0            0            0            0            0            0            0            0            0            0            0     4224.853      281.123 
      CELL93            0            0            0            0            0            0            0            0            0            0       36.367        4.919            0            0       16.624            0            0            0            0            0            0            0            0            0            0            0     5256.663      368.761 
      CELL94            0            0            0            0            0            0            0            0            0            0       26.235         3.55            0            0       11.988            0            0            0            0            0            0            0            0            0            0            0     5403.066      891.835 
      CELL95            0            0            0            0            0            0            0            0            0            0       93.853       12.691            0            0       44.725            0            0            0            0            0            0            0            0            0            0            0     5325.018     1344.207 
      CELL96            0            0            0            0            0            0            0            0            0            0            0       13.243            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5164.279     1304.879 
      CELL97            0            0            0            0            0            0            0            0            0            0            0        7.952            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1177.925      360.893 
      CELL98            0            0            0            0            0            0            0            0            0            0            0        0.819            0            0            0            0            0            0            0            0            0            0            0            0            0            0      467.604            0 
      CELL99            0            0            0            0            0            0            0            0            0            0       69.653        9.363            0            0       36.329            0            0            0            0            0            0            0            0            0            0            0     4966.737      341.392 
     CELL100            0            0            0            0            0            0            0            0            0            0       12.689        1.703            0            0          6.7            0            0            0            0            0            0            0            0            0            0            0     3976.958       48.393 
     CELL101            0            0            0            0            0            0            0            0            0            0        19.24        2.581            0            0       10.334            0            0            0            0            0            0            0            0            0            0            0     2469.084       59.818 
     CELL102            0            0            0            0            0            0            0            0            0            0        7.116        0.953            0            0        3.826            0            0            0            0            0            0            0            0            0            0            0      143.084       14.736 
     CELL103            0            0            0            0            0            0            0            0            0            0       24.188        3.276            0            0       11.095            0            0            0            0            0            0            0            0            0            0            0       58.561       11.829 
     CELL104            0            0            0            0            0            0            0            0            0            0            0        1.305            0            0            0            0            0            0            0            0            0            0            0            0            0            0      3436.96      500.499 
     CELL105            0            0            0            0            0            0            0            0            0            0            0        4.791            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5320.817      580.401 
     CELL106            0            0            0            0            0            0            0            0            0            0       44.892        6.075            0            0       20.564            0            0            0            0            0            0            0            0            0            0            0     4279.396      584.013 
     CELL107            0            0            0            0            0            0            0            0            0            0       18.133        2.453            0            0        8.298            0            0            0            0            0            0            0            0            0            0            0     5015.393      529.067 
     CELL108            0            0            0            0            0            0            0            0            0            0        5.785        0.782            0            0        2.646            0            0            0            0            0            0            0            0            0            0            0     5382.373      403.279 
     CELL109            0            0            0            0            0            0            0            0            0            0       53.674        7.251            0            0       24.539            0            0            0            0            0            0            0            0            0            0            0     5097.291      688.442 
     CELL110            0            0            0            0            0            0            0            0            0            0       12.012        1.622            0            0        5.493            0            0            0            0            0            0            0            0            0            0            0     4922.027      411.975 
     CELL111            0            0            0            0            0            0            0            0            0            0       71.582        9.665            0            0       33.269            0            0            0            0            0            0            0            0            0            0            0     5037.626      560.818 
     CELL112            0            0            0            0            0            0            0            0            0            0       95.994       12.962            0            0       46.164            0            0            0            0            0            0            0            0            0            0            0     5453.154     1354.053 
     CELL113            0            0            0            0            0            0            0            0            0            0            0       13.481            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4777.793     1182.023 
     CELL114            0            0            0            0            0            0            0            0            0            0            0       12.673            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4387.135      416.871 
     CELL115            0            0            0            0            0            0            0            0            0            0            0       11.328            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2503.995      649.292 
     CELL116            0            0            0            0            0            0            0            0            0            0        60.47        8.122            0            0       31.536            0            0            0            0            0            0            0            0            0            0            0     3701.753      251.651 
     CELL117            0            0            0            0            0            0            0            0            0            0       39.159        5.253            0            0       20.833            0            0            0            0            0            0            0            0            0            0            0     2480.532       83.457 
     CELL118            0            0            0            0            0            0            0            0            0            0            0        2.585            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1867.505            0 
     CELL119            0            0            0            0            0            0            0            0            0            0            0        2.983            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1465.84        26.72 
     CELL120            0            0            0            0            0            0            0            0            0            0            0        1.164            0            0            0            0            0            0            0            0            0            0            0            0            0            0       2424.1      273.952 
     CELL121            0            0            0            0            0            0            0            0            0            0            0        5.077            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4649.093      564.167 
     CELL122            0            0            0            0            0            0            0            0            0            0       60.615        8.178            0            0        27.76            0            0            0            0            0            0            0            0            0            0            0     4515.333      800.084 
     CELL123            0            0            0            0            0            0            0            0            0            0       64.594        8.715            0            0       29.558            0            0            0            0            0            0            0            0            0            0            0     5123.453      653.469 
     CELL124            0            0            0            0            0            0            0            0            0            0       77.177       10.404            0            0       35.308            0            0            0            0            0            0            0            0            0            0            0     4686.541     1164.479 
     CELL125            0            0            0            0            0            0            0            0            0            0            0        3.946            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4772.464     1039.301 
     CELL126            0            0            0            0            0            0            0            0            0            0            0        1.273            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3445.771        87.08 
     CELL127            0            0            0            0            0            0            0            0            0            0            0        1.117            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4658.818       180.61 
     CELL128            0            0            0            0            0            0            0            0            0            0            0       12.234            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5109.803      895.103 
     CELL129            0            0            0            0            0            0            0            0            0            0            0        1.736            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2583.901       26.379 
     CELL130            0            0            0            0            0            0            0            0            0            0            0        4.479            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3706.587      296.403 
     CELL131            0            0            0            0            0            0            0            0            0            0       79.934       10.719            0            0       42.122            0            0            0            0            0            0            0            0            0            0            0      4823.06      191.648 
     CELL132            0            0            0            0            0            0            0            0            0            0            0        3.717            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3909.994            0 
     CELL133            0            0            0            0            0            0            0            0            0            0       30.115        4.033            0            0       16.015            0            0            0            0            0            0            0            0            0            0            0     3021.249        78.65 
     CELL134            0            0            0            0            0            0            0            0            0            0        4.379        0.585            0            0        2.382            0            0            0            0            0            0            0            0            0            0            0      3233.92       44.154 
     CELL135            0            0            0            0            0            0            0            0            0            0            0        0.494            0            0            0            0            0            0            0            0            0            0            0            0            0            0      355.879        7.289 
     CELL136            0            0            0            0            0            0            0            0            0            0            0       13.582            0            0            0            0            0            0            0            0            0            0            0            0            0            0      568.191       49.134 
     CELL137            0            0            0            0            0            0            0            0            0            0            0        2.651            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2484.188      561.645 
     CELL138            0            0            0            0            0            0            0            0            0            0            0        0.854            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3308.454      461.504 
     CELL139            0            0            0            0            0            0            0            0            0            0       24.923        3.353            0            0       11.513            0            0            0            0            0            0            0            0            0            0            0     4794.455     1140.803 
     CELL140            0            0            0            0            0            0            0            0            0            0       17.675        2.375            0            0          8.7            0            0            0            0            0            0            0            0            0            0            0     1910.357      309.183 
     CELL141            0            0            0            0            0            0            0            0            0            0            0        1.118            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1113.417       27.037 
     CELL142            0            0            0            0            0            0            0            0            0            0            0        3.787            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3022.649      133.824 
     CELL143            0            0            0            0            0            0            0            0            0            0            0        5.389            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2055.226      205.169 
     CELL144            0            0            0            0            0            0            0            0            0            0            0        0.496            0            0            0            0            0            0            0            0            0            0            0            0            0            0      289.514       11.728 
     CELL145            0            0            0            0            0            0            0            0            0            0            0         0.66            0            0            0            0            0            0            0            0            0            0            0            0            0            0      790.305            0 
     CELL146            0            0            0            0            0            0            0            0            0            0       17.208        2.303            0            0        9.165            0            0            0            0            0            0            0            0            0            0            0     3957.244       53.993 
     CELL147            0            0            0            0            0            0            0            0            0            0        56.98         7.62            0            0       30.631            0            0            0            0            0            0            0            0            0            0            0     3625.301      396.371 
     CELL148            0            0            0            0            0            0            0            0            0            0       38.763        5.182            0            0       20.615            0            0            0            0            0            0            0            0            0            0            0     4168.515      984.238 
     CELL149            0            0            0            0            0            0            0            0            0            0       28.852        3.849            0            0       15.495            0            0            0            0            0            0            0            0            0            0            0     4087.163     1112.248 
     CELL150            0            0            0            0            0            0            0            0            0            0            0        0.692            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1163.59       49.023 
     CELL151            0            0            0            0            0            0            0            0            0            0            0        0.676            0            0            0            0            0            0            0            0            0            0            0            0            0            0       559.24       48.271 
     CELL152            0            0            0            0            0            0            0            0            0            0       14.666        1.969            0            0        6.953            0            0            0            0            0            0            0            0            0            0            0     5439.703      735.969 
     CELL153            0            0            0            0            0            0            0            0            0            0        66.07        8.865            0            0       32.461            0            0            0            0            0            0            0            0            0            0            0     5255.581      420.673 
     CELL154            0            0            0            0            0            0            0            0            0            0            0       11.036            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5426.929      479.429 
     CELL155            0            0            0            0            0            0            0            0            0            0       64.132        8.592            0            0         32.7            0            0            0            0            0            0            0            0            0            0            0     5782.143      833.554 
     CELL156            0            0            0            0            0            0            0            0            0            0       41.082        5.501            0            0       21.735            0            0            0            0            0            0            0            0            0            0            0     2783.139      449.905 
     CELL157            0            0            0            0            0            0            0            0            0            0            0        1.285            0            0            0            0            0            0            0            0            0            0            0            0            0            0      518.199      103.178 
     CELL158            0            0            0            0            0            0            0            0            0            0            0          0.6            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2240.021      241.789 
     CELL159            0            0            0            0            0            0            0            0            0            0       20.395        2.724            0            0       10.971            0            0            0            0            0            0            0            0            0            0            0      3559.99      121.319 
     CELL160            0            0            0            0            0            0            0            0            0            0        54.05        7.222            0            0       29.046            0            0            0            0            0            0            0            0            0            0            0     5087.164      715.084 
     CELL161            0            0            0            0            0            0            0            0            0            0        29.87        3.982            0            0       16.211            0            0            0            0            0            0            0            0            0            0            0       4558.2      967.841 
     CELL162            0            0            0            0            0            0            0            0            0            0       47.984        6.395            0            0       26.024            0            0            0            0            0            0            0            0            0            0            0     4511.667         2097 
     CELL163            0            0            0            0            0            0            0            0            0            0            0        3.186            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2004.604      595.002 
     CELL164            0            0            0            0            0            0            0            0            0            0            0         5.78            0            0            0            0            0            0            0            0            0            0            0            0            0            0        9.968        0.099 
     CELL165            0            0            0            0            0            0            0            0            0            0        14.15        1.895            0            0        7.024            0            0            0            0            0            0            0            0            0            0            0     3747.639      328.599 
     CELL166            0            0            0            0            0            0            0            0            0            0       40.771        5.459            0            0       20.806            0            0            0            0            0            0            0            0            0            0            0     5391.352        70.42 
     CELL167            0            0            0            0            0            0            0            0            0            0       32.755        4.384            0            0       16.888            0            0            0            0            0            0            0            0            0            0            0     5857.323      110.242 
     CELL168            0            0            0            0            0            0            0            0            0            0       75.988       10.168            0            0       39.485            0            0            0            0            0            0            0            0            0            0            0     6035.574      373.767 
     CELL169            0            0            0            0            0            0            0            0            0            0       67.286        8.993            0            0        35.59            0            0            0            0            0            0            0            0            0            0            0     5531.284      562.687 
     CELL170            0            0            0            0            0            0            0            0            0            0            0         6.06            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4767.803      427.427 
     CELL171            0            0            0            0            0            0            0            0            0            0            0         9.77            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1734.289       23.473 
     CELL172            0            0            0            0            0            0            0            0            0            0            0        8.867            0            0            0            0            0            0            0            0            0            0            0            0            0            0      3704.36       23.473 
     CELL173            0            0            0            0            0            0            0            0            0            0       45.892        6.117            0            0        24.92            0            0            0            0            0            0            0            0            0            0            0     4988.258      356.094 
     CELL174            0            0            0            0            0            0            0            0            0            0       58.438        7.784            0            0       31.719            0            0            0            0            0            0            0            0            0            0            0     5035.968     1759.766 
     CELL175            0            0            0            0            0            0            0            0            0            0       22.837         3.04            0            0       12.659            0            0            0            0            0            0            0            0            0            0            0     2569.166      673.745 
     CELL176            0            0            0            0            0            0            0            0            0            0            0        6.443            0            0            0            0            0            0            0            0            0            0            0            0            0            0      3898.72     1497.927 
     CELL177            0            0            0            0            0            0            0            0            0            0            0        2.707            0            0            0            0            0            0            0            0            0            0            0            0            0            0      250.209        1.878 
     CELL178            0            0            0            0            0            0            0            0            0            0            0       11.012            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3645.334      171.095 
     CELL179            0            0            0            0            0            0            0            0            0            0       71.159         9.51            0            0       36.695            0            0            0            0            0            0            0            0            0            0            0     5833.641       88.057 
     CELL180            0            0            0            0            0            0            0            0            0            0       62.548        8.353            0            0       32.904            0            0            0            0            0            0            0            0            0            0            0     5891.151       95.184 
     CELL181            0            0            0            0            0            0            0            0            0            0       92.767       12.393            0            0        48.69            0            0            0            0            0            0            0            0            0            0            0     6119.771      393.071 
     CELL182            0            0            0            0            0            0            0            0            0            0       84.211       11.242            0            0       45.016            0            0            0            0            0            0            0            0            0            0            0     5528.602      321.639 
     CELL183            0            0            0            0            0            0            0            0            0            0            0        8.972            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5613.029       68.961 
     CELL184            0            0            0            0            0            0            0            0            0            0       11.702        1.558            0            0        6.515            0            0            0            0            0            0            0            0            0            0            0     3412.163       41.093 
     CELL185            0            0            0            0            0            0            0            0            0            0            0        2.525            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1752.66       23.482 
     CELL186            0            0            0            0            0            0            0            0            0            0            0         7.07            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2897.239       46.964 
     CELL187            0            0            0            0            0            0            0            0            0            0            0        4.618            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4879.148      753.314 
     CELL188            0            0            0            0            0            0            0            0            0            0            0        8.383            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5223.308      1167.26 
     CELL189            0            0            0            0            0            0            0            0            0            0            0        8.229            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3020.034     1368.103 
     CELL190            0            0            0            0            0            0            0            0            0            0            0        1.608            0            0            0            0            0            0            0            0            0            0            0            0            0            0      253.347            0 
     CELL191            0            0            0            0            0            0            0            0            0            0            0        8.539            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1760.381       54.353 
     CELL192            0            0            0            0            0            0            0            0            0            0            0        9.909            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1979.611      123.949 
     CELL193            0            0            0            0            0            0            0            0            0            0            0        3.828            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5706.011      540.429 
     CELL194            0            0            0            0            0            0            0            0            0            0            0        9.959            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5667.213      317.725 
     CELL195            0            0            0            0            0            0            0            0            0            0            0        8.277            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5950.652       55.131 
     CELL196            0            0            0            0            0            0            0            0            0            0            0        4.243            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5792.379      128.404 
     CELL197            0            0            0            0            0            0            0            0            0            0       67.415        8.967            0            0       36.704            0            0            0            0            0            0            0            0            0            0            0      5616.29       692.79 
     CELL198            0            0            0            0            0            0            0            0            0            0       14.256         1.89            0            0        8.209            0            0            0            0            0            0            0            0            0            0            0     2372.609      375.105 
     CELL199            0            0            0            0            0            0            0            0            0            0            0        1.404            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1847.86            0 
     CELL200            0            0            0            0            0            0            0            0            0            0            0        3.806            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3136.797        6.679 
     CELL201            0            0            0            0            0            0            0            0            0            0            0        7.342            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5286.971     1230.775 
     CELL202            0            0            0            0            0            0            0            0            0            0            0         7.16            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4388.961     2504.291 
     CELL203            0            0            0            0            0            0            0            0            0            0            0        2.432            0            0            0            0            0            0            0            0            0            0            0            0            0            0      160.573       33.572 
     CELL204            0            0            0            0            0            0            0            0            0            0            0       10.892            0            0            0            0            0            0            0            0            0            0            0            0            0            0        59.28        7.392 
     CELL205            0            0            0            0            0            0            0            0            0            0            0        8.645            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1888.014       74.909 
     CELL206            0            0            0            0            0            0            0            0            0            0            0         4.45            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3744.137      108.287 
     CELL207            0            0            0            0            0            0            0            0            0            0       61.472         8.17            0            0       33.921            0            0            0            0            0            0            0            0            0            0            0     3952.221         8.04 
     CELL208            0            0            0            0            0            0            0            0            0            0       15.794        2.099            0            0        8.794            0            0            0            0            0            0            0            0            0            0            0     2251.362      104.653 
     CELL209            0            0            0            0            0            0            0            0            0            0         37.4        4.963            0            0       21.032            0            0            0            0            0            0            0            0            0            0            0      2085.85      166.282 
     CELL210            0            0            0            0            0            0            0            0            0            0       40.035        5.316            0            0       22.987            0            0            0            0            0            0            0            0            0            0            0     1692.794      224.019 
     CELL211            0            0            0            0            0            0            0            0            0            0            0        4.072            0            0            0            0            0            0            0            0            0            0            0            0            0            0      468.977      387.574 
     CELL212            0            0            0            0            0            0            0            0            0            0            0        8.135            0            0            0            0            0            0            0            0            0            0            0            0            0            0      333.363        5.875 
     CELL213            0            0            0            0            0            0            0            0            0            0            0        5.215            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2365.391      293.158 
     CELL214            0            0            0            0            0            0            0            0            0            0            0       10.708            0            0            0            0            0            0            0            0            0            0            0            0            0            0     5001.012     1884.799 
     CELL215            0            0            0            0            0            0            0            0            0            0            0        7.951            0            0            0            0            0            0            0            0            0            0            0            0            0            0      130.139        7.918 
     CELL216            0            0            0            0            0            0            0            0            0            0        79.32       10.527            0            0       44.689            0            0            0            0            0            0            0            0            0            0            0      298.777       13.842 
     CELL217            0            0            0            0            0            0            0            0            0            0            0        7.374            0            0            0            0            0            0            0            0            0            0            0            0            0            0      416.344       51.106 
     CELL218            0            0            0            0            0            0            0            0            0            0            0        6.696            0            0            0            0            0            0            0            0            0            0            0            0            0            0      304.391        17.63 
     CELL219            0            0            0            0            0            0            0            0            0            0       64.871        8.544            0            0       41.169            0            0            0            0            0            0            0            0            0            0            0     1512.421      243.858 
     CELL220            0            0            0            0            0            0            0            0            0            0       71.047        9.432            0            0       43.732            0            0            0            0            0            0            0            0            0            0            0      290.148       28.798 
     CELL221            0            0            0            0            0            0            0            0            0            0            0        6.515            0            0            0            0            0            0            0            0            0            0            0            0            0            0       54.377       23.979 
     CELL222            0            0            0            0            0            0            0            0            0            0            0        8.675            0            0            0            0            0            0            0            0            0            0            0            0            0            0        70.33            0 
     CELL223            0            0            0            0            0            0            0            0            0            0         52.1        6.852            0            0       33.829            0            0            0            0            0            0            0            0            0            0            0       38.732        2.645 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0         6049         1280            0            0     2973.117            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
