<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0            0        0.002            0            0        3.601            0            0            0            0            0            0            0            0            0            0            0       73.943       47.224 
       CELL2            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       12.201            0            0            0            0            0            0            0            0            0            0            0     2434.568      867.675 
       CELL3            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       16.424            0            0            0            0            0            0            0            0            0            0            0     1277.459      621.711 
       CELL4            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        5.486            0            0            0            0            0            0            0            0            0            0            0      199.408       70.416 
       CELL5            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       14.777            0            0            0            0            0            0            0            0            0            0            0     1346.684      762.853 
       CELL6            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       16.448            0            0            0            0            0            0            0            0            0            0            0        99.45        87.36 
       CELL7            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       16.763            0            0            0            0            0            0            0            0            0            0            0     1825.791     1316.703 
       CELL8            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0        14.05            0            0            0            0            0            0            0            0            0            0            0     2378.146     1761.808 
       CELL9            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0        17.59            0            0            0            0            0            0            0            0            0            0            0     5447.548     4074.084 
      CELL10            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       16.561            0            0            0            0            0            0            0            0            0            0            0     4785.914     4400.235 
      CELL11            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       12.739            0            0            0            0            0            0            0            0            0            0            0     3549.667      2639.08 
      CELL12            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       16.417            0            0            0            0            0            0            0            0            0            0            0      2590.34     1470.544 
      CELL13            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0       11.045            0            0            0            0            0            0            0            0            0            0            0     3271.654     2075.674 
      CELL14            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       13.559            0            0            0            0            0            0            0            0            0            0            0     1287.084      912.537 
      CELL15            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       16.523            0            0            0            0            0            0            0            0            0            0            0     2086.357      963.855 
      CELL16            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0        9.848            0            0            0            0            0            0            0            0            0            0            0     5420.905     2802.867 
      CELL17            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       15.618            0            0            0            0            0            0            0            0            0            0            0     6242.264     4186.473 
      CELL18            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       17.411            0            0            0            0            0            0            0            0            0            0            0     3326.782     2394.666 
      CELL19            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       15.336            0            0            0            0            0            0            0            0            0            0            0     1533.788      914.866 
      CELL20            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       15.316            0            0            0            0            0            0            0            0            0            0            0     3707.971     2280.068 
      CELL21            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       15.497            0            0            0            0            0            0            0            0            0            0            0     3824.113     2653.856 
      CELL22            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       16.767            0            0            0            0            0            0            0            0            0            0            0     4345.628     2872.092 
      CELL23            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       14.923            0            0            0            0            0            0            0            0            0            0            0     5120.418     3076.397 
      CELL24            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0        19.47            0            0            0            0            0            0            0            0            0            0            0     5822.191     3779.172 
      CELL25            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       19.298            0            0            0            0            0            0            0            0            0            0            0     5946.881     4422.366 
      CELL26            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       17.701            0            0            0            0            0            0            0            0            0            0            0     1053.858       764.42 
      CELL27            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        6.427            0            0            0            0            0            0            0            0            0            0            0      117.327       60.476 
      CELL28            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0        9.487            0            0            0            0            0            0            0            0            0            0            0      5576.36     1448.707 
      CELL29            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       15.686            0            0            0            0            0            0            0            0            0            0            0     6231.313     2487.233 
      CELL30            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       17.993            0            0            0            0            0            0            0            0            0            0            0     6073.176     3549.133 
      CELL31            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       19.208            0            0            0            0            0            0            0            0            0            0            0     5388.857     2331.338 
      CELL32            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       20.673            0            0            0            0            0            0            0            0            0            0            0      538.556      282.737 
      CELL33            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       21.534            0            0            0            0            0            0            0            0            0            0            0       49.853       39.689 
      CELL34            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       21.376            0            0            0            0            0            0            0            0            0            0            0       368.45      207.658 
      CELL35            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       19.789            0            0            0            0            0            0            0            0            0            0            0     4517.056     3736.743 
      CELL36            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       14.122            0            0            0            0            0            0            0            0            0            0            0     5476.534     4145.837 
      CELL37            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       16.945            0            0            0            0            0            0            0            0            0            0            0     5225.283      2306.02 
      CELL38            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       17.263            0            0            0            0            0            0            0            0            0            0            0     6041.798     3335.474 
      CELL39            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0        15.35            0            0            0            0            0            0            0            0            0            0            0     3851.117     3179.002 
      CELL40            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0        14.31            0            0            0            0            0            0            0            0            0            0            0      464.353       84.958 
      CELL41            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       14.437            0            0            0            0            0            0            0            0            0            0            0     3102.553      497.522 
      CELL42            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       16.024            0            0            0            0            0            0            0            0            0            0            0     5488.471     2227.864 
      CELL43            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       20.803            0            0            0            0            0            0            0            0            0            0            0     5806.584     1861.249 
      CELL44            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       14.828            0            0            0            0            0            0            0            0            0            0            0     5507.868     1992.065 
      CELL45            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       23.142            0            0            0            0            0            0            0            0            0            0            0     3217.525     2173.916 
      CELL46            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       19.152            0            0            0            0            0            0            0            0            0            0            0     1068.427      571.221 
      CELL47            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       23.423            0            0            0            0            0            0            0            0            0            0            0     5476.748     2417.817 
      CELL48            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       13.498            0            0            0            0            0            0            0            0            0            0            0     5702.077     3703.103 
      CELL49            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       14.103            0            0            0            0            0            0            0            0            0            0            0     4895.309     2751.896 
      CELL50            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       21.359            0            0            0            0            0            0            0            0            0            0            0     6231.544     5230.983 
      CELL51            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0        12.33            0            0            0            0            0            0            0            0            0            0            0     6311.792     5727.302 
      CELL52            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       22.169            0            0            0            0            0            0            0            0            0            0            0       985.26      915.986 
      CELL53            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       15.165            0            0            0            0            0            0            0            0            0            0            0     1540.749      284.655 
      CELL54            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        7.476            0            0            0            0            0            0            0            0            0            0            0     5684.308     3048.972 
      CELL55            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       20.056            0            0            0            0            0            0            0            0            0            0            0     6178.441      3297.92 
      CELL56            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       21.876            0            0            0            0            0            0            0            0            0            0            0     5349.559     2559.243 
      CELL57            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       15.517            0            0            0            0            0            0            0            0            0            0            0     3820.104     2282.144 
      CELL58            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       24.514            0            0            0            0            0            0            0            0            0            0            0      2435.29     1775.555 
      CELL59            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       24.868            0            0            0            0            0            0            0            0            0            0            0      5475.07     2792.987 
      CELL60            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0        24.68            0            0            0            0            0            0            0            0            0            0            0     5387.669     1575.076 
      CELL61            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0        21.23            0            0            0            0            0            0            0            0            0            0            0     4491.839     1845.051 
      CELL62            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       24.943            0            0            0            0            0            0            0            0            0            0            0     6220.255     4617.422 
      CELL63            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       22.122            0            0            0            0            0            0            0            0            0            0            0     4808.736      4710.78 
      CELL64            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       18.966            0            0            0            0            0            0            0            0            0            0            0      104.778       47.889 
      CELL65            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       16.013            0            0            0            0            0            0            0            0            0            0            0      348.571      167.515 
      CELL66            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        7.088            0            0            0            0            0            0            0            0            0            0            0       2716.2     1157.195 
      CELL67            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       12.804            0            0            0            0            0            0            0            0            0            0            0     3584.811     1254.446 
      CELL68            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       21.449            0            0            0            0            0            0            0            0            0            0            0     4161.673      1248.43 
      CELL69            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       25.496            0            0            0            0            0            0            0            0            0            0            0     3219.019      2040.89 
      CELL70            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       26.325            0            0            0            0            0            0            0            0            0            0            0     3112.295     1836.976 
      CELL71            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       21.066            0            0            0            0            0            0            0            0            0            0            0     4186.013     1472.151 
      CELL72            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0        22.61            0            0            0            0            0            0            0            0            0            0            0     3790.475      934.015 
      CELL73            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       20.728            0            0            0            0            0            0            0            0            0            0            0     5660.073      1675.17 
      CELL74            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       23.497            0            0            0            0            0            0            0            0            0            0            0     5656.596     3797.181 
      CELL75            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       24.988            0            0            0            0            0            0            0            0            0            0            0     4445.757     3753.886 
      CELL76            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0         18.8            0            0            0            0            0            0            0            0            0            0            0      218.029      106.416 
      CELL77            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       19.052            0            0            0            0            0            0            0            0            0            0            0      422.747       78.794 
      CELL78            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      140.677      140.677 
      CELL79            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1380.296       995.36 
      CELL80            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0       13.313            0            0            0            0            0            0            0            0            0            0            0         87.1       47.417 
      CELL81            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       21.592            0            0            0            0            0            0            0            0            0            0            0       52.636       19.892 
      CELL82            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       24.927            0            0            0            0            0            0            0            0            0            0            0     1824.301     1026.733 
      CELL83            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       27.036            0            0            0            0            0            0            0            0            0            0            0     3520.873      1666.41 
      CELL84            0            0            0            0            0            0            0            0            0            0            0        0.012            0            0       27.765            0            0            0            0            0            0            0            0            0            0            0     5520.751      2880.03 
      CELL85            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0       25.971            0            0            0            0            0            0            0            0            0            0            0     5731.119     2175.756 
      CELL86            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       22.771            0            0            0            0            0            0            0            0            0            0            0     6052.985     3936.988 
      CELL87            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       24.025            0            0            0            0            0            0            0            0            0            0            0     5826.035     3424.614 
      CELL88            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0       12.799            0            0            0            0            0            0            0            0            0            0            0     3270.156      453.191 
      CELL89            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4140.117      258.089 
      CELL90            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       21.834            0            0            0            0            0            0            0            0            0            0            0     3785.606      492.819 
      CELL91            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       14.339            0            0            0            0            0            0            0            0            0            0            0     4858.201      669.895 
      CELL92            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0       13.009            0            0            0            0            0            0            0            0            0            0            0       234.24       97.804 
      CELL93            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       24.765            0            0            0            0            0            0            0            0            0            0            0      348.319      354.948 
      CELL94            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       25.358            0            0            0            0            0            0            0            0            0            0            0     4618.935     3648.605 
      CELL95            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       25.447            0            0            0            0            0            0            0            0            0            0            0     6388.529     6421.171 
      CELL96            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       23.002            0            0            0            0            0            0            0            0            0            0            0      6523.75     6555.449 
      CELL97            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0       25.234            0            0            0            0            0            0            0            0            0            0            0     5830.018      4376.51 
      CELL98            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       21.047            0            0            0            0            0            0            0            0            0            0            0     5813.539     3595.259 
      CELL99            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       21.841            0            0            0            0            0            0            0            0            0            0            0     5673.377     4379.819 
     CELL100            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0       12.159            0            0            0            0            0            0            0            0            0            0            0     5716.877     3941.866 
     CELL101            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        8.229            0            0            0            0            0            0            0            0            0            0            0     5427.986     2447.272 
     CELL102            0            0            0            0            0            0            0            0            0            0            0        0.002            0            0        5.284            0            0            0            0            0            0            0            0            0            0            0     2101.257      524.332 
     CELL103            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       14.243            0            0            0            0            0            0            0            0            0            0            0     1363.241      875.754 
     CELL104            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       21.395            0            0            0            0            0            0            0            0            0            0            0     6010.339     6041.139 
     CELL105            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       22.024            0            0            0            0            0            0            0            0            0            0            0     5904.854     5936.008 
     CELL106            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       18.739            0            0            0            0            0            0            0            0            0            0            0      7462.26     7491.106 
     CELL107            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       23.678            0            0            0            0            0            0            0            0            0            0            0     6279.344     6311.331 
     CELL108            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       14.485            0            0            0            0            0            0            0            0            0            0            0     6184.236     6208.861 
     CELL109            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       16.133            0            0            0            0            0            0            0            0            0            0            0     5992.033     5530.645 
     CELL110            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       19.887            0            0            0            0            0            0            0            0            0            0            0     5213.121     2252.362 
     CELL111            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0        14.28            0            0            0            0            0            0            0            0            0            0            0     4397.347      856.631 
     CELL112            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        6.937            0            0            0            0            0            0            0            0            0            0            0     1210.399      581.735 
     CELL113            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        7.862            0            0            0            0            0            0            0            0            0            0            0      354.583      318.775 
     CELL114            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       16.414            0            0            0            0            0            0            0            0            0            0            0     2932.608     1374.618 
     CELL115            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       18.707            0            0            0            0            0            0            0            0            0            0            0      6484.58     6513.402 
     CELL116            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0       22.975            0            0            0            0            0            0            0            0            0            0            0     6007.883     5937.198 
     CELL117            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       20.964            0            0            0            0            0            0            0            0            0            0            0      6725.26     6755.724 
     CELL118            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       21.964            0            0            0            0            0            0            0            0            0            0            0     6109.982     5993.203 
     CELL119            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       20.612            0            0            0            0            0            0            0            0            0            0            0     5909.024     4841.849 
     CELL120            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2389.443      880.358 
     CELL121            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      543.205            0 
     CELL122            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       16.619            0            0            0            0            0            0            0            0            0            0            0      390.641      287.639 
     CELL123            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0        16.28            0            0            0            0            0            0            0            0            0            0            0     6052.995     6079.576 
     CELL124            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       14.845            0            0            0            0            0            0            0            0            0            0            0     6212.665     6237.693 
     CELL125            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       18.066            0            0            0            0            0            0            0            0            0            0            0     6037.282     5278.253 
     CELL126            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       18.147            0            0            0            0            0            0            0            0            0            0            0     5909.335       5105.4 
     CELL127            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       18.876            0            0            0            0            0            0            0            0            0            0            0     3978.583     2478.653 
     CELL128            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0       19.897            0            0            0            0            0            0            0            0            0            0            0      3627.63     2657.794 
     CELL129            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       19.277            0            0            0            0            0            0            0            0            0            0            0     6101.606     6130.864 
     CELL130            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       14.824            0            0            0            0            0            0            0            0            0            0            0     6062.212     3508.897 
     CELL131            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0         18.1            0            0            0            0            0            0            0            0            0            0            0     4637.133      761.419 
     CELL132            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0       14.018            0            0            0            0            0            0            0            0            0            0            0     1933.791      109.355 
     CELL133            0            0            0            0            0            0            0            0            0            0            0        0.007            0            0       17.285            0            0            0            0            0            0            0            0            0            0            0     1796.446     1018.682 
     CELL134            0            0            0            0            0            0            0            0            0            0            0        0.006            0            0       15.857            0            0            0            0            0            0            0            0            0            0            0     5755.766     4631.509 
     CELL135            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0       12.818            0            0            0            0            0            0            0            0            0            0            0     5422.317     1570.401 
     CELL136            0            0            0            0            0            0            0            0            0            0            0        0.005            0            0       12.948            0            0            0            0            0            0            0            0            0            0            0     3235.815        113.9 
     CELL137            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      163.495            0 
     CELL138            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        7.499            0            0            0            0            0            0            0            0            0            0            0     1267.825       527.95 
     CELL139            0            0            0            0            0            0            0            0            0            0            0        0.004            0            0       11.171            0            0            0            0            0            0            0            0            0            0            0     5506.554     2465.762 
     CELL140            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        6.804            0            0            0            0            0            0            0            0            0            0            0     3901.304      296.961 
     CELL141            0            0            0            0            0            0            0            0            0            0            0        0.002            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1570.115       11.637 
     CELL142            0            0            0            0            0            0            0            0            0            0            0        0.003            0            0        8.092            0            0            0            0            0            0            0            0            0            0            0     1967.147       304.26 
     CELL143            0            0            0            0            0            0            0            0            0            0            0        0.001            0            0        3.206            0            0            0            0            0            0            0            0            0            0            0     4957.525      879.592 
     CELL144            0            0            0            0            0            0            0            0            0            0            0        0.004            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1943.583       17.462 
     CELL145            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        1.941        0.531 
     CELL146            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2080.431      257.151 
     CELL147            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2762.304      274.894 
     CELL148            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      118.455       93.179 
     CELL149            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       26.746        4.855 
     CELL150            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      794.137       17.477 
     CELL151            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       82.294       22.725 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0            0            1            0            0     2355.796            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
