<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0            0        5.831            0            0        6.875            0            0            0            0            0            0            0            0            0            0            0      326.882      172.212 
       CELL2            0            0            0            0            0            0            0            0            0            0            0       35.092            0            0       41.818            0            0            0            0            0            0            0            0            0            0            0       80.958       30.924 
       CELL3            0            0            0            0            0            0            0            0            0            0            0        1.918            0            0         2.31            0            0            0            0            0            0            0            0            0            0            0      243.667      142.349 
       CELL4            0            0            0            0            0            0            0            0            0            0            0        8.083            0            0        9.817            0            0            0            0            0            0            0            0            0            0            0     1866.264      261.181 
       CELL5            0            0            0            0            0            0            0            0            0            0            0       23.356            0            0       28.411            0            0            0            0            0            0            0            0            0            0            0      953.126      214.992 
       CELL6            0            0            0            0            0            0            0            0            0            0            0       25.786            0            0       30.771            0            0            0            0            0            0            0            0            0            0            0      338.983      208.595 
       CELL7            0            0            0            0            0            0            0            0            0            0            0       14.835            0            0       18.149            0            0            0            0            0            0            0            0            0            0            0      580.686        264.3 
       CELL8            0            0            0            0            0            0            0            0            0            0            0       50.509            0            0       61.338            0            0            0            0            0            0            0            0            0            0            0     1151.877      258.093 
       CELL9            0            0            0            0            0            0            0            0            0            0            0       85.068            0            0            0            0            0            0            0            0            0            0            0            0            0            0       1429.2      448.915 
      CELL10            0            0            0            0            0            0            0            0            0            0            0       57.596            0            0       69.823            0            0            0            0            0            0            0            0            0            0            0      214.325       66.104 
      CELL11            0            0            0            0            0            0            0            0            0            0            0       93.279            0            0      112.855            0            0            0            0            0            0            0            0            0            0            0     1302.414     1204.338 
      CELL12            0            0            0            0            0            0            0            0            0            0            0           82            0            0       98.638            0            0            0            0            0            0            0            0            0            0            0     1640.858      709.585 
      CELL13            0            0            0            0            0            0            0            0            0            0            0       85.371            0            0            0            0            0            0            0            0            0            0            0            0            0            0      756.149      446.374 
      CELL14            0            0            0            0            0            0            0            0            0            0            0       43.573            0            0            0            0            0            0            0            0            0            0            0            0            0            0      360.047      416.133 
      CELL15            0            0            0            0            0            0            0            0            0            0            0       92.207            0            0            0            0            0            0            0            0            0            0            0            0            0            0      147.749       12.621 
      CELL16            0            0            0            0            0            0            0            0            0            0            0        47.14            0            0       57.845            0            0            0            0            0            0            0            0            0            0            0      753.952      637.112 
      CELL17            0            0            0            0            0            0            0            0            0            0            0       57.413            0            0       69.115            0            0            0            0            0            0            0            0            0            0            0       795.75      670.426 
      CELL18            0            0            0            0            0            0            0            0            0            0            0       66.483            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1511.219      735.288 
      CELL19            0            0            0            0            0            0            0            0            0            0            0        83.98            0            0            0            0            0            0            0            0            0            0            0            0            0            0      584.178      192.105 
      CELL20            0            0            0            0            0            0            0            0            0            0            0       46.146            0            0       55.906            0            0            0            0            0            0            0            0            0            0            0      931.096        599.6 
      CELL21            0            0            0            0            0            0            0            0            0            0            0        63.04            0            0       76.623            0            0            0            0            0            0            0            0            0            0            0     2521.372     1238.824 
      CELL22            0            0            0            0            0            0            0            0            0            0            0       106.63            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3205.337     1315.845 
      CELL23            0            0            0            0            0            0            0            0            0            0            0      124.312            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3120.682     1420.298 
      CELL24            0            0            0            0            0            0            0            0            0            0            0      126.067            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1156.03     1113.449 
      CELL25            0            0            0            0            0            0            0            0            0            0            0      126.294            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1423.222     1755.965 
      CELL26            0            0            0            0            0            0            0            0            0            0            0       96.118            0            0      112.895            0            0            0            0            0            0            0            0            0            0            0     1249.593      700.557 
      CELL27            0            0            0            0            0            0            0            0            0            0            0      140.626            0            0      162.876            0            0            0            0            0            0            0            0            0            0            0      115.826      106.011 
      CELL28            0            0            0            0            0            0            0            0            0            0            0       34.235            0            0        42.36            0            0            0            0            0            0            0            0            0            0            0      116.968      128.133 
      CELL29            0            0            0            0            0            0            0            0            0            0            0       69.367            0            0       85.133            0            0            0            0            0            0            0            0            0            0            0      772.313      293.014 
      CELL30            0            0            0            0            0            0            0            0            0            0            0       17.014            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2042.136      454.942 
      CELL31            0            0            0            0            0            0            0            0            0            0            0       29.595            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1717.398     1046.058 
      CELL32            0            0            0            0            0            0            0            0            0            0            0       88.897            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1417.654      1470.36 
      CELL33            0            0            0            0            0            0            0            0            0            0            0      105.355            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2390.946      843.022 
      CELL34            0            0            0            0            0            0            0            0            0            0            0      108.764            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2756.708     1839.801 
      CELL35            0            0            0            0            0            0            0            0            0            0            0      116.011            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3059.194     1310.509 
      CELL36            0            0            0            0            0            0            0            0            0            0            0      126.675            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1799.37      674.967 
      CELL37            0            0            0            0            0            0            0            0            0            0            0        131.3            0            0            0            0            0            0            0            0            0            0            0            0            0            0      878.063     1023.077 
      CELL38            0            0            0            0            0            0            0            0            0            0            0      142.648            0            0       168.93            0            0            0            0            0            0            0            0            0            0            0      615.387      686.979 
      CELL39            0            0            0            0            0            0            0            0            0            0            0       80.605            0            0       94.511            0            0            0            0            0            0            0            0            0            0            0      621.202      425.464 
      CELL40            0            0            0            0            0            0            0            0            0            0            0      109.865            0            0      127.355            0            0            0            0            0            0            0            0            0            0            0      302.853      338.211 
      CELL41            0            0            0            0            0            0            0            0            0            0            0        47.22            0            0       57.105            0            0            0            0            0            0            0            0            0            0            0      466.786       81.085 
      CELL42            0            0            0            0            0            0            0            0            0            0            0       12.913            0            0       15.596            0            0            0            0            0            0            0            0            0            0            0     1490.564       508.47 
      CELL43            0            0            0            0            0            0            0            0            0            0            0       39.253            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1525.512      379.681 
      CELL44            0            0            0            0            0            0            0            0            0            0            0       73.634            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1609.208     1698.805 
      CELL45            0            0            0            0            0            0            0            0            0            0            0      106.087            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1819.065     2088.297 
      CELL46            0            0            0            0            0            0            0            0            0            0            0        44.27            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1683.989      1802.16 
      CELL47            0            0            0            0            0            0            0            0            0            0            0       59.381            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1658.131     1816.993 
      CELL48            0            0            0            0            0            0            0            0            0            0            0      113.625            0            0            0            0            0            0            0            0            0            0            0            0            0            0      715.098      648.515 
      CELL49            0            0            0            0            0            0            0            0            0            0            0       73.374            0            0            0            0            0            0            0            0            0            0            0            0            0            0       292.58      361.084 
      CELL50            0            0            0            0            0            0            0            0            0            0            0      152.047            0            0      178.156            0            0            0            0            0            0            0            0            0            0            0      512.392      572.216 
      CELL51            0            0            0            0            0            0            0            0            0            0            0       56.725            0            0       67.476            0            0            0            0            0            0            0            0            0            0            0       27.236       30.426 
      CELL52            0            0            0            0            0            0            0            0            0            0            0       58.061            0            0       70.362            0            0            0            0            0            0            0            0            0            0            0      464.526      380.396 
      CELL53            0            0            0            0            0            0            0            0            0            0            0       64.809            0            0       79.392            0            0            0            0            0            0            0            0            0            0            0      828.736      924.595 
      CELL54            0            0            0            0            0            0            0            0            0            0            0       44.083            0            0       54.809            0            0            0            0            0            0            0            0            0            0            0       21.771       23.797 
      CELL55            0            0            0            0            0            0            0            0            0            0            0       76.035            0            0       94.474            0            0            0            0            0            0            0            0            0            0            0      110.145      120.205 
      CELL56            0            0            0            0            0            0            0            0            0            0            0       70.306            0            0       86.346            0            0            0            0            0            0            0            0            0            0            0      275.832      300.876 
      CELL57            0            0            0            0            0            0            0            0            0            0            0         59.4            0            0       72.177            0            0            0            0            0            0            0            0            0            0            0      542.583      206.527 
      CELL58            0            0            0            0            0            0            0            0            0            0            0      102.072            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1125.148     1286.254 
      CELL59            0            0            0            0            0            0            0            0            0            0            0       101.88            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1161.137     1098.237 
      CELL60            0            0            0            0            0            0            0            0            0            0            0        125.6            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1515.287     1734.628 
      CELL61            0            0            0            0            0            0            0            0            0            0            0        72.04            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2147.714     2342.687 
      CELL62            0            0            0            0            0            0            0            0            0            0            0       98.569            0            0            0            0            0            0            0            0            0            0            0            0            0            0      841.321     1036.192 
      CELL63            0            0            0            0            0            0            0            0            0            0            0       104.51            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1165.203     1436.666 
      CELL64            0            0            0            0            0            0            0            0            0            0            0       73.956            0            0       87.529            0            0            0            0            0            0            0            0            0            0            0      482.164      538.259 
      CELL65            0            0            0            0            0            0            0            0            0            0            0      161.087            0            0      187.023            0            0            0            0            0            0            0            0            0            0            0      346.581      386.957 
      CELL66            0            0            0            0            0            0            0            0            0            0            0      159.536            0            0      185.508            0            0            0            0            0            0            0            0            0            0            0     2034.756     2271.845 
      CELL67            0            0            0            0            0            0            0            0            0            0            0       15.836            0            0       19.422            0            0            0            0            0            0            0            0            0            0            0       20.149       22.052 
      CELL68            0            0            0            0            0            0            0            0            0            0            0       70.918            0            0       87.092            0            0            0            0            0            0            0            0            0            0            0      678.354      756.792 
      CELL69            0            0            0            0            0            0            0            0            0            0            0       73.189            0            0            0            0            0            0            0            0            0            0            0            0            0            0      605.198      696.224 
      CELL70            0            0            0            0            0            0            0            0            0            0            0       46.028            0            0            0            0            0            0            0            0            0            0            0            0            0            0      353.074      406.552 
      CELL71            0            0            0            0            0            0            0            0            0            0            0        36.56            0            0       44.165            0            0            0            0            0            0            0            0            0            0            0      346.369      377.065 
      CELL72            0            0            0            0            0            0            0            0            0            0            0       82.758            0            0      103.667            0            0            0            0            0            0            0            0            0            0            0     1358.489     1483.953 
      CELL73            0            0            0            0            0            0            0            0            0            0            0       85.553            0            0            0            0            0            0            0            0            0            0            0            0            0            0       1253.3     1446.598 
      CELL74            0            0            0            0            0            0            0            0            0            0            0       61.205            0            0            0            0            0            0            0            0            0            0            0            0            0            0      700.845      800.048 
      CELL75            0            0            0            0            0            0            0            0            0            0            0        34.13            0            0            0            0            0            0            0            0            0            0            0            0            0            0       1209.4     1301.799 
      CELL76            0            0            0            0            0            0            0            0            0            0            0       84.753            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1453.767     1689.051 
      CELL77            0            0            0            0            0            0            0            0            0            0            0      136.951            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1163.697     1434.596 
      CELL78            0            0            0            0            0            0            0            0            0            0            0       92.349            0            0      109.178            0            0            0            0            0            0            0            0            0            0            0     2274.973     2515.656 
      CELL79            0            0            0            0            0            0            0            0            0            0            0      142.725            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4570.986     4942.832 
      CELL80            0            0            0            0            0            0            0            0            0            0            0      149.688            0            0      175.612            0            0            0            0            0            0            0            0            0            0            0     1489.324     1663.302 
      CELL81            0            0            0            0            0            0            0            0            0            0            0      149.516            0            0      173.645            0            0            0            0            0            0            0            0            0            0            0       78.855       80.341 
      CELL82            0            0            0            0            0            0            0            0            0            0            0      165.553            0            0            0            0            0            0            0            0            0            0            0            0            0            0      328.561      240.272 
      CELL83            0            0            0            0            0            0            0            0            0            0            0      148.214            0            0      172.323            0            0            0            0            0            0            0            0            0            0            0     2503.316     2408.396 
      CELL84            0            0            0            0            0            0            0            0            0            0            0      166.546            0            0      193.655            0            0            0            0            0            0            0            0            0            0            0     2898.943     2942.178 
      CELL85            0            0            0            0            0            0            0            0            0            0            0      166.431            0            0      193.585            0            0            0            0            0            0            0            0            0            0            0      354.288      281.777 
      CELL86            0            0            0            0            0            0            0            0            0            0            0       51.747            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.258       31.756 
      CELL87            0            0            0            0            0            0            0            0            0            0            0       47.438            0            0            0            0            0            0            0            0            0            0            0            0            0            0      701.023      809.307 
      CELL88            0            0            0            0            0            0            0            0            0            0            0       60.816            0            0            0            0            0            0            0            0            0            0            0            0            0            0      370.974      424.818 
      CELL89            0            0            0            0            0            0            0            0            0            0            0       90.047            0            0            0            0            0            0            0            0            0            0            0            0            0            0      827.797      953.033 
      CELL90            0            0            0            0            0            0            0            0            0            0            0       83.185            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1679.192     1906.123 
      CELL91            0            0            0            0            0            0            0            0            0            0            0       89.583            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2117.971     2362.422 
      CELL92            0            0            0            0            0            0            0            0            0            0            0       87.967            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2007.481     2251.221 
      CELL93            0            0            0            0            0            0            0            0            0            0            0       64.295            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1993.244     2168.525 
      CELL94            0            0            0            0            0            0            0            0            0            0            0      119.207            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1113.423     1289.963 
      CELL95            0            0            0            0            0            0            0            0            0            0            0       129.88            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2106.133     2450.749 
      CELL96            0            0            0            0            0            0            0            0            0            0            0      142.203            0            0      168.041            0            0            0            0            0            0            0            0            0            0            0     4977.711     5348.324 
      CELL97            0            0            0            0            0            0            0            0            0            0            0      138.456            0            0      162.389            0            0            0            0            0            0            0            0            0            0            0     5032.114     5389.846 
      CELL98            0            0            0            0            0            0            0            0            0            0            0      133.655            0            0      156.849            0            0            0            0            0            0            0            0            0            0            0     4371.719     4717.035 
      CELL99            0            0            0            0            0            0            0            0            0            0            0      154.516            0            0      179.603            0            0            0            0            0            0            0            0            0            0            0     4217.688     4612.912 
     CELL100            0            0            0            0            0            0            0            0            0            0            0      135.934            0            0      158.123            0            0            0            0            0            0            0            0            0            0            0     1498.256     1433.319 
     CELL101            0            0            0            0            0            0            0            0            0            0            0      162.194            0            0      188.868            0            0            0            0            0            0            0            0            0            0            0     1172.665     1196.138 
     CELL102            0            0            0            0            0            0            0            0            0            0            0      167.996            0            0       193.61            0            0            0            0            0            0            0            0            0            0            0     2323.505     1884.642 
     CELL103            0            0            0            0            0            0            0            0            0            0            0      175.429            0            0      201.938            0            0            0            0            0            0            0            0            0            0            0     3331.146     2993.169 
     CELL104            0            0            0            0            0            0            0            0            0            0            0      171.675            0            0      197.431            0            0            0            0            0            0            0            0            0            0            0     2045.333      841.805 
     CELL105            0            0            0            0            0            0            0            0            0            0            0       39.017            0            0            0            0            0            0            0            0            0            0            0            0            0            0      333.253      384.577 
     CELL106            0            0            0            0            0            0            0            0            0            0            0       32.018            0            0            0            0            0            0            0            0            0            0            0            0            0            0      711.182      798.023 
     CELL107            0            0            0            0            0            0            0            0            0            0            0        8.572            0            0            0            0            0            0            0            0            0            0            0            0            0            0      421.249      444.664 
     CELL108            0            0            0            0            0            0            0            0            0            0            0       19.483            0            0            0            0            0            0            0            0            0            0            0            0            0            0      616.277       669.17 
     CELL109            0            0            0            0            0            0            0            0            0            0            0       47.615            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1617.614     1747.557 
     CELL110            0            0            0            0            0            0            0            0            0            0            0       98.926            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1749.169     2016.365 
     CELL111            0            0            0            0            0            0            0            0            0            0            0      100.929            0            0      126.392            0            0            0            0            0            0            0            0            0            0            0      954.817     1041.429 
     CELL112            0            0            0            0            0            0            0            0            0            0            0       96.461            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1629.266     1880.272 
     CELL113            0            0            0            0            0            0            0            0            0            0            0      119.805            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1130.255     1394.862 
     CELL114            0            0            0            0            0            0            0            0            0            0            0        72.48            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1449.092     1642.371 
     CELL115            0            0            0            0            0            0            0            0            0            0            0       99.933            0            0      118.315            0            0            0            0            0            0            0            0            0            0            0     1538.867     1718.233 
     CELL116            0            0            0            0            0            0            0            0            0            0            0      145.244            0            0       172.03            0            0            0            0            0            0            0            0            0            0            0     3076.466     3434.929 
     CELL117            0            0            0            0            0            0            0            0            0            0            0      153.655            0            0      180.481            0            0            0            0            0            0            0            0            0            0            0     3693.138     4090.387 
     CELL118            0            0            0            0            0            0            0            0            0            0            0      160.509            0            0      186.542            0            0            0            0            0            0            0            0            0            0            0     4150.345     4560.487 
     CELL119            0            0            0            0            0            0            0            0            0            0            0      159.898            0            0      186.201            0            0            0            0            0            0            0            0            0            0            0     2547.096     2277.129 
     CELL120            0            0            0            0            0            0            0            0            0            0            0      172.353            0            0      198.463            0            0            0            0            0            0            0            0            0            0            0     4848.535     5284.154 
     CELL121            0            0            0            0            0            0            0            0            0            0            0      173.287            0            0       199.71            0            0            0            0            0            0            0            0            0            0            0     3343.671      3502.47 
     CELL122            0            0            0            0            0            0            0            0            0            0            0      147.462            0            0      170.521            0            0            0            0            0            0            0            0            0            0            0      977.271      665.951 
     CELL123            0            0            0            0            0            0            0            0            0            0            0      177.571            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3198.447      685.789 
     CELL124            0            0            0            0            0            0            0            0            0            0            0       25.628            0            0            0            0            0            0            0            0            0            0            0            0            0            0       82.285       95.177 
     CELL125            0            0            0            0            0            0            0            0            0            0            0       46.842            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.358        46.15 
     CELL126            0            0            0            0            0            0            0            0            0            0            0       41.123            0            0            0            0            0            0            0            0            0            0            0            0            0            0      668.794      778.731 
     CELL127            0            0            0            0            0            0            0            0            0            0            0       16.958            0            0            0            0            0            0            0            0            0            0            0            0            0            0      458.039      505.204 
     CELL128            0            0            0            0            0            0            0            0            0            0            0       57.317            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1130.883     1289.313 
     CELL129            0            0            0            0            0            0            0            0            0            0            0       79.146            0            0       98.663            0            0            0            0            0            0            0            0            0            0            0      585.013      652.336 
     CELL130            0            0            0            0            0            0            0            0            0            0            0      115.484            0            0      138.036            0            0            0            0            0            0            0            0            0            0            0      977.797     1091.442 
     CELL131            0            0            0            0            0            0            0            0            0            0            0       87.444            0            0      105.747            0            0            0            0            0            0            0            0            0            0            0      461.879      495.191 
     CELL132            0            0            0            0            0            0            0            0            0            0            0      114.519            0            0      135.488            0            0            0            0            0            0            0            0            0            0            0     2167.021     2419.812 
     CELL133            0            0            0            0            0            0            0            0            0            0            0       125.04            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4286.461      4612.98 
     CELL134            0            0            0            0            0            0            0            0            0            0            0      109.887            0            0      130.092            0            0            0            0            0            0            0            0            0            0            0     3506.623     3689.205 
     CELL135            0            0            0            0            0            0            0            0            0            0            0       65.127            0            0       76.614            0            0            0            0            0            0            0            0            0            0            0     2736.522     2681.224 
     CELL136            0            0            0            0            0            0            0            0            0            0            0       130.58            0            0      153.686            0            0            0            0            0            0            0            0            0            0            0      2824.83     2068.092 
     CELL137            0            0            0            0            0            0            0            0            0            0            0      160.111            0            0      188.449            0            0            0            0            0            0            0            0            0            0            0     3091.938     3452.808 
     CELL138            0            0            0            0            0            0            0            0            0            0            0      168.303            0            0        193.9            0            0            0            0            0            0            0            0            0            0            0     3849.162     4274.693 
     CELL139            0            0            0            0            0            0            0            0            0            0            0      172.647            0            0      199.161            0            0            0            0            0            0            0            0            0            0            0     3178.239     2443.604 
     CELL140            0            0            0            0            0            0            0            0            0            0            0      174.796            0            0      199.415            0            0            0            0            0            0            0            0            0            0            0     1685.816     1817.423 
     CELL141            0            0            0            0            0            0            0            0            0            0            0      174.886            0            0      199.661            0            0            0            0            0            0            0            0            0            0            0      235.028       59.985 
     CELL142            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      371.364       40.651 
     CELL143            0            0            0            0            0            0            0            0            0            0            0       77.369            0            0            0            0            0            0            0            0            0            0            0            0            0            0      774.261      956.632 
     CELL144            0            0            0            0            0            0            0            0            0            0            0       96.753            0            0            0            0            0            0            0            0            0            0            0            0            0            0      455.335      562.482 
     CELL145            0            0            0            0            0            0            0            0            0            0            0      103.887            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1537.796     1810.177 
     CELL146            0            0            0            0            0            0            0            0            0            0            0       110.33            0            0      133.313            0            0            0            0            0            0            0            0            0            0            0     1197.381     1336.508 
     CELL147            0            0            0            0            0            0            0            0            0            0            0      107.907            0            0      127.874            0            0            0            0            0            0            0            0            0            0            0     2262.826     2423.551 
     CELL148            0            0            0            0            0            0            0            0            0            0            0       89.639            0            0      106.117            0            0            0            0            0            0            0            0            0            0            0     2371.407     1789.905 
     CELL149            0            0            0            0            0            0            0            0            0            0            0       98.901            0            0      117.191            0            0            0            0            0            0            0            0            0            0            0     2281.559     1456.786 
     CELL150            0            0            0            0            0            0            0            0            0            0            0      140.975            0            0      165.476            0            0            0            0            0            0            0            0            0            0            0     4243.343     3054.494 
     CELL151            0            0            0            0            0            0            0            0            0            0            0      145.905            0            0       172.72            0            0            0            0            0            0            0            0            0            0            0     3609.879      3733.98 
     CELL152            0            0            0            0            0            0            0            0            0            0            0      156.635            0            0      184.378            0            0            0            0            0            0            0            0            0            0            0     2245.992     2061.294 
     CELL153            0            0            0            0            0            0            0            0            0            0            0      160.887            0            0      189.308            0            0            0            0            0            0            0            0            0            0            0     2863.265     2182.945 
     CELL154            0            0            0            0            0            0            0            0            0            0            0      145.475            0            0      169.386            0            0            0            0            0            0            0            0            0            0            0     4671.789     5043.675 
     CELL155            0            0            0            0            0            0            0            0            0            0            0      137.604            0            0      158.631            0            0            0            0            0            0            0            0            0            0            0     2995.905       2591.1 
     CELL156            0            0            0            0            0            0            0            0            0            0            0      165.808            0            0      191.356            0            0            0            0            0            0            0            0            0            0            0     3074.693     2606.982 
     CELL157            0            0            0            0            0            0            0            0            0            0            0      160.751            0            0      185.557            0            0            0            0            0            0            0            0            0            0            0      629.719       559.65 
     CELL158            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      911.729            0 
     CELL159            0            0            0            0            0            0            0            0            0            0            0        56.86            0            0            0            0            0            0            0            0            0            0            0            0            0            0      107.067      132.303 
     CELL160            0            0            0            0            0            0            0            0            0            0            0       41.257            0            0       49.683            0            0            0            0            0            0            0            0            0            0            0     1090.868      988.049 
     CELL161            0            0            0            0            0            0            0            0            0            0            0      101.242            0            0      118.881            0            0            0            0            0            0            0            0            0            0            0      3052.62     1565.777 
     CELL162            0            0            0            0            0            0            0            0            0            0            0      126.828            0            0      149.069            0            0            0            0            0            0            0            0            0            0            0     3418.174     1426.743 
     CELL163            0            0            0            0            0            0            0            0            0            0            0       79.656            0            0       93.714            0            0            0            0            0            0            0            0            0            0            0     4543.304     2022.397 
     CELL164            0            0            0            0            0            0            0            0            0            0            0      138.438            0            0      162.819            0            0            0            0            0            0            0            0            0            0            0     3118.022     3051.039 
     CELL165            0            0            0            0            0            0            0            0            0            0            0      130.528            0            0      153.823            0            0            0            0            0            0            0            0            0            0            0     1256.718      898.178 
     CELL166            0            0            0            0            0            0            0            0            0            0            0      156.491            0            0       182.22            0            0            0            0            0            0            0            0            0            0            0     3603.747     4004.075 
     CELL167            0            0            0            0            0            0            0            0            0            0            0      155.473            0            0      181.266            0            0            0            0            0            0            0            0            0            0            0     3500.554     2752.773 
     CELL168            0            0            0            0            0            0            0            0            0            0            0      125.974            0            0      145.292            0            0            0            0            0            0            0            0            0            0            0     3973.592     2447.879 
     CELL169            0            0            0            0            0            0            0            0            0            0            0      160.487            0            0       185.24            0            0            0            0            0            0            0            0            0            0            0     2792.837       682.06 
     CELL170            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1088.22      184.406 
     CELL171            0            0            0            0            0            0            0            0            0            0            0       63.692            0            0       75.036            0            0            0            0            0            0            0            0            0            0            0      552.242      617.007 
     CELL172            0            0            0            0            0            0            0            0            0            0            0       79.829            0            0       92.771            0            0            0            0            0            0            0            0            0            0            0      558.192      623.567 
     CELL173            0            0            0            0            0            0            0            0            0            0            0      107.589            0            0      125.173            0            0            0            0            0            0            0            0            0            0            0      402.186      359.058 
     CELL174            0            0            0            0            0            0            0            0            0            0            0       91.326            0            0      107.571            0            0            0            0            0            0            0            0            0            0            0     1880.108     1916.261 
     CELL175            0            0            0            0            0            0            0            0            0            0            0      141.694            0            0      164.954            0            0            0            0            0            0            0            0            0            0            0     2083.463     2327.146 
     CELL176            0            0            0            0            0            0            0            0            0            0            0      136.802            0            0      159.321            0            0            0            0            0            0            0            0            0            0            0     4375.662     4726.067 
     CELL177            0            0            0            0            0            0            0            0            0            0            0       71.724            0            0       83.599            0            0            0            0            0            0            0            0            0            0            0     4994.715     1535.095 
     CELL178            0            0            0            0            0            0            0            0            0            0            0       97.829            0            0      114.041            0            0            0            0            0            0            0            0            0            0            0     3545.138     2087.752 
     CELL179            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      992.486      149.719 
     CELL180            0            0            0            0            0            0            0            0            0            0            0      130.321            0            0       151.72            0            0            0            0            0            0            0            0            0            0            0      873.197       975.46 
     CELL181            0            0            0            0            0            0            0            0            0            0            0      129.241            0            0      150.407            0            0            0            0            0            0            0            0            0            0            0     3955.632     4286.999 
     CELL182            0            0            0            0            0            0            0            0            0            0            0      105.718            0            0      123.082            0            0            0            0            0            0            0            0            0            0            0     4193.925     4202.855 
     CELL183            0            0            0            0            0            0            0            0            0            0            0      112.492            0            0      132.472            0            0            0            0            0            0            0            0            0            0            0     2571.995     2126.452 
     CELL184            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1304.606      224.494 
     CELL185            0            0            0            0            0            0            0            0            0            0            0       98.977            0            0      113.968            0            0            0            0            0            0            0            0            0            0            0     2341.522     2592.588 
     CELL186            0            0            0            0            0            0            0            0            0            0            0      100.964            0            0      116.268            0            0            0            0            0            0            0            0            0            0            0     1885.809     1780.165 
     CELL187            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1100.315      164.863 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0            0        17746            0            0    14040.768            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
