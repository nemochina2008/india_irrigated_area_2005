<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0        0.384        9.571            0            0        0.657            0            0            0            0            0            0            0            0            0            0            0     1804.379      898.484 
       CELL2            0            0            0            0            0            0            0            0            0            0        0.364        9.083            0            0        0.623            0            0            0            0            0            0            0            0            0            0            0      1533.09      537.573 
       CELL3            0            0            0            0            0            0            0            0            0            0        0.381        9.494            0            0        0.651            0            0            0            0            0            0            0            0            0            0            0      826.841      345.633 
       CELL4            0            0            0            0            0            0            0            0            0            0        0.295        7.357            0            0        0.505            0            0            0            0            0            0            0            0            0            0            0      557.806      221.761 
       CELL5            0            0            0            0            0            0            0            0            0            0        0.305        7.612            0            0        0.525            0            0            0            0            0            0            0            0            0            0            0      114.735       82.555 
       CELL6            0            0            0            0            0            0            0            0            0            0        0.288        7.187            0            0        0.492            0            0            0            0            0            0            0            0            0            0            0     2970.574      554.024 
       CELL7            0            0            0            0            0            0            0            0            0            0        0.347        8.647            0            0        0.592            0            0            0            0            0            0            0            0            0            0            0     1356.293      568.972 
       CELL8            0            0            0            0            0            0            0            0            0            0        0.396        9.885            0            0        0.678            0            0            0            0            0            0            0            0            0            0            0     2832.291     1362.064 
       CELL9            0            0            0            0            0            0            0            0            0            0        0.399        9.939            0            0        0.682            0            0            0            0            0            0            0            0            0            0            0     5595.436     3161.976 
      CELL10            0            0            0            0            0            0            0            0            0            0        0.382        9.516            0            0        0.653            0            0            0            0            0            0            0            0            0            0            0     5638.631     4087.811 
      CELL11            0            0            0            0            0            0            0            0            0            0        0.319        7.944            0            0        0.545            0            0            0            0            0            0            0            0            0            0            0     5639.724      4229.62 
      CELL12            0            0            0            0            0            0            0            0            0            0        0.365        9.109            0            0        0.624            0            0            0            0            0            0            0            0            0            0            0     2289.199      770.133 
      CELL13            0            0            0            0            0            0            0            0            0            0         0.27        6.745            0            0        0.466            0            0            0            0            0            0            0            0            0            0            0     1922.556     1614.923 
      CELL14            0            0            0            0            0            0            0            0            0            0        0.313        7.801            0            0        0.534            0            0            0            0            0            0            0            0            0            0            0     5848.012     1166.021 
      CELL15            0            0            0            0            0            0            0            0            0            0        0.311        7.765            0            0        0.532            0            0            0            0            0            0            0            0            0            0            0     5541.048     1915.172 
      CELL16            0            0            0            0            0            0            0            0            0            0        0.216        5.392            0            0        0.369            0            0            0            0            0            0            0            0            0            0            0     1859.321      1047.96 
      CELL17            0            0            0            0            0            0            0            0            0            0         0.22        5.482            0            0        0.375            0            0            0            0            0            0            0            0            0            0            0      242.304      173.935 
      CELL18            0            0            0            0            0            0            0            0            0            0        0.311        7.756            0            0        0.532            0            0            0            0            0            0            0            0            0            0            0     4355.794     1771.557 
      CELL19            0            0            0            0            0            0            0            0            0            0        0.399        9.933            0            0        0.682            0            0            0            0            0            0            0            0            0            0            0     5487.249      3632.36 
      CELL20            0            0            0            0            0            0            0            0            0            0        0.414       10.311            0            0        0.708            0            0            0            0            0            0            0            0            0            0            0     5492.607     4205.986 
      CELL21            0            0            0            0            0            0            0            0            0            0        0.408       10.192            0            0        0.699            0            0            0            0            0            0            0            0            0            0            0       5592.6     2948.947 
      CELL22            0            0            0            0            0            0            0            0            0            0        0.372        9.276            0            0        0.636            0            0            0            0            0            0            0            0            0            0            0     2019.701      685.238 
      CELL23            0            0            0            0            0            0            0            0            0            0        0.107         2.66            0            0        0.184            0            0            0            0            0            0            0            0            0            0            0      697.146      220.162 
      CELL24            0            0            0            0            0            0            0            0            0            0        0.283        7.069            0            0        0.484            0            0            0            0            0            0            0            0            0            0            0     3178.535     2117.711 
      CELL25            0            0            0            0            0            0            0            0            0            0        0.151        3.772            0            0        0.258            0            0            0            0            0            0            0            0            0            0            0     5529.868     2633.711 
      CELL26            0            0            0            0            0            0            0            0            0            0        0.327        8.143            0            0        0.558            0            0            0            0            0            0            0            0            0            0            0     6105.754     3173.174 
      CELL27            0            0            0            0            0            0            0            0            0            0        0.345         8.61            0            0        0.591            0            0            0            0            0            0            0            0            0            0            0     5979.698     3335.105 
      CELL28            0            0            0            0            0            0            0            0            0            0        0.217          5.4            0            0        0.371            0            0            0            0            0            0            0            0            0            0            0     5632.701     3500.239 
      CELL29            0            0            0            0            0            0            0            0            0            0        0.351        8.762            0            0        0.601            0            0            0            0            0            0            0            0            0            0            0     4543.069      3313.97 
      CELL30            0            0            0            0            0            0            0            0            0            0        0.406       10.129            0            0        0.695            0            0            0            0            0            0            0            0            0            0            0     4148.944     4100.535 
      CELL31            0            0            0            0            0            0            0            0            0            0          0.4         9.99            0            0        0.685            0            0            0            0            0            0            0            0            0            0            0     2487.354     1857.713 
      CELL32            0            0            0            0            0            0            0            0            0            0        0.382        9.521            0            0        0.653            0            0            0            0            0            0            0            0            0            0            0      2603.67     1744.273 
      CELL33            0            0            0            0            0            0            0            0            0            0        0.407       10.159            0            0        0.697            0            0            0            0            0            0            0            0            0            0            0     4476.747     2587.681 
      CELL34            0            0            0            0            0            0            0            0            0            0        0.425       10.586            0            0        0.726            0            0            0            0            0            0            0            0            0            0            0      1192.11      532.567 
      CELL35            0            0            0            0            0            0            0            0            0            0        0.423        10.54            0            0        0.723            0            0            0            0            0            0            0            0            0            0            0     3523.397      407.225 
      CELL36            0            0            0            0            0            0            0            0            0            0        0.422       10.513            0            0        0.721            0            0            0            0            0            0            0            0            0            0            0     5829.596     2317.863 
      CELL37            0            0            0            0            0            0            0            0            0            0        0.414       10.315            0            0        0.707            0            0            0            0            0            0            0            0            0            0            0     3618.841     2108.024 
      CELL38            0            0            0            0            0            0            0            0            0            0        0.379        9.433            0            0        0.646            0            0            0            0            0            0            0            0            0            0            0      166.392       80.575 
      CELL39            0            0            0            0            0            0            0            0            0            0         0.29        7.221            0            0        0.494            0            0            0            0            0            0            0            0            0            0            0     1081.286      206.325 
      CELL40            0            0            0            0            0            0            0            0            0            0        0.218         5.43            0            0        0.371            0            0            0            0            0            0            0            0            0            0            0     4382.359     1286.079 
      CELL41            0            0            0            0            0            0            0            0            0            0        0.287        7.154            0            0        0.489            0            0            0            0            0            0            0            0            0            0            0     5952.508     3276.687 
      CELL42            0            0            0            0            0            0            0            0            0            0        0.314        7.824            0            0        0.536            0            0            0            0            0            0            0            0            0            0            0     6047.203     2022.498 
      CELL43            0            0            0            0            0            0            0            0            0            0        0.216        5.386            0            0        0.369            0            0            0            0            0            0            0            0            0            0            0     6114.956     3016.302 
      CELL44            0            0            0            0            0            0            0            0            0            0        0.384        9.573            0            0        0.657            0            0            0            0            0            0            0            0            0            0            0     5850.112     4127.387 
      CELL45            0            0            0            0            0            0            0            0            0            0         0.36        8.974            0            0        0.616            0            0            0            0            0            0            0            0            0            0            0     5972.397     4428.699 
      CELL46            0            0            0            0            0            0            0            0            0            0        0.265          6.6            0            0        0.453            0            0            0            0            0            0            0            0            0            0            0     5966.218     5109.128 
      CELL47            0            0            0            0            0            0            0            0            0            0        0.421       10.479            0            0         0.72            0            0            0            0            0            0            0            0            0            0            0     6000.466      3802.59 
      CELL48            0            0            0            0            0            0            0            0            0            0        0.349        8.704            0            0        0.598            0            0            0            0            0            0            0            0            0            0            0     5707.266     4834.329 
      CELL49            0            0            0            0            0            0            0            0            0            0        0.422       10.519            0            0        0.722            0            0            0            0            0            0            0            0            0            0            0     4680.083      4072.41 
      CELL50            0            0            0            0            0            0            0            0            0            0        0.435       10.848            0            0        0.744            0            0            0            0            0            0            0            0            0            0            0     3222.332     3308.056 
      CELL51            0            0            0            0            0            0            0            0            0            0        0.432       10.764            0            0        0.738            0            0            0            0            0            0            0            0            0            0            0        18.46        6.895 
      CELL52            0            0            0            0            0            0            0            0            0            0        0.425       10.583            0            0        0.726            0            0            0            0            0            0            0            0            0            0            0      728.056      215.017 
      CELL53            0            0            0            0            0            0            0            0            0            0        0.393        9.788            0            0        0.671            0            0            0            0            0            0            0            0            0            0            0     5079.544     3340.985 
      CELL54            0            0            0            0            0            0            0            0            0            0        0.264        6.582            0            0        0.451            0            0            0            0            0            0            0            0            0            0            0     5054.154     2877.309 
      CELL55            0            0            0            0            0            0            0            0            0            0        0.307        7.653            0            0        0.524            0            0            0            0            0            0            0            0            0            0            0      163.479       44.558 
      CELL56            0            0            0            0            0            0            0            0            0            0        0.168        4.171            0            0        0.285            0            0            0            0            0            0            0            0            0            0            0     3897.516      716.699 
      CELL57            0            0            0            0            0            0            0            0            0            0        0.323        8.042            0            0         0.55            0            0            0            0            0            0            0            0            0            0            0     6115.194     1480.921 
      CELL58            0            0            0            0            0            0            0            0            0            0        0.337        8.384            0            0        0.574            0            0            0            0            0            0            0            0            0            0            0      6240.03     2935.973 
      CELL59            0            0            0            0            0            0            0            0            0            0        0.367        9.128            0            0        0.625            0            0            0            0            0            0            0            0            0            0            0     6266.353     2541.826 
      CELL60            0            0            0            0            0            0            0            0            0            0        0.371        9.223            0            0        0.633            0            0            0            0            0            0            0            0            0            0            0     6132.213     3687.238 
      CELL61            0            0            0            0            0            0            0            0            0            0         0.38        9.463            0            0         0.65            0            0            0            0            0            0            0            0            0            0            0      5775.53     3379.906 
      CELL62            0            0            0            0            0            0            0            0            0            0          0.4        9.962            0            0        0.685            0            0            0            0            0            0            0            0            0            0            0     6004.892     5455.931 
      CELL63            0            0            0            0            0            0            0            0            0            0        0.398        9.899            0            0        0.681            0            0            0            0            0            0            0            0            0            0            0     5971.165     4915.793 
      CELL64            0            0            0            0            0            0            0            0            0            0        0.409       10.195            0            0        0.701            0            0            0            0            0            0            0            0            0            0            0     5929.963     4135.857 
      CELL65            0            0            0            0            0            0            0            0            0            0         0.41        10.19            0            0        0.701            0            0            0            0            0            0            0            0            0            0            0     5654.052     4092.426 
      CELL66            0            0            0            0            0            0            0            0            0            0        0.431       10.738            0            0        0.738            0            0            0            0            0            0            0            0            0            0            0     5385.327     5099.357 
      CELL67            0            0            0            0            0            0            0            0            0            0        0.377        9.396            0            0        0.645            0            0            0            0            0            0            0            0            0            0            0     5203.028     5277.243 
      CELL68            0            0            0            0            0            0            0            0            0            0        0.411       10.229            0            0        0.703            0            0            0            0            0            0            0            0            0            0            0     2761.634      2842.52 
      CELL69            0            0            0            0            0            0            0            0            0            0        0.376        9.365            0            0        0.644            0            0            0            0            0            0            0            0            0            0            0     3643.171     3062.874 
      CELL70            0            0            0            0            0            0            0            0            0            0        0.388        9.648            0            0        0.663            0            0            0            0            0            0            0            0            0            0            0     5728.663     2568.236 
      CELL71            0            0            0            0            0            0            0            0            0            0        0.388         9.64            0            0        0.662            0            0            0            0            0            0            0            0            0            0            0     5506.014     2640.992 
      CELL72            0            0            0            0            0            0            0            0            0            0        0.389        9.665            0            0        0.663            0            0            0            0            0            0            0            0            0            0            0       220.74       78.663 
      CELL73            0            0            0            0            0            0            0            0            0            0        0.295        7.345            0            0        0.503            0            0            0            0            0            0            0            0            0            0            0     2165.299      309.719 
      CELL74            0            0            0            0            0            0            0            0            0            0        0.285         7.09            0            0        0.485            0            0            0            0            0            0            0            0            0            0            0     6097.951      980.024 
      CELL75            0            0            0            0            0            0            0            0            0            0         0.27        6.714            0            0        0.459            0            0            0            0            0            0            0            0            0            0            0     6355.778     2394.106 
      CELL76            0            0            0            0            0            0            0            0            0            0        0.276        6.858            0            0         0.47            0            0            0            0            0            0            0            0            0            0            0     6145.155     2962.559 
      CELL77            0            0            0            0            0            0            0            0            0            0        0.154        3.822            0            0        0.262            0            0            0            0            0            0            0            0            0            0            0     4165.378     1947.473 
      CELL78            0            0            0            0            0            0            0            0            0            0        0.266        6.613            0            0        0.454            0            0            0            0            0            0            0            0            0            0            0     5007.813     3170.871 
      CELL79            0            0            0            0            0            0            0            0            0            0        0.321        7.986            0            0        0.549            0            0            0            0            0            0            0            0            0            0            0     6065.665     4336.274 
      CELL80            0            0            0            0            0            0            0            0            0            0        0.348        8.658            0            0        0.596            0            0            0            0            0            0            0            0            0            0            0     5985.668     4671.136 
      CELL81            0            0            0            0            0            0            0            0            0            0        0.247         6.14            0            0        0.422            0            0            0            0            0            0            0            0            0            0            0     5138.901     2924.536 
      CELL82            0            0            0            0            0            0            0            0            0            0        0.399        9.922            0            0        0.683            0            0            0            0            0            0            0            0            0            0            0      6056.14     4455.963 
      CELL83            0            0            0            0            0            0            0            0            0            0         0.41       10.181            0            0        0.701            0            0            0            0            0            0            0            0            0            0            0     4414.011     3130.203 
      CELL84            0            0            0            0            0            0            0            0            0            0        0.414       10.304            0            0        0.709            0            0            0            0            0            0            0            0            0            0            0     3660.824     2731.821 
      CELL85            0            0            0            0            0            0            0            0            0            0         0.39        9.699            0            0        0.668            0            0            0            0            0            0            0            0            0            0            0     6341.569     6418.322 
      CELL86            0            0            0            0            0            0            0            0            0            0        0.398        9.887            0            0        0.681            0            0            0            0            0            0            0            0            0            0            0     5588.352     4197.398 
      CELL87            0            0            0            0            0            0            0            0            0            0        0.331        8.224            0            0        0.566            0            0            0            0            0            0            0            0            0            0            0     5831.992     3039.648 
      CELL88            0            0            0            0            0            0            0            0            0            0        0.407       10.119            0            0        0.696            0            0            0            0            0            0            0            0            0            0            0      5796.95     3799.638 
      CELL89            0            0            0            0            0            0            0            0            0            0        0.309        7.677            0            0        0.529            0            0            0            0            0            0            0            0            0            0            0     5466.422     2897.961 
      CELL90            0            0            0            0            0            0            0            0            0            0        0.315        7.817            0            0        0.538            0            0            0            0            0            0            0            0            0            0            0     2916.289      337.631 
      CELL91            0            0            0            0            0            0            0            0            0            0            0         6.52            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1610.735       304.12 
      CELL92            0            0            0            0            0            0            0            0            0            0        0.127        3.151            0            0        0.216            0            0            0            0            0            0            0            0            0            0            0     3050.052      684.775 
      CELL93            0            0            0            0            0            0            0            0            0            0        0.221        5.495            0            0        0.377            0            0            0            0            0            0            0            0            0            0            0     1292.761       365.33 
      CELL94            0            0            0            0            0            0            0            0            0            0        0.328        8.147            0            0        0.559            0            0            0            0            0            0            0            0            0            0            0       554.57      121.377 
      CELL95            0            0            0            0            0            0            0            0            0            0        0.251        6.243            0            0        0.429            0            0            0            0            0            0            0            0            0            0            0      4781.65     1843.868 
      CELL96            0            0            0            0            0            0            0            0            0            0        0.333        8.282            0            0         0.57            0            0            0            0            0            0            0            0            0            0            0     6255.937     4916.076 
      CELL97            0            0            0            0            0            0            0            0            0            0        0.373        9.269            0            0        0.639            0            0            0            0            0            0            0            0            0            0            0     5154.393     3943.184 
      CELL98            0            0            0            0            0            0            0            0            0            0        0.344        8.559            0            0         0.59            0            0            0            0            0            0            0            0            0            0            0      361.145      227.458 
      CELL99            0            0            0            0            0            0            0            0            0            0        0.393        9.771            0            0        0.674            0            0            0            0            0            0            0            0            0            0            0      4363.23     1996.729 
     CELL100            0            0            0            0            0            0            0            0            0            0        0.332        8.257            0            0        0.569            0            0            0            0            0            0            0            0            0            0            0      415.776      247.188 
     CELL101            0            0            0            0            0            0            0            0            0            0        0.375        9.319            0            0        0.642            0            0            0            0            0            0            0            0            0            0            0       848.68      581.953 
     CELL102            0            0            0            0            0            0            0            0            0            0        0.404       10.034            0            0        0.692            0            0            0            0            0            0            0            0            0            0            0     5392.157     3581.192 
     CELL103            0            0            0            0            0            0            0            0            0            0        0.381        9.455            0            0        0.652            0            0            0            0            0            0            0            0            0            0            0      5739.47     3345.072 
     CELL104            0            0            0            0            0            0            0            0            0            0        0.272        6.762            0            0        0.466            0            0            0            0            0            0            0            0            0            0            0      5739.75     3355.946 
     CELL105            0            0            0            0            0            0            0            0            0            0        0.315         7.81            0            0        0.539            0            0            0            0            0            0            0            0            0            0            0     5854.826     2992.905 
     CELL106            0            0            0            0            0            0            0            0            0            0         0.36        8.937            0            0        0.617            0            0            0            0            0            0            0            0            0            0            0     5826.073     3405.651 
     CELL107            0            0            0            0            0            0            0            0            0            0        0.364        9.033            0            0        0.624            0            0            0            0            0            0            0            0            0            0            0     3831.586        782.6 
     CELL108            0            0            0            0            0            0            0            0            0            0        0.084        2.094            0            0        0.144            0            0            0            0            0            0            0            0            0            0            0     5301.561     1883.745 
     CELL109            0            0            0            0            0            0            0            0            0            0        0.143        3.562            0            0        0.245            0            0            0            0            0            0            0            0            0            0            0     6551.792     4615.962 
     CELL110            0            0            0            0            0            0            0            0            0            0        0.331        8.213            0            0        0.566            0            0            0            0            0            0            0            0            0            0            0     1408.671     1178.246 
     CELL111            0            0            0            0            0            0            0            0            0            0        0.364         9.02            0            0        0.623            0            0            0            0            0            0            0            0            0            0            0     2506.298     1434.391 
     CELL112            0            0            0            0            0            0            0            0            0            0        0.334         8.29            0            0        0.573            0            0            0            0            0            0            0            0            0            0            0     5488.383     3102.553 
     CELL113            0            0            0            0            0            0            0            0            0            0        0.301         7.47            0            0        0.516            0            0            0            0            0            0            0            0            0            0            0     5584.416     3609.136 
     CELL114            0            0            0            0            0            0            0            0            0            0        0.283        7.008            0            0        0.484            0            0            0            0            0            0            0            0            0            0            0     5735.873     3158.305 
     CELL115            0            0            0            0            0            0            0            0            0            0        0.308        7.629            0            0        0.527            0            0            0            0            0            0            0            0            0            0            0     5513.437     1676.368 
     CELL116            0            0            0            0            0            0            0            0            0            0        0.336        8.328            0            0        0.574            0            0            0            0            0            0            0            0            0            0            0     5252.702      590.671 
     CELL117            0            0            0            0            0            0            0            0            0            0        0.334        8.267            0            0        0.569            0            0            0            0            0            0            0            0            0            0            0      343.732       56.903 
     CELL118            0            0            0            0            0            0            0            0            0            0        0.263        6.526            0            0        0.448            0            0            0            0            0            0            0            0            0            0            0      505.401       80.937 
     CELL119            0            0            0            0            0            0            0            0            0            0        0.218        5.403            0            0        0.371            0            0            0            0            0            0            0            0            0            0            0     6320.277     2399.177 
     CELL120            0            0            0            0            0            0            0            0            0            0        0.098         2.43            0            0        0.167            0            0            0            0            0            0            0            0            0            0            0     6599.759     4548.806 
     CELL121            0            0            0            0            0            0            0            0            0            0        0.161        3.988            0            0        0.275            0            0            0            0            0            0            0            0            0            0            0       5979.1     3445.591 
     CELL122            0            0            0            0            0            0            0            0            0            0        0.321        7.949            0            0        0.549            0            0            0            0            0            0            0            0            0            0            0      255.183      145.755 
     CELL123            0            0            0            0            0            0            0            0            0            0         0.36        8.924            0            0        0.617            0            0            0            0            0            0            0            0            0            0            0      448.658      253.213 
     CELL124            0            0            0            0            0            0            0            0            0            0            0        8.275            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1586.48      556.913 
     CELL125            0            0            0            0            0            0            0            0            0            0        0.221         5.46            0            0        0.378            0            0            0            0            0            0            0            0            0            0            0     3425.997     1194.243 
     CELL126            0            0            0            0            0            0            0            0            0            0         0.34        8.425            0            0        0.581            0            0            0            0            0            0            0            0            0            0            0     3385.666      411.138 
     CELL127            0            0            0            0            0            0            0            0            0            0        0.215        5.311            0            0        0.366            0            0            0            0            0            0            0            0            0            0            0     1001.979      129.705 
     CELL128            0            0            0            0            0            0            0            0            0            0        0.087        2.161            0            0        0.148            0            0            0            0            0            0            0            0            0            0            0      513.466       56.423 
     CELL129            0            0            0            0            0            0            0            0            0            0        0.161        3.985            0            0        0.274            0            0            0            0            0            0            0            0            0            0            0     3470.619     1409.834 
     CELL130            0            0            0            0            0            0            0            0            0            0        0.268        6.656            0            0        0.458            0            0            0            0            0            0            0            0            0            0            0     4948.506     2906.737 
     CELL131            0            0            0            0            0            0            0            0            0            0        0.169        4.182            0            0        0.289            0            0            0            0            0            0            0            0            0            0            0      3960.24     1725.816 
     CELL132            0            0            0            0            0            0            0            0            0            0        0.295         7.32            0            0        0.506            0            0            0            0            0            0            0            0            0            0            0      127.867       64.995 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0           42         1060            0            0       71.815            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
