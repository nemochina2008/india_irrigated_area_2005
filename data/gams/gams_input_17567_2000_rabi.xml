<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CROP27, CROP28, CROP29, CROP30, CROP31, CROP32, CROP33, CROP34, CROP35, CROP36, CROP37, CROP38, CROP39, CROP40, CROP41, CROP42, CROP43, CROP44, CROP45, CROP46, CROP47, CROP48, CROP49, CROP50, CROP51, CROP52, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CROP27, CROP28, CROP29, CROP30, CROP31, CROP32, CROP33, CROP34, CROP35, CROP36, CROP37, CROP38, CROP39, CROP40, CROP41, CROP42, CROP43, CROP44, CROP45, CROP46, CROP47, CROP48, CROP49, CROP50, CROP51, CROP52 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25, CROP27, CROP29, CROP31, CROP33, CROP35, CROP37, CROP39, CROP41, CROP43, CROP45, CROP47, CROP49, CROP51 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26       CROP27       CROP28       CROP29       CROP30       CROP31       CROP32       CROP33       CROP34       CROP35       CROP36       CROP37       CROP38       CROP39       CROP40       CROP41       CROP42       CROP43       CROP44       CROP45       CROP46       CROP47       CROP48       CROP49       CROP50       CROP51       CROP52    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        10.37            0            0            0            0            0        0.074            0            0            0            0            0            0            0            0            0         0.54            0            0      761.516      420.399 
       CELL2            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.919            0            0            0            0            0        0.063            0            0            0            0            0            0            0            0            0        0.455            0            0       26.338       14.567 
       CELL3            0            0            0            0            0            0            0            0            0            0       36.339            0            0            0        14.18            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       15.235       16.954            0            0            0            0        0.108            0            0            0            0            0            0            0            0        2.437        0.772            0            0      418.052      237.455 
       CELL4            0            0            0         0.83            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      557.168            0            0            0            0            0            0            0            0            0        2.736            0            0            0        40.34            0        0.019            0            0            0            0            0            0            0            0            0        0.154            0            0       680.01      375.879 
       CELL5            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0         8.73            0            0            0            0            0        0.061            0            0            0            0            0            0            0            0            0        0.455            0            0     1490.118      877.315 
       CELL6            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        8.117            0            0            0            0            0        0.058            0            0            0            0            0            0            0            0            0        0.412            0            0      488.419      359.766 
       CELL7            0            0            0        3.014            0            0            0            0            0            0       27.628            0            0            0       10.523            0            0            0            0            0            0            0            0     2023.187            0            0            0            0            0            0        0.289            0            0       11.273       12.726            0       46.744      138.655            0        0.078            0            0            0            0            0            0            0            0        1.847        0.604            0            0      475.551      199.132 
       CELL8            0            0            0        2.438            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1636.507            0            0            0            0            0            0            0            0            0        8.854            0            0            0      114.071            0        0.062            0            0            0            0            0            0            0            0            0         0.48            0            0      942.142      323.135 
       CELL9            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       14.724            0            0            0            0            0        0.105            0            0            0            0            0            0            0            0            0        0.737            0            0      1437.87      886.003 
      CELL10            0            0            0        1.175            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      788.756            0            0            0            0            0            0            0            0            0        5.815            0            0            0            0            0        0.041            0            0            0            0            0            0            0            0            0        0.307            0            0      795.745      820.372 
      CELL11            0            0            0            0            0            0            0            0            0            0       37.532            0            0            0       14.514            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       15.562        17.42            0            0            0            0         0.11            0            0            0            0            0            0            0            0        2.508        0.799            0            0     1810.871     1293.507 
      CELL12            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0         9.79            0            0            0            0            0        0.069            0            0            0            0            0            0            0            0            0        0.497            0            0     1598.216     1389.607 
      CELL13            0            0            0            0            0            0            0            0            0            0        28.88            0            0            0       11.222            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       12.061       13.458            0            0            0            0        0.085            0            0            0            0            0            0            0            0        1.935        0.616            0            0      188.242      238.261 
      CELL14            0            0            0            0            0            0            0            0            0            0       47.954            0            0            0        18.82            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       20.199       22.478            0            0            0            0        0.143            0            0            0            0            0            0            0            0         3.22        1.005            0            0      4537.62     4205.516 
      CELL15            0            0            0            0            0            0            0            0            0            0       41.662            0            0            0       16.317            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       17.499       19.496            0            0            0            0        0.124            0            0            0            0            0            0            0            0         2.79        0.874            0            0     3490.744     3076.862 
      CELL16            0            0            0            0            0            0            0            0            0            0       28.569            0            0            0       11.072            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       11.869       13.285            0            0            0            0        0.084            0            0            0            0            0            0            0            0        1.912        0.606            0            0     1404.381     1413.758 
      CELL17            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       16.161            0            0            0            0            0        0.114            0            0            0            0            0            0            0            0            0        0.828            0            0     3313.914     3381.006 
      CELL18            0            0            0        2.796            0            0            0            0            0            0       26.321            0            0            0       10.005            0            0            0            0            0            0            0            0     1876.578            0            0            0            0            0            0        0.274            0            0       10.637       12.068            0       44.391      133.783            0        0.074            0            0            0            0            0            0            0            0        1.754        0.574            0            0     1460.001      903.674 
      CELL19            0            0            0        4.189            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2811.932            0            0            0            0            0            0            0            0            0       10.886            0            0            0      215.955            0        0.073            0            0            0            0            0            0            0            0            0         0.66            0            0      186.071       16.025 
      CELL20            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       18.565            0            0            0            0            0        0.129            0            0            0            0            0            0            0            0            0        0.982            0            0       91.138       27.031 
      CELL21            0            0            0            0            0            0            0            0            0            0       41.756            0            0            0       16.269            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       17.485       19.501            0            0            0            0        0.123            0            0            0            0            0            0            0            0        2.795        0.885            0            0     1165.493      424.033 
      CELL22            0            0            0            0            0            0            0            0            0            0       51.723            0            0            0       20.275            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       21.773       24.213            0            0            0            0        0.155            0            0            0            0            0            0            0            0        3.468        1.087            0            0     3320.652     2667.944 
      CELL23            0            0            0            0            0            0            0            0            0            0       44.149            0            0            0       17.339            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       18.607       20.704            0            0            0            0        0.132            0            0            0            0            0            0            0            0        2.957        0.916            0            0     5847.583     5183.561 
      CELL24            0            0            0            0            0            0            0            0            0            0       34.742            0            0            0       13.639            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       14.619       16.286            0            0            0            0        0.104            0            0            0            0            0            0            0            0        2.325         0.72            0            0     5769.446     5220.334 
      CELL25            0            0            0            0            0            0            0            0            0            0       23.054            0            0            0        9.023            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        9.666       10.781            0            0            0            0        0.069            0            0            0            0            0            0            0            0        1.542        0.483            0            0     2782.982     2823.679 
      CELL26            0            0            0        3.866            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2595.389            0            0            0            0            0            0            0            0            0       18.115            0            0            0            0            0        0.128            0            0            0            0            0            0            0            0            0        0.962            0            0        604.9      646.291 
      CELL27            0            0            0        2.298            0            0            0            0            0            0       20.661            0            0            0        7.823            0            0            0            0            0            0            0            0     1542.286            0            0            0            0            0            0        0.223            0            0        8.286        9.441            0       36.196      111.134            0        0.058            0            0            0            0            0            0            0            0        1.381        0.456            0            0      119.928      119.928 
      CELL28            0            0            0        8.837            0            0            0            0         1544            0       51.475            0            0            0       18.493            0            0            0            0            0            0            0            0     5931.895            0            0            0            0            0            0        0.653            0            0       19.975       23.459            0      105.756      433.283            0        0.133            0            0            0            0            0            0            0            0        3.541        1.212            0            0      286.733       15.602 
      CELL29            0            0            0        2.924            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1963.068            0            0            0            0            0            0            0            0            0         9.76            0            0            0      144.062            0        0.066            0            0            0            0            0            0            0            0            0        0.556            0            0      980.845      230.249 
      CELL30            0            0            0            0            0            0            0            0            0            0       40.347            0            0            0       15.856            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       17.023       18.935            0            0            0            0        0.121            0            0            0            0            0            0            0            0        2.705        0.846            0            0     3244.614     2542.667 
      CELL31            0            0            0            0            0            0            0            0            0            0       47.264            0            0            0       18.592            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       19.968       22.196            0            0            0            0        0.142            0            0            0            0            0            0            0            0         3.17        0.983            0            0     5947.312     4992.057 
      CELL32            0            0            0            0            0            0            0            0            0            0       54.569            0            0            0       21.449            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       23.024       25.603            0            0            0            0        0.163            0            0            0            0            0            0            0            0        3.655         1.13            0            0     6048.566     4872.997 
      CELL33            0            0            0            0            0            0            0            0            0            0       48.376            0            0            0       19.027            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       20.405       22.712            0            0            0            0        0.145            0            0            0            0            0            0            0            0        3.241        0.991            0            0     5811.065     4656.856 
      CELL34            0            0            0            0            0            0            0            0            0            0       44.979            0            0            0       17.681            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       18.932       21.109            0            0            0            0        0.135            0            0            0            0            0            0            0            0         3.01         0.92            0            0     2691.988     1485.622 
      CELL35            0            0            0        6.853            0            0            0            0            0            0       45.196            0            0            0       16.503            0            0            0            0            0            0            0            0     4600.353            0            0            0            0            0            0        0.561            0            0       17.632       20.654            0       90.913      354.466            0        0.118            0            0            0            0            0            0            0            0        3.081        1.069            0            0      1019.84       69.224 
      CELL36            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       16.403            0            0            0            0            0        0.114            0            0            0            0            0            0            0            0            0        0.834            0            0     2936.781     2160.931 
      CELL37            0            0            0            0            0            0            0            0            0            0       43.236            0            0            0       16.986            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       18.237       20.282            0            0            0            0        0.129            0            0            0            0            0            0            0            0        2.898        0.907            0            0     5249.463     3192.371 
      CELL38            0            0            0            0            0            0            0            0            0            0       55.076            0            0            0       21.545            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        23.14       25.805            0            0            0            0        0.163            0            0            0            0            0            0            0            0        3.696        1.156            0            0     5279.397     2655.694 
      CELL39            0            0            0            0            0            0            0            0            0            0       61.554            0            0            0        24.13            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.886       28.896            0            0            0            0        0.182            0            0            0            0            0            0            0            0        4.124        1.268            0            0     5446.081     4050.511 
      CELL40            0            0            0            0            0            0            0            0            0            0       55.059            0            0            0       21.652            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       23.194       25.845            0            0            0            0        0.165            0            0            0            0            0            0            0            0        3.687        1.127            0            0     5893.968     5988.765 
      CELL41            0            0            0            0            0            0            0            0            0            0       56.962            0            0            0       22.409            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       23.986       26.749            0            0            0            0         0.17            0            0            0            0            0            0            0            0        3.814        1.155            0            0     1957.415     1369.716 
      CELL42            0            0            0        5.942            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3988.766            0            0            0            0            0            0            0            0            0       17.378            0            0            0      305.427            0        0.117            0            0            0            0            0            0            0            0            0        1.044            0            0      667.628      437.824 
      CELL43            0            0            0            0            0            0            0            0            0            0       51.248            0            0            0       19.819            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       21.263       23.923            0            0            0            0        0.147            0            0            0            0            0            0            0            0        3.428        1.089            0            0     3180.179      892.933 
      CELL44            0            0            0            0            0            0            0            0            0            0       60.133            0            0            0       23.563            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.288       28.222            0            0            0            0        0.178            0            0            0            0            0            0            0            0         4.03        1.256            0            0     5371.682     3300.018 
      CELL45            0            0            0            0            0            0            0            0            0            0       61.291            0            0            0        24.02            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.772       28.764            0            0            0            0        0.181            0            0            0            0            0            0            0            0        4.104        1.271            0            0     4828.125     3475.067 
      CELL46            0            0            0            0            0            0            0            0            0            0        58.94            0            0            0       23.185            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       24.841        27.67            0            0            0            0        0.176            0            0            0            0            0            0            0            0        3.948        1.208            0            0     5660.963      5762.12 
      CELL47            0            0            0            0            0            0            0            0            0            0       29.398            0            0            0       11.565            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        12.38       13.803            0            0            0            0        0.088            0            0            0            0            0            0            0            0        1.968          0.6            0            0     5862.825     5914.644 
      CELL48            0            0            0            0            0            0            0            0            0            0       61.909            0            0            0        24.35            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       26.043       29.063            0            0            0            0        0.185            0            0            0            0            0            0            0            0        4.142        1.252            0            0     3600.301     3705.881 
      CELL49            0            0            0            0            0            0            0            0            0            0       26.995            0            0            0       10.613            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       11.348       12.669            0            0            0            0        0.081            0            0            0            0            0            0            0            0        1.805        0.545            0            0      518.725      566.083 
      CELL50            0            0            0        5.292            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     3552.676            0            0            0            0            0            0            0            0            0       18.703            0            0            0      254.125            0        0.127            0            0            0            0            0            0            0            0            0        1.044            0            0     1121.266      421.141 
      CELL51            0            0            0            0            0            0            0            0            0            0       46.626            0            0            0       18.109            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       19.408       21.847            0            0            0            0        0.134            0            0            0            0            0            0            0            0        3.121        0.981            0            0     5137.066     2610.629 
      CELL52            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       20.964            0            0            0            0            0        0.148            0            0            0            0            0            0            0            0            0        1.057            0            0     4695.983     3172.319 
      CELL53            0            0            0            0            0            0            0            0            0            0       66.083            0            0            0        25.97            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.832           31            0            0            0            0        0.198            0            0            0            0            0            0            0            0        4.422        1.368            0            0     5443.868     4822.811 
      CELL54            0            0            0            0            0            0            0            0            0            0       58.971            0            0            0        23.19            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       24.827       27.673            0            0            0            0        0.176            0            0            0            0            0            0            0            0        3.947        1.209            0            0     5882.811     5983.913 
      CELL55            0            0            0            0            0            0            0            0            0            0       61.883            0            0            0       24.283            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       25.977       28.985            0            0            0            0        0.184            0            0            0            0            0            0            0            0        4.133         1.28            0            0     4395.719     4012.735 
      CELL56            0            0            0            0            0            0            0            0            0            0        65.48            0            0            0       25.694            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.493       30.672            0            0            0            0        0.195            0            0            0            0            0            0            0            0        4.373        1.355            0            0     3639.859     3750.406 
      CELL57            0            0            0        3.432            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      2303.72            0            0            0            0            0            0            0            0            0       10.351            0            0            0      177.454            0         0.07            0            0            0            0            0            0            0            0            0        0.621            0            0      150.516      150.516 
      CELL58            0            0            0        6.095            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     4091.173            0            0            0            0            0            0            0            0            0       22.095            0            0            0      274.692            0        0.151            0            0            0            0            0            0            0            0            0        1.217            0            0     1748.314      127.617 
      CELL59            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       23.613            0            0            0            0            0        0.166            0            0            0            0            0            0            0            0            0        1.181            0            0     3006.906      1248.74 
      CELL60            0            0            0            0            0            0            0            0            0            0       53.906            0            0            0       21.247            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       22.747       25.352            0            0            0            0        0.162            0            0            0            0            0            0            0            0        3.607         1.09            0            0     5411.367     5504.429 
      CELL61            0            0            0            0            0            0            0            0            0            0        65.63            0            0            0       25.864            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       27.661       30.858            0            0            0            0        0.196            0            0            0            0            0            0            0            0        4.388        1.311            0            0     6562.043     6673.972 
      CELL62            0            0            0            0            0            0            0            0            0            0       75.477            0            0            0       29.648            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       31.709       35.383            0            0            0            0        0.225            0            0            0            0            0            0            0            0         5.04        1.553            0            0      387.464      487.177 
      CELL63            0            0            0       11.019            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     7396.545            0            0            0            0            0            0            0            0            0        30.09            0            0            0      567.552            0          0.2            0            0            0            0            0            0            0            0            0        1.822            0            0        69.97       58.603 
      CELL64            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.563            0            0            0            0            0        0.206            0            0            0            0            0            0            0            0            0        1.504            0            0      111.373      112.083 
      CELL65            0            0            0            0            0            0            0            0            0            0       52.902            0            0            0       20.688            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       22.141       24.707            0            0            0            0        0.157            0            0            0            0            0            0            0            0        3.536        1.116            0            0      968.727      575.441 
      CELL66            0            0            0            0            0            0            0            0            0            0       75.649            0            0            0       29.847            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       31.903         35.6            0            0            0            0        0.227            0            0            0            0            0            0            0            0        5.058        1.502            0            0     4819.329      4192.89 
      CELL67            0            0            0            0            0            0            0            0            0            0       67.351            0            0            0       26.585            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       28.429        31.71            0            0            0            0        0.202            0            0            0            0            0            0            0            0        4.483        1.325            0            0     5324.797     4898.061 
      CELL68            0            0            0            0            0            0            0            0            0            0       76.957            0            0            0       30.311            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.383       36.159            0            0            0            0         0.23            0            0            0            0            0            0            0            0        5.137        1.542            0            0     2793.596     2693.674 
      CELL69            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       33.339            0            0            0            0            0        0.237            0            0            0            0            0            0            0            0            0        1.603            0            0      360.935      491.815 
      CELL70            0            0            0            0            0            0            0            0            0            0       79.084            0            0            0       30.956            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       33.078       37.072            0            0            0            0        0.233            0            0            0            0            0            0            0            0        5.284        1.644            0            0      388.518      518.473 
      CELL71            0            0            0            0            0            0            0            0            0            0       43.945            0            0            0       17.319            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        18.52       20.661            0            0            0            0        0.131            0            0            0            0            0            0            0            0        2.938        0.889            0            0      354.683      258.995 
      CELL72            0            0            0            0            0            0            0            0            0            0       59.094            0            0            0       23.337            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       24.952       27.828            0            0            0            0        0.177            0            0            0            0            0            0            0            0        3.934        1.159            0            0     5256.365     5357.947 
      CELL73            0            0            0            0            0            0            0            0            0            0       80.875            0            0            0       31.923            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.097       38.068            0            0            0            0        0.242            0            0            0            0            0            0            0            0        5.365        1.578            0            0     5369.057      5505.03 
      CELL74            0            0            0            0            0            0            0            0            0            0        82.95            0            0            0       32.754            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.954       39.063            0            0            0            0        0.248            0            0            0            0            0            0            0            0        5.487        1.597            0            0      5361.31     5500.429 
      CELL75            0            0            0            0            0            0            0            0            0            0       62.103            0            0            0       24.462            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        26.08        29.18            0            0            0            0        0.185            0            0            0            0            0            0            0            0         4.13        1.224            0            0       3696.7     3310.493 
      CELL76            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.951            0            0            0            0            0        0.213            0            0            0            0            0            0            0            0            0        1.407            0            0       126.85      229.975 
      CELL77            0            0            0            0            0            0            0            0            0            0       82.588            0            0            0       32.647            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.904       38.927            0            0            0            0        0.248            0            0            0            0            0            0            0            0        5.492        1.618            0            0      1658.89     1795.492 
      CELL78            0            0            0            0            0            0            0            0            0            0       68.742            0            0            0       27.216            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       29.076       32.439            0            0            0            0        0.206            0            0            0            0            0            0            0            0        4.542        1.306            0            0     3411.214     3526.876 
      CELL79            0            0            0            0            0            0            0            0            0            0       72.202            0            0            0       28.578            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       30.508        34.06            0            0            0            0        0.216            0            0            0            0            0            0            0            0        4.766        1.359            0            0     5718.696     5841.355 
      CELL80            0            0            0            0            0            0            0            0            0            0       86.234            0            0            0       34.069            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.334       40.618            0            0            0            0        0.258            0            0            0            0            0            0            0            0        5.694        1.649            0            0     5089.222     5232.504 
      CELL81            0            0            0            0            0            0            0            0            0            0       78.111            0            0            0       30.862            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.899         36.8            0            0            0            0        0.233            0            0            0            0            0            0            0            0        5.144        1.475            0            0     4224.763      3057.59 
      CELL82            0            0            0            0            0            0            0            0            0            0       73.227            0            0            0       28.883            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       30.764       34.447            0            0            0            0        0.218            0            0            0            0            0            0            0            0         4.84        1.404            0            0     4417.066      3947.16 
      CELL83            0            0            0            0            0            0            0            0            0            0        76.81            0            0            0       30.304            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.263       36.146            0            0            0            0        0.229            0            0            0            0            0            0            0            0        5.064        1.454            0            0     1834.409     1574.117 
      CELL84            0            0            0            0            0            0            0            0            0            0       40.775            0            0            0       16.039            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       17.135       19.191            0            0            0            0        0.121            0            0            0            0            0            0            0            0        2.719        0.816            0            0     1228.771      1299.19 
      CELL85            0            0            0            0            0            0            0            0            0            0       83.624            0            0            0       33.148            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       35.407        39.48            0            0            0            0        0.251            0            0            0            0            0            0            0            0        5.514        1.569            0            0     4387.003     3711.701 
      CELL86            0            0            0            0            0            0            0            0            0            0       77.775            0            0            0       30.819            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.883       36.723            0            0            0            0        0.233            0            0            0            0            0            0            0            0        5.116         1.44            0            0      5450.76     4537.531 
      CELL87            0            0            0            0            0            0            0            0            0            0       86.462            0            0            0       34.271            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.527       40.837            0            0            0            0        0.259            0            0            0            0            0            0            0            0        5.654        1.584            0            0     4418.965      4561.26 
      CELL88            0            0            0            0            0            0            0            0            0            0       85.937            0            0            0       33.994            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0        36.22       40.515            0            0            0            0        0.257            0            0            0            0            0            0            0            0        5.647          1.6            0            0     3645.631     3786.859 
      CELL89            0            0            0            0            0            0            0            0            0            0       71.762            0            0            0         28.4            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       30.252       33.855            0            0            0            0        0.215            0            0            0            0            0            0            0            0        4.698        1.315            0            0      5829.83     5951.527 
      CELL90            0            0            0            0            0            0            0            0            0            0       82.868            0            0            0       32.789            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.899       39.089            0            0            0            0        0.248            0            0            0            0            0            0            0            0        5.424        1.509            0            0     5394.902     5533.815 
      CELL91            0            0            0            0            0            0            0            0            0            0       74.177            0            0            0       29.294            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       31.185       34.932            0            0            0            0        0.221            0            0            0            0            0            0            0            0        4.868        1.381            0            0      3460.99     1695.425 
      CELL92            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       33.041            0            0            0            0            0        0.233            0            0            0            0            0            0            0            0            0        1.499            0            0      205.176      205.951 
      CELL93            0            0            0            0            0            0            0            0            0            0       81.247            0            0            0        32.18            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       34.375       38.342            0            0            0            0        0.244            0            0            0            0            0            0            0            0        5.367         1.55            0            0     3797.395     3932.128 
      CELL94            0            0            0            0            0            0            0            0            0            0       80.393            0            0            0        31.82            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       33.966       37.914            0            0            0            0        0.241            0            0            0            0            0            0            0            0        5.305        1.525            0            0     4938.619     4696.029 
      CELL95            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.595            0            0            0            0            0        0.267            0            0            0            0            0            0            0            0            0         1.68            0            0     4520.381     2763.123 
      CELL96            0            0            0            0            0            0            0            0            0            0       79.683            0            0            0       31.578            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       33.622       37.627            0            0            0            0        0.239            0            0            0            0            0            0            0            0        5.206        1.451            0            0     1207.961     1166.505 
      CELL97            0            0            0            0            0            0            0            0            0            0       89.458            0            0            0       35.487            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.774       42.283            0            0            0            0        0.268            0            0            0            0            0            0            0            0        5.793        1.594            0            0     1100.772     1138.719 
      CELL98            0            0            0            0            0            0            0            0            0            0       89.472            0            0            0       35.474            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       37.749       42.266            0            0            0            0        0.268            0            0            0            0            0            0            0            0        5.824        1.607            0            0      4399.22     3433.609 
      CELL99            0            0            0            0            0            0            0            0            0            0       77.036            0            0            0       30.544            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       32.509       36.392            0            0            0            0        0.231            0            0            0            0            0            0            0            0        5.015        1.385            0            0     3096.388      510.174 
     CELL100            0            0            0            0            0            0            0            0            0            0       73.165            0            0            0       28.976            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       30.887       34.518            0            0            0            0        0.219            0            0            0            0            0            0            0            0        4.802        1.369            0            0     2407.616     2212.162 
     CELL101            0            0            0            0            0            0            0            0            0            0       87.353            0            0            0        34.61            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       36.836       41.229            0            0            0            0        0.261            0            0            0            0            0            0            0            0         5.72        1.604            0            0     2368.678     2319.451 
     CELL102            0            0            0            0            0            0            0            0            0            0       93.313            0            0            0       37.005            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       39.377       44.087            0            0            0            0        0.279            0            0            0            0            0            0            0            0        6.047        1.674            0            0      324.973      383.789 
     CELL103            0            0            0            0            0            0            0            0            0            0       91.643            0            0            0       36.368            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       38.716       43.293            0            0            0            0        0.275            0            0            0            0            0            0            0            0        5.919        1.639            0            0       61.582       62.452 
    TOTAL_AR            0            0            0           71            0            0            0            0         1544            0         4604            0            0            0         1810            0            0            0            0            0            0            0            0        47660            0            0            0            0            0            0            2            0            0         2409         2163            0          324         3265            0           17            0            0            0            0            0            0            0            0      305.479      115.521            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
