<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CROP27, CROP28, CROP29, CROP30, CROP31, CROP32, CROP33, CROP34, CROP35, CROP36, CROP37, CROP38, CROP39, CROP40, CROP41, CROP42, CROP43, CROP44, CROP45, CROP46, CROP47, CROP48, CROP49, CROP50, CROP51, CROP52, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CROP27, CROP28, CROP29, CROP30, CROP31, CROP32, CROP33, CROP34, CROP35, CROP36, CROP37, CROP38, CROP39, CROP40, CROP41, CROP42, CROP43, CROP44, CROP45, CROP46, CROP47, CROP48, CROP49, CROP50, CROP51, CROP52 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25, CROP27, CROP29, CROP31, CROP33, CROP35, CROP37, CROP39, CROP41, CROP43, CROP45, CROP47, CROP49, CROP51 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26       CROP27       CROP28       CROP29       CROP30       CROP31       CROP32       CROP33       CROP34       CROP35       CROP36       CROP37       CROP38       CROP39       CROP40       CROP41       CROP42       CROP43       CROP44       CROP45       CROP46       CROP47       CROP48       CROP49       CROP50       CROP51       CROP52    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0        2.818            0       20.701            0            0            0        0.037            0            0            0            0            0        0.006            0            0            0            0            0            0            0            0            0            0            0            0        8.957        3.724            0            0            0            0        0.186            0            0            0            0            0            0            0            0         3.02        0.468            0            0     1716.968      1786.64 
       CELL2            0            0            0            0            0            0            0            0        6.917            0       50.877            0            0            0        0.091            0            0            0            0            0        0.014            0            0            0            0            0            0            0            0            0            0            0            0       21.959        9.148            0            0            0            0        0.456            0            0            0            0            0            0            0            0        7.413        1.141            0            0     2153.354     2312.478 
       CELL3            0            0            0            0            0            0            0            0        6.495            0       47.147            0            0            0        0.085            0            0            0            0            0        0.013            0            0            0            0            0            0            0            0            0            0            0            0       20.848        8.544            0            0            0            0        0.433            0            0            0            0            0            0            0            0        6.971         1.14            0            0        64.07       56.226 
       CELL4            0            0            0            0            0            0            0            0        3.469            0       25.889            0            0            0        0.046            0            0            0            0            0        0.007            0            0            0            0            0            0            0            0            0            0            0            0       11.114        4.627            0            0            0            0        0.229            0            0            0            0            0            0            0            0        3.795        0.624            0            0       24.825       25.057 
       CELL5            0            0            0            0            0            0            0            0        1.879            0        13.83            0            0            0        0.025            0            0            0            0            0        0.004            0            0            0            0            0            0            0            0            0            0            0            0        5.986        2.486            0            0            0            0        0.124            0            0            0            0            0            0            0            0        2.023        0.323            0            0     2039.911     2087.176 
       CELL6            0            0            0            0            0            0            0            0        6.216            0       45.771            0            0            0        0.082            0            0            0            0            0        0.012            0            0            0            0            0            0            0            0            0            0            0            0       19.796        8.229            0            0            0            0        0.411            0            0            0            0            0            0            0            0        6.691        1.055            0            0     2127.195     1882.989 
       CELL7            0            0            0            0            0            0            0            0        1.933            0       14.226            0            0            0        0.026            0            0            0            0            0        0.004            0            0            0            0            0            0            0            0            0            0            0            0        6.147        2.558            0            0            0            0        0.128            0            0            0            0            0            0            0            0        2.073        0.323            0            0     2605.582     2222.903 
       CELL8            0            0            0            0            0            0            0            0        4.718            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      110.312       11.523 
       CELL9            0            0            0            0            0            0            0            0        4.783            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0            0            0            0            0            0            0            0            0            0            0       15.514            0            0            0            0            0        0.322            0            0            0            0            0            0            0            0            0        0.871            0            0        66.15       56.335 
      CELL10            0            0            0            0            0            0            0            0        6.459            0       46.845            0            0            0        0.085            0            0            0            0            0        0.013            0            0            0            0            0            0            0            0            0            0            0            0       20.706        8.493            0            0            0            0         0.43            0            0            0            0            0            0            0            0        6.927        1.128            0            0      2353.82     2339.708 
      CELL11            0            0            0            0            0            0            0            0        0.923            0        6.782            0            0            0        0.012            0            0            0            0            0        0.002            0            0            0            0            0            0            0            0            0            0            0            0        2.939         1.22            0            0            0            0        0.061            0            0            0            0            0            0            0            0        0.993         0.16            0            0     1068.397     1091.955 
      CELL12            0            0            0            0            0            0            0            0        3.671            0       26.991            0            0            0        0.049            0            0            0            0            0        0.007            0            0            0            0            0            0            0            0            0            0            0            0       11.692        4.857            0            0            0            0        0.243            0            0            0            0            0            0            0            0        3.942        0.628            0            0      3909.95     3999.641 
      CELL13            0            0            0            0            0            0            0            0        3.527            0        25.99            0            0            0        0.047            0            0            0            0            0        0.007            0            0            0            0            0            0            0            0            0            0            0            0       11.247        4.673            0            0            0            0        0.234            0            0            0            0            0            0            0            0        3.801        0.602            0            0     2565.199     1601.487 
      CELL14            0            0            0            0            0            0            0            0        4.808            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1382.626      204.554 
      CELL15            0            0            0            0            0            0            0            0        5.173            0       39.515            0            0            0         0.07            0            0            0            0            0         0.01            0            0    21845.272            0            0            0            0            0            0            0            0            0       16.858        7.018            0            0      2101.38            0        0.343            0            0            0            0            0            0            0            0        5.821        1.005            0            0     1491.065      922.901 
      CELL16            0            0            0            0            0            0            0            0        8.766            0       63.525            0            0            0        0.115            0            0            0            0            0        0.017            0            0            0            0            0            0            0            0            0            0            0            0       28.033       11.517            0            0            0            0        0.582            0            0            0            0            0            0            0            0        9.365        1.517            0            0      259.099      305.586 
      CELL17            0            0            0            0            0            0            0            0        3.972            0       29.515            0            0            0        0.053            0            0            0            0            0        0.008            0            0            0            0            0            0            0            0            0            0            0            0       12.716        5.288            0            0            0            0        0.262            0            0            0            0            0            0            0            0        4.324        0.712            0            0      701.952      798.842 
      CELL18            0            0            0            0            0            0            0            0        6.803            0       49.864            0            0            0         0.09            0            0            0            0            0        0.013            0            0            0            0            0            0            0            0            0            0            0            0       21.654        8.984            0            0            0            0        0.449            0            0            0            0            0            0            0            0        7.298        1.159            0            0     3450.162     3607.747 
      CELL19            0            0            0            0            0            0            0            0        6.774            0        49.63            0            0            0        0.089            0            0            0            0            0        0.013            0            0            0            0            0            0            0            0            0            0            0            0       21.482        8.944            0            0            0            0        0.442            0            0            0            0            0            0            0            0        7.255        1.138            0            0     4705.954     4862.438 
      CELL20            0            0            0            0            0            0            0            0         5.09            0            0            0            0            0            0            0            0            0            0            0         0.01            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1394.638      975.084 
      CELL21            0            0            0            0            0            0            0            0        4.755            0       34.611            0            0            0        0.063            0            0            0            0            0        0.009            0            0            0            0            0            0            0            0            0            0            0            0       15.318        6.269            0            0            0            0        0.318            0            0            0            0            0            0            0            0        5.116        0.846            0            0      543.348      658.455 
      CELL22            0            0            0            0            0            0            0            0        8.738            0            0            0            0            0            0            0            0            0            0            0        0.017            0            0    30212.959            0            0            0            0            0            0            0            0            0       28.709            0            0            0            0            0        0.594            0            0            0            0            0            0            0            0            0        1.684            0            0      398.882      379.568 
      CELL23            0            0            0            0            0            0            0            0        4.025            0       31.019            0            0            0        0.054            0            0            0            0            0        0.008            0            0    17953.769            0            0            0            0            0            0            0            0            0       13.132         5.49            0            0      1745.62            0        0.267            0            0            0            0            0            0            0            0        4.582        0.799            0            0      585.532      585.532 
      CELL24            0            0            0            0            0            0            0            0        9.908            0       71.864            0            0            0         0.13            0            0            0            0            0        0.019            0            0            0            0            0            0            0            0            0            0            0            0       31.701       13.028            0            0            0            0        0.659            0            0            0            0            0            0            0            0       10.592        1.713            0            0     3993.142      4211.27 
      CELL25            0            0            0            0            0            0            0            0        8.077            0       58.687            0            0            0        0.106            0            0            0            0            0        0.016            0            0            0            0            0            0            0            0            0            0            0            0       25.904       10.633            0            0            0            0        0.537            0            0            0            0            0            0            0            0        8.641        1.402            0            0     2575.123     2249.605 
      CELL26            0            0            0            0            0            0            0            0        6.463            0       47.211            0            0            0        0.085            0            0            0            0            0        0.013            0            0            0            0            0            0            0            0            0            0            0            0       20.748        8.533            0            0            0            0         0.43            0            0            0            0            0            0            0            0        6.947        1.137            0            0     1204.201     1219.596 
      CELL27            0            0            0            0            0            0            0            0        8.302            0        60.63            0            0            0         0.11            0            0            0            0            0        0.016            0            0            0            0            0            0            0            0            0            0            0            0       26.581       10.954            0            0            0            0        0.552            0            0            0            0            0            0            0            0        8.913         1.45            0            0      278.829      467.952 
      CELL28            0            0            0            0            0            0            0            0        7.497            0       54.881            0            0            0        0.099            0            0            0            0            0        0.015            0            0            0            0            0            0            0            0            0            0            0            0       23.984        9.904            0            0            0            0        0.498            0            0            0            0            0            0            0            0        8.052        1.312            0            0     1283.244     1455.078 
      CELL29            0            0            0            0            0            0            0            0        4.452            0            0            0            0            0            0            0            0            0            0            0        0.009            0            0            0            0            0            0            0            0            0            0            0            0       14.267            0            0            0            0            0        0.294            0            0            0            0            0            0            0            0            0        0.794            0            0      984.743     1092.732 
      CELL30            0            0            0            0            0            0            0            0        3.651            0        26.75            0            0            0        0.048            0            0            0            0            0        0.007            0            0            0            0            0            0            0            0            0            0            0            0       11.614        4.824            0            0            0            0        0.239            0            0            0            0            0            0            0            0        3.916        0.625            0            0     3716.646      3805.77 
      CELL31            0            0            0            0            0            0            0            0        7.742            0       57.046            0            0            0        0.102            0            0            0            0            0        0.015            0            0            0            0            0            0            0            0            0            0            0            0       24.698       10.262            0            0            0            0        0.508            0            0            0            0            0            0            0            0        8.358         1.35            0            0     2874.927       3051.7 
      CELL32            0            0            0            0            0            0            0            0        5.626            0            0            0            0            0            0            0            0            0            0            0        0.011            0            0            0            0            0            0            0            0            0            0            0            0       17.929            0            0            0            0            0        0.369            0            0            0            0            0            0            0            0            0        0.971            0            0     1734.876      210.575 
      CELL33            0            0            0            0            0            0            0            0        9.338            0       67.527            0            0            0        0.123            0            0            0            0            0        0.018            0            0            0            0            0            0            0            0            0            0            0            0       30.004       12.275            0            0            0            0        0.623            0            0            0            0            0            0            0            0        9.989        1.611            0            0     3015.562     1775.565 
      CELL34            0            0            0            0            0            0            0            0       10.518            0        76.15            0            0            0        0.138            0            0            0            0            0        0.021            0            0            0            0            0            0            0            0            0            0            0            0       33.774        13.83            0            0            0            0        0.701            0            0            0            0            0            0            0            0       11.247        1.829            0            0     3795.972     2202.489 
      CELL35            0            0            0            0            0            0            0            0         3.91            0            0            0            0            0            0            0            0            0            0            0        0.008            0            0            0            0            0            0            0            0            0            0            0            0       12.851            0            0            0            0            0        0.267            0            0            0            0            0            0            0            0            0        0.748            0            0      609.571      707.565 
      CELL36            0            0            0            0            0            0            0            0        7.874            0            0            0            0            0            0            0            0            0            0            0        0.015            0            0            0            0            0            0            0            0            0            0            0            0       25.753            0            0            0            0            0        0.535            0            0            0            0            0            0            0            0            0        1.484            0            0      883.562     1066.814 
      CELL37            0            0            0            0            0            0            0            0        6.329            0       46.388            0            0            0        0.084            0            0            0            0            0        0.012            0            0            0            0            0            0            0            0            0            0            0            0       20.411        8.377            0            0            0            0        0.423            0            0            0            0            0            0            0            0        6.833        1.132            0            0     3144.849     3294.391 
      CELL38            0            0            0            0            0            0            0            0        8.589            0       62.446            0            0            0        0.113            0            0            0            0            0        0.017            0            0            0            0            0            0            0            0            0            0            0            0       27.464       11.315            0            0            0            0        0.565            0            0            0            0            0            0            0            0        9.194        1.491            0            0     4704.566     3436.227 
      CELL39            0            0            0            0            0            0            0            0         9.45            0       68.951            0            0            0        0.124            0            0            0            0            0        0.018            0            0            0            0            0            0            0            0            0            0            0            0       30.228       12.474            0            0            0            0        0.622            0            0            0            0            0            0            0            0       10.154         1.65            0            0     3677.723     3521.331 
      CELL40            0            0            0            0            0            0            0            0        6.656            0       49.029            0            0            0        0.088            0            0            0            0            0        0.013            0            0            0            0            0            0            0            0            0            0            0            0       21.368        8.833            0            0            0            0         0.44            0            0            0            0            0            0            0            0        7.212        1.192            0            0     2988.528     3144.278 
      CELL41            0            0            0            0            0            0            0            0        8.613            0            0            0            0            0            0            0            0            0            0            0        0.017            0            0            0            0            0            0            0            0            0            0            0            0       27.645            0            0            0            0            0        0.565            0            0            0            0            0            0            0            0            0        1.559            0            0     2347.971     2106.431 
      CELL42            0            0            0            0            0            0            0            0        4.669            0       34.241            0            0            0        0.062            0            0            0            0            0        0.009            0            0            0            0            0            0            0            0            0            0            0            0       14.895        6.176            0            0            0            0        0.307            0            0            0            0            0            0            0            0        5.019        0.812            0            0     3114.517     3226.893 
      CELL43            0            0            0            0            0            0            0            0        8.298            0       60.782            0            0            0         0.11            0            0            0            0            0        0.016            0            0            0            0            0            0            0            0            0            0            0            0       26.512       10.968            0            0            0            0         0.55            0            0            0            0            0            0            0            0        8.903        1.417            0            0      4590.83     4778.685 
      CELL44            0            0            0            0            0            0            0            0        3.792            0       27.778            0            0            0         0.05            0            0            0            0            0        0.007            0            0            0            0            0            0            0            0            0            0            0            0       12.067        5.012            0            0            0            0        0.248            0            0            0            0            0            0            0            0        4.067        0.641            0            0     2919.406     1908.139 
      CELL45            0            0            0            0            0            0            0            0       11.833            0       85.518            0            0            0        0.156            0            0            0            0            0        0.023            0            0            0            0            0            0            0            0            0            0            0            0       38.012       15.554            0            0            0            0         0.79            0            0            0            0            0            0            0            0       12.655        2.023            0            0     3455.351     2541.929 
      CELL46            0            0            0            0            0            0            0            0        6.841            0       49.441            0            0            0         0.09            0            0            0            0            0        0.013            0            0            0            0            0            0            0            0            0            0            0            0       21.952         8.99            0            0            0            0        0.456            0            0            0            0            0            0            0            0         7.31        1.165            0            0     5549.276      3771.07 
      CELL47            0            0            0            0            0            0            0            0       11.542            0       83.415            0            0            0        0.152            0            0            0            0            0        0.023            0            0            0            0            0            0            0            0            0            0            0            0       37.026       15.157            0            0            0            0        0.768            0            0            0            0            0            0            0            0       12.322        1.973            0            0     4064.323     4311.306 
      CELL48            0            0            0            0            0            0            0            0       12.198            0       88.976            0            0            0        0.161            0            0            0            0            0        0.024            0            0            0            0            0            0            0            0            0            0            0            0        39.27       16.105            0            0            0            0        0.814            0            0            0            0            0            0            0            0       13.126        2.158            0            0     2095.282     2352.409 
      CELL49            0            0            0            0            0            0            0            0        4.864            0       36.203            0            0            0        0.065            0            0            0            0            0         0.01            0            0            0            0            0            0            0            0            0            0            0            0       15.722        6.502            0            0            0            0        0.321            0            0            0            0            0            0            0            0        5.333        0.894            0            0     1465.872     1583.755 
      CELL50            0            0            0            0            0            0            0            0       10.203            0        74.07            0            0            0        0.134            0            0            0            0            0         0.02            0            0            0            0            0            0            0            0            0            0            0            0       32.576       13.431            0            0            0            0         0.67            0            0            0            0            0            0            0            0       10.902         1.75            0            0     3734.079     3957.102 
      CELL51            0            0            0            0            0            0            0            0       10.026            0            0            0            0            0            0            0            0            0            0            0         0.02            0            0            0            0            0            0            0            0            0            0            0            0       32.154            0            0            0            0            0        0.662            0            0            0            0            0            0            0            0            0         1.78            0            0     2532.032     2752.707 
      CELL52            0            0            0            0            0            0            0            0        9.364            0       68.856            0            0            0        0.124            0            0            0            0            0        0.018            0            0            0            0            0            0            0            0            0            0            0            0       30.009       12.417            0            0            0            0        0.618            0            0            0            0            0            0            0            0       10.111        1.663            0            0     2711.074     2918.778 
      CELL53            0            0            0            0            0            0            0            0        8.786            0       64.377            0            0            0        0.116            0            0            0            0            0        0.017            0            0            0            0            0            0            0            0            0            0            0            0       28.066       11.623            0            0            0            0        0.578            0            0            0            0            0            0            0            0        9.453        1.531            0            0     2957.905      3154.51 
      CELL54            0            0            0            0            0            0            0            0         8.43            0       61.617            0            0            0        0.111            0            0            0            0            0        0.016            0            0            0            0            0            0            0            0            0            0            0            0       26.853       11.132            0            0            0            0        0.553            0            0            0            0            0            0            0            0        9.049        1.439            0            0     5287.109     3566.775 
      CELL55            0            0            0            0            0            0            0            0        8.902            0       65.263            0            0            0        0.117            0            0            0            0            0        0.017            0            0            0            0            0            0            0            0            0            0            0            0       28.358       11.775            0            0            0            0        0.584            0            0            0            0            0            0            0            0        9.561        1.523            0            0     4017.773     2742.573 
      CELL56            0            0            0            0            0            0            0            0        7.024            0            0            0            0            0            0            0            0            0            0            0        0.014            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       78.584        20.41 
      CELL57            0            0            0            0            0            0            0            0       12.842            0       92.945            0            0            0        0.169            0            0            0            0            0        0.025            0            0            0            0            0            0            0            0            0            0            0            0       41.272         16.9            0            0            0            0        0.857            0            0            0            0            0            0            0            0       13.743        2.193            0            0     1510.793     1777.694 
      CELL58            0            0            0            0            0            0            0            0        5.598            0       40.528            0            0            0        0.074            0            0            0            0            0        0.011            0            0            0            0            0            0            0            0            0            0            0            0       17.984        7.367            0            0            0            0        0.373            0            0            0            0            0            0            0            0        5.988        0.953            0            0      5011.42     5144.903 
      CELL59            0            0            0            0            0            0            0            0       11.708            0       84.738            0            0            0        0.154            0            0            0            0            0        0.023            0            0            0            0            0            0            0            0            0            0            0            0       37.601       15.398            0            0            0            0         0.78            0            0            0            0            0            0            0            0       12.513        2.015            0            0     5881.133     6131.101 
      CELL60            0            0            0            0            0            0            0            0        9.984            0        72.24            0            0            0        0.131            0            0            0            0            0        0.019            0            0            0            0            0            0            0            0            0            0            0            0        32.02       13.125            0            0            0            0        0.665            0            0            0            0            0            0            0            0       10.663        1.704            0            0     4105.054     4324.975 
      CELL61            0            0            0            0            0            0            0            0       11.044            0       80.584            0            0            0        0.145            0            0            0            0            0        0.022            0            0            0            0            0            0            0            0            0            0            0            0       35.293       14.591            0            0            0            0        0.721            0            0            0            0            0            0            0            0       11.855        1.946            0            0     2221.058     2457.811 
      CELL62            0            0            0            0            0            0            0            0       11.949            0       86.717            0            0            0        0.157            0            0            0            0            0        0.023            0            0            0            0            0            0            0            0            0            0            0            0       38.141       15.729            0            0            0            0        0.785            0            0            0            0            0            0            0            0       12.765        2.038            0            0     4602.526     2773.641 
      CELL63            0            0            0            0            0            0            0            0       10.074            0       73.525            0            0            0        0.133            0            0            0            0            0         0.02            0            0            0            0            0            0            0            0            0            0            0            0       32.185       13.303            0            0            0            0        0.663            0            0            0            0            0            0            0            0       10.798        1.745            0            0     4374.393     4595.236 
      CELL64            0            0            0            0            0            0            0            0        7.236            0       52.954            0            0            0        0.095            0            0            0            0            0        0.014            0            0            0            0            0            0            0            0            0            0            0            0       23.128         9.57            0            0            0            0        0.476            0            0            0            0            0            0            0            0        7.784         1.26            0            0     4618.929     4785.896 
      CELL65            0            0            0            0            0            0            0            0        9.484            0       69.261            0            0            0        0.125            0            0            0            0            0        0.019            0            0            0            0            0            0            0            0            0            0            0            0       30.236       12.524            0            0            0            0        0.623            0            0            0            0            0            0            0            0       10.158        1.619            0            0     5560.315     4196.911 
      CELL66            0            0            0            0            0            0            0            0        9.627            0       70.266            0            0            0        0.127            0            0            0            0            0        0.019            0            0            0            0            0            0            0            0            0            0            0            0       30.644       12.706            0            0            0            0        0.631            0            0            0            0            0            0            0            0       10.304        1.633            0            0     2267.661     2360.968 
      CELL67            0            0            0            0            0            0            0            0        8.085            0            0            0            0            0            0            0            0            0            0            0        0.016            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      724.626      242.889 
      CELL68            0            0            0            0            0            0            0            0       12.752            0       92.906            0            0            0        0.169            0            0            0            0            0        0.025            0            0            0            0            0            0            0            0            0            0            0            0       41.168       16.855            0            0            0            0        0.854            0            0            0            0            0            0            0            0       13.716        2.241            0            0      576.733      753.158 
      CELL69            0            0            0            0            0            0            0            0       13.509            0       98.306            0            0            0        0.179            0            0            0            0            0        0.026            0            0            0            0            0            0            0            0            0            0            0            0        43.57       17.836            0            0            0            0        0.904            0            0            0            0            0            0            0            0        14.51        2.372            0            0      1358.06     1635.779 
      CELL70            0            0            0            0            0            0            0            0       13.798            0      100.078            0            0            0        0.182            0            0            0            0            0        0.027            0            0            0            0            0            0            0            0            0            0            0            0       44.386       18.177            0            0            0            0        0.921            0            0            0            0            0            0            0            0       14.772        2.383            0            0     5783.689      6066.87 
      CELL71            0            0            0            0            0            0            0            0       10.757            0       77.928            0            0            0        0.142            0            0            0            0            0        0.021            0            0            0            0            0            0            0            0            0            0            0            0       34.542        14.16            0            0            0            0        0.717            0            0            0            0            0            0            0            0       11.505        1.842            0            0      6558.34     6792.139 
      CELL72            0            0            0            0            0            0            0            0        5.452            0       39.451            0            0            0        0.072            0            0            0            0            0        0.011            0            0            0            0            0            0            0            0            0            0            0            0       17.481        7.171            0            0            0            0        0.363            0            0            0            0            0            0            0            0        5.808        0.926            0            0     5360.981      5401.45 
      CELL73            0            0            0            0            0            0            0            0       13.059            0       94.801            0            0            0        0.172            0            0            0            0            0        0.026            0            0            0            0            0            0            0            0            0            0            0            0       41.886       17.203            0            0            0            0         0.87            0            0            0            0            0            0            0            0       13.964        2.234            0            0     6380.054      6651.42 
      CELL74            0            0            0            0            0            0            0            0       10.111            0       73.405            0            0            0        0.133            0            0            0            0            0         0.02            0            0            0            0            0            0            0            0            0            0            0            0       32.283       13.319            0            0            0            0        0.665            0            0            0            0            0            0            0            0       10.807         1.72            0            0     5527.201     3224.009 
      CELL75            0            0            0            0            0            0            0            0       12.443            0        90.71            0            0            0        0.164            0            0            0            0            0        0.024            0            0            0            0            0            0            0            0            0            0            0            0       39.751       16.428            0            0            0            0        0.819            0            0            0            0            0            0            0            0       13.321        2.134            0            0     5343.165      5548.08 
      CELL76            0            0            0            0            0            0            0            0       11.604            0       84.796            0            0            0        0.153            0            0            0            0            0        0.023            0            0            0            0            0            0            0            0            0            0            0            0       37.063       15.338            0            0            0            0        0.763            0            0            0            0            0            0            0            0       12.443        1.992            0            0     5103.619     5350.798 
      CELL77            0            0            0            0            0            0            0            0       10.606            0       77.454            0            0            0         0.14            0            0            0            0            0        0.021            0            0            0            0            0            0            0            0            0            0            0            0       33.898       14.009            0            0            0            0        0.704            0            0            0            0            0            0            0            0        11.36        1.794            0            0     3987.499     3218.485 
      CELL78            0            0            0            0            0            0            0            0        9.234            0            0            0            0            0            0            0            0            0            0            0        0.018            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      560.357       215.33 
      CELL79            0            0            0            0            0            0            0            0       13.659            0       98.531            0            0            0         0.18            0            0            0            0            0        0.027            0            0            0            0            0            0            0            0            0            0            0            0       43.837       17.944            0            0            0            0         0.91            0            0            0            0            0            0            0            0        14.56        2.296            0            0       95.534       96.255 
      CELL80            0            0            0            0            0            0            0            0       15.586            0      113.315            0            0            0        0.206            0            0            0            0            0         0.03            0            0            0            0            0            0            0            0            0            0            0            0       50.252       20.575            0            0            0            0        1.043            0            0            0            0            0            0            0            0       16.724        2.718            0            0     4828.065      4878.54 
      CELL81            0            0            0            0            0            0            0            0        9.416            0       68.725            0            0            0        0.124            0            0            0            0            0        0.018            0            0            0            0            0            0            0            0            0            0            0            0       30.293       12.455            0            0            0            0        0.624            0            0            0            0            0            0            0            0       10.126        1.662            0            0     5408.227     4590.094 
      CELL82            0            0            0            0            0            0            0            0       14.735            0            0            0            0            0            0            0            0            0            0            0        0.029            0            0            0            0            0            0            0            0            0            0            0            0       47.423            0            0            0            0            0        0.985            0            0            0            0            0            0            0            0            0        2.561            0            0     5355.878     5652.747 
      CELL83            0            0            0            0            0            0            0            0       14.543            0      105.389            0            0            0        0.192            0            0            0            0            0        0.028            0            0            0            0            0            0            0            0            0            0            0            0       46.672       19.151            0            0            0            0        0.969            0            0            0            0            0            0            0            0       15.513        2.474            0            0     5144.549     5438.099 
      CELL84            0            0            0            0            0            0            0            0       14.462            0      104.671            0            0            0        0.191            0            0            0            0            0        0.028            0            0            0            0            0            0            0            0            0            0            0            0       46.335       19.026            0            0            0            0        0.962            0            0            0            0            0            0            0            0       15.408        2.428            0            0     4675.732     4965.907 
      CELL85            0            0            0            0            0            0            0            0       13.394            0       97.057            0            0            0        0.177            0            0            0            0            0        0.026            0            0            0            0            0            0            0            0            0            0            0            0       42.891       17.631            0            0            0            0        0.891            0            0            0            0            0            0            0            0        14.27        2.253            0            0     4695.772      4178.24 
      CELL86            0            0            0            0            0            0            0            0       13.463            0       97.767            0            0            0        0.177            0            0            0            0            0        0.026            0            0            0            0            0            0            0            0            0            0            0            0       42.993       17.742            0            0            0            0        0.885            0            0            0            0            0            0            0            0       14.351        2.275            0            0     5155.891     4409.801 
      CELL87            0            0            0            0            0            0            0            0        9.416            0       68.499            0            0            0        0.124            0            0            0            0            0        0.018            0            0            0            0            0            0            0            0            0            0            0            0       30.056       12.417            0            0            0            0        0.619            0            0            0            0            0            0            0            0        10.07        1.594            0            0     5155.869     4807.132 
      CELL88            0            0            0            0            0            0            0            0        12.75            0       92.836            0            0            0        0.168            0            0            0            0            0        0.025            0            0            0            0            0            0            0            0            0            0            0            0       40.608       16.817            0            0            0            0        0.836            0            0            0            0            0            0            0            0       13.633        2.133            0            0     3978.838     2693.348 
      CELL89            0            0            0            0            0            0            0            0        10.41            0            0            0            0            0            0            0            0            0            0            0         0.02            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0      1216.18      208.759 
      CELL90            0            0            0            0            0            0            0            0       15.982            0      115.537            0            0            0        0.211            0            0            0            0            0        0.031            0            0            0            0            0            0            0            0            0            0            0            0        51.32       21.027            0            0            0            0        1.065            0            0            0            0            0            0            0            0       17.046        2.699            0            0      1989.04     2128.441 
      CELL91            0            0            0            0            0            0            0            0       16.443            0            0            0            0            0            0            0            0            0            0            0        0.032            0            0            0            0            0            0            0            0            0            0            0            0       52.835            0            0            0            0            0        1.097            0            0            0            0            0            0            0            0            0        2.807            0            0     5336.411     5655.869 
      CELL92            0            0            0            0            0            0            0            0       15.711            0            0            0            0            0            0            0            0            0            0            0        0.031            0            0            0            0            0            0            0            0            0            0            0            0       50.475            0            0            0            0            0        1.048            0            0            0            0            0            0            0            0            0        2.689            0            0     6945.845     7255.737 
      CELL93            0            0            0            0            0            0            0            0        12.09            0       87.612            0            0            0         0.16            0            0            0            0            0        0.024            0            0            0            0            0            0            0            0            0            0            0            0        38.76        15.92            0            0            0            0        0.805            0            0            0            0            0            0            0            0       12.893         2.04            0            0     5923.176     6179.074 
      CELL94            0            0            0            0            0            0            0            0       15.578            0      113.087            0            0            0        0.206            0            0            0            0            0         0.03            0            0            0            0            0            0            0            0            0            0            0            0       49.941       20.533            0            0            0            0        1.037            0            0            0            0            0            0            0            0       16.667        2.644            0            0     4116.878     4422.366 
      CELL95            0            0            0            0            0            0            0            0       15.311            0      110.882            0            0            0        0.202            0            0            0            0            0         0.03            0            0            0            0            0            0            0            0            0            0            0            0       48.966       20.145            0            0            0            0        1.017            0            0            0            0            0            0            0            0       16.287        2.545            0            0     3798.353     3483.518 
      CELL96            0            0            0            0            0            0            0            0       14.127            0      102.463            0            0            0        0.186            0            0            0            0            0        0.028            0            0            0            0            0            0            0            0            0            0            0            0       45.044         18.6            0            0            0            0        0.927            0            0            0            0            0            0            0            0       15.049        2.356            0            0     5443.204     3473.282 
      CELL97            0            0            0            0            0            0            0            0       13.318            0       96.798            0            0            0        0.175            0            0            0            0            0        0.026            0            0            0            0            0            0            0            0            0            0            0            0       42.417       17.554            0            0            0            0        0.874            0            0            0            0            0            0            0            0       14.196        2.225            0            0     3698.157     2463.335 
      CELL98            0            0            0            0            0            0            0            0       11.573            0            0            0            0            0            0            0            0            0            0            0        0.023            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     1018.705       205.25 
      CELL99            0            0            0            0            0            0            0            0       12.897            0       93.236            0            0            0         0.17            0            0            0            0            0        0.025            0            0            0            0            0            0            0            0            0            0            0            0       41.331       16.968            0            0            0            0        0.858            0            0            0            0            0            0            0            0       13.705        2.143            0            0     1556.066     1591.666 
     CELL100            0            0            0            0            0            0            0            0        14.82            0            0            0            0            0            0            0            0            0            0            0        0.029            0            0            0            0            0            0            0            0            0            0            0            0       47.465            0            0            0            0            0        0.985            0            0            0            0            0            0            0            0            0        2.464            0            0     5609.353     5519.402 
     CELL101            0            0            0            0            0            0            0            0       16.833            0      121.982            0            0            0        0.222            0            0            0            0            0        0.033            0            0            0            0            0            0            0            0            0            0            0            0       53.922       22.166            0            0            0            0         1.12            0            0            0            0            0            0            0            0       17.945        2.817            0            0      5610.71     5921.325 
     CELL102            0            0            0            0            0            0            0            0       11.678            0        84.42            0            0            0        0.154            0            0            0            0            0        0.023            0            0            0            0            0            0            0            0            0            0            0            0       37.318       15.352            0            0            0            0        0.775            0            0            0            0            0            0            0            0       12.393        1.921            0            0      5814.95      6063.45 
     CELL103            0            0            0            0            0            0            0            0        15.97            0      115.624            0            0            0        0.211            0            0            0            0            0        0.031            0            0            0            0            0            0            0            0            0            0            0            0       51.035       21.009            0            0            0            0         1.06            0            0            0            0            0            0            0            0       16.955         2.64            0            0     4679.967     3071.829 
     CELL104            0            0            0            0            0            0            0            0        13.07            0            0            0            0            0            0            0            0            0            0            0        0.026            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0     2012.396     1125.186 
     CELL105            0            0            0            0            0            0            0            0       16.024            0      115.316            0            0            0        0.211            0            0            0            0            0        0.031            0            0            0            0            0            0            0            0            0            0            0            0       51.129       21.019            0            0            0            0        1.061            0            0            0            0            0            0            0            0       16.805        2.545            0            0     3143.408     2825.263 
     CELL106            0            0            0            0            0            0            0            0       17.393            0      125.547            0            0            0        0.229            0            0            0            0            0        0.034            0            0            0            0            0            0            0            0            0            0            0            0       55.543        22.85            0            0            0            0        1.153            0            0            0            0            0            0            0            0       18.343        2.811            0            0     5009.282     4319.796 
     CELL107            0            0            0            0            0            0            0            0       14.419            0      103.919            0            0            0         0.19            0            0            0            0            0        0.028            0            0            0            0            0            0            0            0            0            0            0            0       45.983       18.923            0            0            0            0        0.955            0            0            0            0            0            0            0            0       15.123          2.3            0            0     2429.169     1591.246 
     CELL108            0            0            0            0            0            0            0            0       15.498            0      111.362            0            0            0        0.204            0            0            0            0            0         0.03            0            0            0            0            0            0            0            0            0            0            0            0       49.421       20.313            0            0            0            0        1.025            0            0            0            0            0            0            0            0       16.152        2.417            0            0       95.774       48.068 
    TOTAL_AR            0            0            0            0            0            0            0            0         1024            0         6069            0            0            0           11            0            0            0            0            0            2            0            0        70012            0            0            0            0            0            0            0            0            0         3044         1100            0            0         3847            0           63            0            0            0            0            0            0            0            0      892.254      162.746            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
