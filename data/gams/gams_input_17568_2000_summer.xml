<document>
<category>milp</category>
<solver>CPLEX</solver>
<inputType>GAMS</inputType>
<client>Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:54.0) Gecko/20100101 Firefox/54.0@144.173.225.124</client>
<priority>short</priority>
<email>sim.moulds@gmail.com</email>
<model><![CDATA[$TITLE Matrix adjustment program

*==============================================================================*
*                                                                              *
*           Except where otherwise noted, this work is licensed under          *
*               http://creativecommons.org/licenses/by-nc-sa/3.0/              *
*                                                                              *
*                                                                              *
*  You are free to share, to copy, distribute and transmit the work under      *
*  the following conditions:                                                   *
*                                                                              *
*  - Attribution:         You must attribute the work to: Andre Lemelin        *                            *
*  - Noncommercial:       You may not use this work for commercial purposes.   *
*  - Share Alike:         If you alter, transform, or build upon this work,    *
*                         you may distribute the resulting work only under     *
*                         the same or similar license to this one.             *
*                                                                              *
*==============================================================================*

* This program is based on the original GPCEMA program written by Andre
* Lemelin (2010). Other than changing the input data (and the corresponding
* sets, the program is the same). The original code is available at the
* following url: https://www.pep-net.org/pep-standard-cge-models.

* The program adjusts a matrix following the Junius and Oosterhaven (2003)
* principle, but with an objective function defined as the true Kullback-Leibler
* cross-entropy information-gain measure. The method is extended to deal with
* zero row-sums, or column-sums, or both.

* Reference:
* LEMELIN, Andre (2010), "A GRAS variant solving for minimum information loss",
* Economic Systems Research, 21(4), p. 399-408.

*==============================================================================*


SET I Row labels / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, CELL188, CELL189, CELL190, CELL191, CELL192, CELL193, CELL194, CELL195, CELL196, CELL197, CELL198, CELL199, CELL200, CELL201, CELL202, CELL203, TOTAL_AR /;

SET I2(I) Row labels without CTOTS / CELL1, CELL2, CELL3, CELL4, CELL5, CELL6, CELL7, CELL8, CELL9, CELL10, CELL11, CELL12, CELL13, CELL14, CELL15, CELL16, CELL17, CELL18, CELL19, CELL20, CELL21, CELL22, CELL23, CELL24, CELL25, CELL26, CELL27, CELL28, CELL29, CELL30, CELL31, CELL32, CELL33, CELL34, CELL35, CELL36, CELL37, CELL38, CELL39, CELL40, CELL41, CELL42, CELL43, CELL44, CELL45, CELL46, CELL47, CELL48, CELL49, CELL50, CELL51, CELL52, CELL53, CELL54, CELL55, CELL56, CELL57, CELL58, CELL59, CELL60, CELL61, CELL62, CELL63, CELL64, CELL65, CELL66, CELL67, CELL68, CELL69, CELL70, CELL71, CELL72, CELL73, CELL74, CELL75, CELL76, CELL77, CELL78, CELL79, CELL80, CELL81, CELL82, CELL83, CELL84, CELL85, CELL86, CELL87, CELL88, CELL89, CELL90, CELL91, CELL92, CELL93, CELL94, CELL95, CELL96, CELL97, CELL98, CELL99, CELL100, CELL101, CELL102, CELL103, CELL104, CELL105, CELL106, CELL107, CELL108, CELL109, CELL110, CELL111, CELL112, CELL113, CELL114, CELL115, CELL116, CELL117, CELL118, CELL119, CELL120, CELL121, CELL122, CELL123, CELL124, CELL125, CELL126, CELL127, CELL128, CELL129, CELL130, CELL131, CELL132, CELL133, CELL134, CELL135, CELL136, CELL137, CELL138, CELL139, CELL140, CELL141, CELL142, CELL143, CELL144, CELL145, CELL146, CELL147, CELL148, CELL149, CELL150, CELL151, CELL152, CELL153, CELL154, CELL155, CELL156, CELL157, CELL158, CELL159, CELL160, CELL161, CELL162, CELL163, CELL164, CELL165, CELL166, CELL167, CELL168, CELL169, CELL170, CELL171, CELL172, CELL173, CELL174, CELL175, CELL176, CELL177, CELL178, CELL179, CELL180, CELL181, CELL182, CELL183, CELL184, CELL185, CELL186, CELL187, CELL188, CELL189, CELL190, CELL191, CELL192, CELL193, CELL194, CELL195, CELL196, CELL197, CELL198, CELL199, CELL200, CELL201, CELL202, CELL203 /;

SET J Column labels / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26, CRPLND_AR, IRRI_AR /;
SET J2(J) Column labels without RTOTS / CROP1, CROP2, CROP3, CROP4, CROP5, CROP6, CROP7, CROP8, CROP9, CROP10, CROP11, CROP12, CROP13, CROP14, CROP15, CROP16, CROP17, CROP18, CROP19, CROP20, CROP21, CROP22, CROP23, CROP24, CROP25, CROP26 /;

SET J3(J2) Column labels of irrigated crops / CROP1, CROP3, CROP5, CROP7, CROP9, CROP11, CROP13, CROP15, CROP17, CROP19, CROP21, CROP23, CROP25 /;

ALIAS (I2,I2J);
ALIAS (J2,J2J);

TABLE
    DATA(I,J)
                    CROP1        CROP2        CROP3        CROP4        CROP5        CROP6        CROP7        CROP8        CROP9       CROP10       CROP11       CROP12       CROP13       CROP14       CROP15       CROP16       CROP17       CROP18       CROP19       CROP20       CROP21       CROP22       CROP23       CROP24       CROP25       CROP26    CRPLND_AR      IRRI_AR 
       CELL1            0            0            0            0            0            0            0            0            0            0        0.025        0.102            0            0       13.224            0            0            0            0            0            0            0            0            0            0            0       16.985       15.299 
       CELL2            0            0            0            0            0            0            0            0            0            0        0.029        0.119            0            0       15.517            0            0            0            0            0            0            0            0            0            0            0       63.238       65.148 
       CELL3            0            0            0            0            0            0            0            0            0            0        0.029        0.121            0            0       15.313            0            0            0            0            0            0            0            0            0            0            0      242.491       65.452 
       CELL4            0            0            0            0            0            0            0            0            0            0        0.033        0.136            0            0       17.466            0            0            0            0            0            0            0            0            0            0            0      162.009      110.064 
       CELL5            0            0            0            0            0            0            0            0            0            0        0.008        0.032            0            0        4.152            0            0            0            0            0            0            0            0            0            0            0      221.858      206.532 
       CELL6            0            0            0            0            0            0            0            0            0            0            0         0.16            0            0            0            0            0            0            0            0            0            0            0            0            0            0       192.01      161.581 
       CELL7            0            0            0            0            0            0            0            0            0            0        0.012         0.05            0            0        6.552            0            0            0            0            0            0            0            0            0            0            0      205.623      156.674 
       CELL8            0            0            0            0            0            0            0            0            0            0        0.028        0.117            0            0       15.355            0            0            0            0            0            0            0            0            0            0            0     1060.525     1011.963 
       CELL9            0            0            0            0            0            0            0            0            0            0        0.057        0.233            0            0       29.023            0            0            0            0            0            0            0            0            0            0            0       55.308       25.433 
      CELL10            0            0            0            0            0            0            0            0            0            0        0.036        0.149            0            0       18.711            0            0            0            0            0            0            0            0            0            0            0     3528.359      753.481 
      CELL11            0            0            0            0            0            0            0            0            0            0        0.043        0.179            0            0       22.396            0            0            0            0            0            0            0            0            0            0            0     4737.746      976.113 
      CELL12            0            0            0            0            0            0            0            0            0            0        0.054        0.222            0            0       28.072            0            0            0            0            0            0            0            0            0            0            0     2264.906      898.458 
      CELL13            0            0            0            0            0            0            0            0            0            0        0.067        0.275            0            0       35.219            0            0            0            0            0            0            0            0            0            0            0     1516.359      712.767 
      CELL14            0            0            0            0            0            0            0            0            0            0        0.056        0.229            0            0       29.513            0            0            0            0            0            0            0            0            0            0            0     2341.017      462.813 
      CELL15            0            0            0            0            0            0            0            0            0            0        0.031        0.126            0            0       16.274            0            0            0            0            0            0            0            0            0            0            0     3011.754     1819.372 
      CELL16            0            0            0            0            0            0            0            0            0            0        0.027         0.11            0            0        14.28            0            0            0            0            0            0            0            0            0            0            0      244.256      251.639 
      CELL17            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0            0       40.547       18.833 
      CELL18            0            0            0            0            0            0            0            0            0            0        0.039        0.161            0            0       21.184            0            0            0            0            0            0            0            0            0            0            0      550.996      339.676 
      CELL19            0            0            0            0            0            0            0            0            0            0        0.022        0.089            0            0       11.692            0            0            0            0            0            0            0            0            0            0            0     2238.504     1234.311 
      CELL20            0            0            0            0            0            0            0            0            0            0        0.018        0.072            0            0        9.632            0            0            0            0            0            0            0            0            0            0            0      619.933      509.411 
      CELL21            0            0            0            0            0            0            0            0            0            0        0.087        0.357            0            0       44.451            0            0            0            0            0            0            0            0            0            0            0      433.237      173.964 
      CELL22            0            0            0            0            0            0            0            0            0            0         0.07        0.287            0            0       36.002            0            0            0            0            0            0            0            0            0            0            0     5873.394     2327.715 
      CELL23            0            0            0            0            0            0            0            0            0            0        0.042        0.172            0            0       21.765            0            0            0            0            0            0            0            0            0            0            0     5596.242     1053.267 
      CELL24            0            0            0            0            0            0            0            0            0            0        0.072        0.298            0            0       37.706            0            0            0            0            0            0            0            0            0            0            0     6520.046     3698.156 
      CELL25            0            0            0            0            0            0            0            0            0            0        0.056        0.232            0            0       29.705            0            0            0            0            0            0            0            0            0            0            0     5119.118     2548.485 
      CELL26            0            0            0            0            0            0            0            0            0            0         0.06        0.245            0            0       31.984            0            0            0            0            0            0            0            0            0            0            0     1809.842     1386.813 
      CELL27            0            0            0            0            0            0            0            0            0            0        0.034        0.138            0            0       17.941            0            0            0            0            0            0            0            0            0            0            0     1674.075      390.659 
      CELL28            0            0            0            0            0            0            0            0            0            0        0.044        0.182            0            0       23.697            0            0            0            0            0            0            0            0            0            0            0      839.562      414.226 
      CELL29            0            0            0            0            0            0            0            0            0            0        0.034        0.138            0            0       18.091            0            0            0            0            0            0            0            0            0            0            0      246.356      253.799 
      CELL30            0            0            0            0            0            0            0            0            0            0        0.047        0.195            0            0       25.585            0            0            0            0            0            0            0            0            0            0            0       516.61      404.176 
      CELL31            0            0            0            0            0            0            0            0            0            0        0.042        0.172            0            0       22.766            0            0            0            0            0            0            0            0            0            0            0     1570.493      607.674 
      CELL32            0            0            0            0            0            0            0            0            0            0        0.025        0.101            0            0       13.366            0            0            0            0            0            0            0            0            0            0            0     1151.418      798.903 
      CELL33            0            0            0            0            0            0            0            0            0            0        0.062        0.257            0            0       32.039            0            0            0            0            0            0            0            0            0            0            0       754.29      301.427 
      CELL34            0            0            0            0            0            0            0            0            0            0        0.016        0.065            0            0        8.076            0            0            0            0            0            0            0            0            0            0            0     5921.091     2872.032 
      CELL35            0            0            0            0            0            0            0            0            0            0        0.065        0.268            0            0        33.94            0            0            0            0            0            0            0            0            0            0            0     6021.536     2901.764 
      CELL36            0            0            0            0            0            0            0            0            0            0        0.064        0.261            0            0       33.177            0            0            0            0            0            0            0            0            0            0            0     6043.643      1537.36 
      CELL37            0            0            0            0            0            0            0            0            0            0        0.059        0.241            0            0       30.581            0            0            0            0            0            0            0            0            0            0            0     5891.515     1716.245 
      CELL38            0            0            0            0            0            0            0            0            0            0         0.07         0.29            0            0       37.409            0            0            0            0            0            0            0            0            0            0            0     5497.985      2241.01 
      CELL39            0            0            0            0            0            0            0            0            0            0        0.028        0.114            0            0       14.871            0            0            0            0            0            0            0            0            0            0            0     1163.014        61.08 
      CELL40            0            0            0            0            0            0            0            0            0            0        0.013        0.052            0            0        6.743            0            0            0            0            0            0            0            0            0            0            0     1038.503       72.724 
      CELL41            0            0            0            0            0            0            0            0            0            0        0.053        0.217            0            0       28.464            0            0            0            0            0            0            0            0            0            0            0     2311.995     1250.499 
      CELL42            0            0            0            0            0            0            0            0            0            0        0.014        0.056            0            0        7.389            0            0            0            0            0            0            0            0            0            0            0       558.06       28.685 
      CELL43            0            0            0            0            0            0            0            0            0            0        0.037        0.151            0            0       20.241            0            0            0            0            0            0            0            0            0            0            0     1016.382      936.093 
      CELL44            0            0            0            0            0            0            0            0            0            0        0.029        0.119            0            0       15.976            0            0            0            0            0            0            0            0            0            0            0     1985.255     1846.888 
      CELL45            0            0            0            0            0            0            0            0            0            0        0.029        0.118            0            0       15.783            0            0            0            0            0            0            0            0            0            0            0      174.117      118.618 
      CELL46            0            0            0            0            0            0            0            0            0            0        0.044        0.179            0            0        22.39            0            0            0            0            0            0            0            0            0            0            0     4498.906     2886.566 
      CELL47            0            0            0            0            0            0            0            0            0            0        0.098        0.403            0            0       50.726            0            0            0            0            0            0            0            0            0            0            0     6028.018     3466.735 
      CELL48            0            0            0            0            0            0            0            0            0            0        0.053        0.219            0            0       27.825            0            0            0            0            0            0            0            0            0            0            0     5946.341     2110.788 
      CELL49            0            0            0            0            0            0            0            0            0            0        0.049        0.203            0            0       26.037            0            0            0            0            0            0            0            0            0            0            0     5947.326      1244.24 
      CELL50            0            0            0            0            0            0            0            0            0            0        0.075        0.309            0            0       39.572            0            0            0            0            0            0            0            0            0            0            0     5411.152     1366.982 
      CELL51            0            0            0            0            0            0            0            0            0            0         0.08        0.329            0            0       43.328            0            0            0            0            0            0            0            0            0            0            0     2589.082      744.017 
      CELL52            0            0            0            0            0            0            0            0            0            0        0.065        0.268            0            0       35.631            0            0            0            0            0            0            0            0            0            0            0     2438.163     1566.628 
      CELL53            0            0            0            0            0            0            0            0            0            0        0.064        0.263            0            0       34.586            0            0            0            0            0            0            0            0            0            0            0         1308      603.029 
      CELL54            0            0            0            0            0            0            0            0            0            0        0.052        0.215            0            0       28.837            0            0            0            0            0            0            0            0            0            0            0      973.078      530.891 
      CELL55            0            0            0            0            0            0            0            0            0            0        0.022        0.091            0            0       12.192            0            0            0            0            0            0            0            0            0            0            0     1126.048      129.745 
      CELL56            0            0            0            0            0            0            0            0            0            0        0.014        0.059            0            0        8.025            0            0            0            0            0            0            0            0            0            0            0     2574.119      841.948 
      CELL57            0            0            0            0            0            0            0            0            0            0         0.03        0.124            0            0       16.789            0            0            0            0            0            0            0            0            0            0            0      3427.85     3300.693 
      CELL58            0            0            0            0            0            0            0            0            0            0        0.022         0.09            0            0       12.225            0            0            0            0            0            0            0            0            0            0            0      719.202      339.538 
      CELL59            0            0            0            0            0            0            0            0            0            0        0.118        0.483            0            0       60.393            0            0            0            0            0            0            0            0            0            0            0      673.971      334.649 
      CELL60            0            0            0            0            0            0            0            0            0            0        0.094        0.386            0            0       48.259            0            0            0            0            0            0            0            0            0            0            0     1507.021      843.778 
      CELL61            0            0            0            0            0            0            0            0            0            0        0.048        0.197            0            0       24.884            0            0            0            0            0            0            0            0            0            0            0     5474.766     2423.939 
      CELL62            0            0            0            0            0            0            0            0            0            0        0.112        0.459            0            0       57.907            0            0            0            0            0            0            0            0            0            0            0     5672.867     3779.309 
      CELL63            0            0            0            0            0            0            0            0            0            0        0.078        0.319            0            0       40.176            0            0            0            0            0            0            0            0            0            0            0     5905.598     2902.325 
      CELL64            0            0            0            0            0            0            0            0            0            0        0.099        0.406            0            0       52.532            0            0            0            0            0            0            0            0            0            0            0     5040.294     1487.877 
      CELL65            0            0            0            0            0            0            0            0            0            0        0.028        0.116            0            0        14.92            0            0            0            0            0            0            0            0            0            0            0     5406.887     1252.853 
      CELL66            0            0            0            0            0            0            0            0            0            0        0.027        0.112            0            0        14.47            0            0            0            0            0            0            0            0            0            0            0     3843.896     1770.096 
      CELL67            0            0            0            0            0            0            0            0            0            0        0.041        0.169            0            0       22.483            0            0            0            0            0            0            0            0            0            0            0     3816.832     1289.243 
      CELL68            0            0            0            0            0            0            0            0            0            0        0.025        0.102            0            0       13.607            0            0            0            0            0            0            0            0            0            0            0     1848.031      211.293 
      CELL69            0            0            0            0            0            0            0            0            0            0        0.005         0.02            0            0        2.797            0            0            0            0            0            0            0            0            0            0            0       98.335      101.259 
      CELL70            0            0            0            0            0            0            0            0            0            0        0.013        0.053            0            0        7.253            0            0            0            0            0            0            0            0            0            0            0     1482.746     1176.853 
      CELL71            0            0            0            0            0            0            0            0            0            0        0.028        0.115            0            0       15.752            0            0            0            0            0            0            0            0            0            0            0     1397.398      411.683 
      CELL72            0            0            0            0            0            0            0            0            0            0        0.017        0.071            0            0        9.672            0            0            0            0            0            0            0            0            0            0            0     2748.815      648.464 
      CELL73            0            0            0            0            0            0            0            0            0            0        0.014        0.056            0            0        7.672            0            0            0            0            0            0            0            0            0            0            0     2177.543     1783.641 
      CELL74            0            0            0            0            0            0            0            0            0            0        0.089        0.365            0            0       45.789            0            0            0            0            0            0            0            0            0            0            0      722.057      496.212 
      CELL75            0            0            0            0            0            0            0            0            0            0        0.134         0.55            0            0        69.03            0            0            0            0            0            0            0            0            0            0            0     1220.711      906.882 
      CELL76            0            0            0            0            0            0            0            0            0            0        0.125        0.514            0            0       64.419            0            0            0            0            0            0            0            0            0            0            0      495.327      234.911 
      CELL77            0            0            0            0            0            0            0            0            0            0        0.102        0.417            0            0       52.337            0            0            0            0            0            0            0            0            0            0            0      853.145      223.715 
      CELL78            0            0            0            0            0            0            0            0            0            0        0.082        0.335            0            0       42.005            0            0            0            0            0            0            0            0            0            0            0     1803.266      703.386 
      CELL79            0            0            0            0            0            0            0            0            0            0        0.079        0.326            0            0       40.762            0            0            0            0            0            0            0            0            0            0            0     5465.628     3010.212 
      CELL80            0            0            0            0            0            0            0            0            0            0        0.132        0.544            0            0       68.507            0            0            0            0            0            0            0            0            0            0            0     5075.348     3477.023 
      CELL81            0            0            0            0            0            0            0            0            0            0        0.117         0.48            0            0       61.083            0            0            0            0            0            0            0            0            0            0            0     5067.264      3200.64 
      CELL82            0            0            0            0            0            0            0            0            0            0        0.091        0.372            0            0         47.4            0            0            0            0            0            0            0            0            0            0            0     5457.223     4166.971 
      CELL83            0            0            0            0            0            0            0            0            0            0        0.046         0.19            0            0        24.41            0            0            0            0            0            0            0            0            0            0            0     5964.198     3422.587 
      CELL84            0            0            0            0            0            0            0            0            0            0        0.065        0.268            0            0       34.443            0            0            0            0            0            0            0            0            0            0            0     6068.221     2806.298 
      CELL85            0            0            0            0            0            0            0            0            0            0        0.067        0.276            0            0       35.802            0            0            0            0            0            0            0            0            0            0            0     4580.675     1278.065 
      CELL86            0            0            0            0            0            0            0            0            0            0        0.019        0.078            0            0        10.19            0            0            0            0            0            0            0            0            0            0            0     1379.797      154.915 
      CELL87            0            0            0            0            0            0            0            0            0            0            0        0.136            0            0            0            0            0            0            0            0            0            0            0            0            0            0      574.369        30.69 
      CELL88            0            0            0            0            0            0            0            0            0            0            0        0.183            0            0            0            0            0            0            0            0            0            0            0            0            0            0      278.776        8.631 
      CELL89            0            0            0            0            0            0            0            0            0            0        0.048        0.196            0            0       26.595            0            0            0            0            0            0            0            0            0            0            0      642.306        251.1 
      CELL90            0            0            0            0            0            0            0            0            0            0        0.037        0.152            0            0       20.644            0            0            0            0            0            0            0            0            0            0            0      176.989      182.262 
      CELL91            0            0            0            0            0            0            0            0            0            0        0.034        0.138            0            0       18.846            0            0            0            0            0            0            0            0            0            0            0       411.74      268.511 
      CELL92            0            0            0            0            0            0            0            0            0            0        0.011        0.045            0            0        6.122            0            0            0            0            0            0            0            0            0            0            0       36.881        30.27 
      CELL93            0            0            0            0            0            0            0            0            0            0        0.196        0.806            0            0      101.431            0            0            0            0            0            0            0            0            0            0            0     2022.031      902.044 
      CELL94            0            0            0            0            0            0            0            0            0            0         0.18        0.738            0            0        92.81            0            0            0            0            0            0            0            0            0            0            0     5796.925      2901.69 
      CELL95            0            0            0            0            0            0            0            0            0            0        0.134         0.55            0            0       69.147            0            0            0            0            0            0            0            0            0            0            0     6136.035     2457.856 
      CELL96            0            0            0            0            0            0            0            0            0            0        0.156        0.642            0            0       80.616            0            0            0            0            0            0            0            0            0            0            0      5926.68      3357.22 
      CELL97            0            0            0            0            0            0            0            0            0            0        0.132        0.544            0            0       68.298            0            0            0            0            0            0            0            0            0            0            0     5092.241     2483.144 
      CELL98            0            0            0            0            0            0            0            0            0            0        0.142        0.581            0            0       72.972            0            0            0            0            0            0            0            0            0            0            0     6510.754     3783.165 
      CELL99            0            0            0            0            0            0            0            0            0            0        0.117         0.48            0            0       60.554            0            0            0            0            0            0            0            0            0            0            0     6068.982     2953.528 
     CELL100            0            0            0            0            0            0            0            0            0            0        0.147        0.605            0            0       76.373            0            0            0            0            0            0            0            0            0            0            0     6328.553     3816.692 
     CELL101            0            0            0            0            0            0            0            0            0            0        0.129        0.531            0            0       66.949            0            0            0            0            0            0            0            0            0            0            0     4507.863     3135.893 
     CELL102            0            0            0            0            0            0            0            0            0            0        0.139        0.571            0            0       72.036            0            0            0            0            0            0            0            0            0            0            0     3618.899     3646.079 
     CELL103            0            0            0            0            0            0            0            0            0            0         0.12        0.493            0            0       63.333            0            0            0            0            0            0            0            0            0            0            0     5226.407     3395.268 
     CELL104            0            0            0            0            0            0            0            0            0            0        0.118        0.484            0            0       62.229            0            0            0            0            0            0            0            0            0            0            0     5938.965     3091.788 
     CELL105            0            0            0            0            0            0            0            0            0            0        0.099        0.406            0            0       52.184            0            0            0            0            0            0            0            0            0            0            0     6160.326     3788.196 
     CELL106            0            0            0            0            0            0            0            0            0            0        0.053        0.217            0            0       28.154            0            0            0            0            0            0            0            0            0            0            0     4748.127     2332.127 
     CELL107            0            0            0            0            0            0            0            0            0            0        0.032        0.132            0            0       17.436            0            0            0            0            0            0            0            0            0            0            0     4396.852     2312.353 
     CELL108            0            0            0            0            0            0            0            0            0            0        0.044        0.182            0            0       24.732            0            0            0            0            0            0            0            0            0            0            0     1985.432     1804.926 
     CELL109            0            0            0            0            0            0            0            0            0            0        0.061        0.251            0            0       34.159            0            0            0            0            0            0            0            0            0            0            0      827.572      852.206 
     CELL110            0            0            0            0            0            0            0            0            0            0        0.056        0.228            0            0       30.961            0            0            0            0            0            0            0            0            0            0            0      612.842      479.906 
     CELL111            0            0            0            0            0            0            0            0            0            0        0.206        0.848            0            0      106.771            0            0            0            0            0            0            0            0            0            0            0       170.82       78.438 
     CELL112            0            0            0            0            0            0            0            0            0            0         0.12        0.494            0            0       62.281            0            0            0            0            0            0            0            0            0            0            0     4511.815     2189.266 
     CELL113            0            0            0            0            0            0            0            0            0            0         0.18        0.739            0            0       93.127            0            0            0            0            0            0            0            0            0            0            0     6026.199     2490.464 
     CELL114            0            0            0            0            0            0            0            0            0            0        0.157        0.645            0            0       80.975            0            0            0            0            0            0            0            0            0            0            0      6177.09     3649.957 
     CELL115            0            0            0            0            0            0            0            0            0            0        0.066        0.273            0            0       34.629            0            0            0            0            0            0            0            0            0            0            0     6438.202     3481.162 
     CELL116            0            0            0            0            0            0            0            0            0            0        0.174        0.713            0            0       89.664            0            0            0            0            0            0            0            0            0            0            0     6390.965     3311.144 
     CELL117            0            0            0            0            0            0            0            0            0            0        0.086        0.352            0            0       44.184            0            0            0            0            0            0            0            0            0            0            0     6535.312     2990.699 
     CELL118            0            0            0            0            0            0            0            0            0            0        0.142        0.585            0            0       74.489            0            0            0            0            0            0            0            0            0            0            0      6474.42     4596.114 
     CELL119            0            0            0            0            0            0            0            0            0            0        0.151        0.619            0            0       78.317            0            0            0            0            0            0            0            0            0            0            0     6487.343     3972.489 
     CELL120            0            0            0            0            0            0            0            0            0            0         0.07        0.286            0            0       36.157            0            0            0            0            0            0            0            0            0            0            0     6421.504     3464.478 
     CELL121            0            0            0            0            0            0            0            0            0            0        0.069        0.284            0            0       36.183            0            0            0            0            0            0            0            0            0            0            0      6149.67     3476.483 
     CELL122            0            0            0            0            0            0            0            0            0            0        0.113        0.461            0            0       58.781            0            0            0            0            0            0            0            0            0            0            0     5724.585     2919.242 
     CELL123            0            0            0            0            0            0            0            0            0            0        0.058        0.238            0            0       30.619            0            0            0            0            0            0            0            0            0            0            0     5991.101     3352.975 
     CELL124            0            0            0            0            0            0            0            0            0            0        0.096        0.392            0            0       50.791            0            0            0            0            0            0            0            0            0            0            0     6160.902     2491.537 
     CELL125            0            0            0            0            0            0            0            0            0            0        0.058        0.236            0            0       30.688            0            0            0            0            0            0            0            0            0            0            0     5273.305     2653.957 
     CELL126            0            0            0            0            0            0            0            0            0            0        0.053        0.215            0            0       29.004            0            0            0            0            0            0            0            0            0            0            0     2217.783      1206.96 
     CELL127            0            0            0            0            0            0            0            0            0            0         0.06        0.245            0            0        33.33            0            0            0            0            0            0            0            0            0            0            0     2825.394     1616.365 
     CELL128            0            0            0            0            0            0            0            0            0            0         0.02        0.083            0            0       11.321            0            0            0            0            0            0            0            0            0            0            0      2502.93       1381.1 
     CELL129            0            0            0            0            0            0            0            0            0            0            0        0.109            0            0            0            0            0            0            0            0            0            0            0            0            0            0       421.22      183.297 
     CELL130            0            0            0            0            0            0            0            0            0            0        0.107        0.438            0            0       55.134            0            0            0            0            0            0            0            0            0            0            0     1490.241      484.928 
     CELL131            0            0            0            0            0            0            0            0            0            0        0.189        0.775            0            0       97.467            0            0            0            0            0            0            0            0            0            0            0     3985.485       2059.7 
     CELL132            0            0            0            0            0            0            0            0            0            0        0.194        0.796            0            0      100.061            0            0            0            0            0            0            0            0            0            0            0     6010.569     3948.122 
     CELL133            0            0            0            0            0            0            0            0            0            0        0.116        0.478            0            0       60.142            0            0            0            0            0            0            0            0            0            0            0     6238.851     3313.787 
     CELL134            0            0            0            0            0            0            0            0            0            0        0.155        0.637            0            0       80.119            0            0            0            0            0            0            0            0            0            0            0     6471.808     2728.492 
     CELL135            0            0            0            0            0            0            0            0            0            0        0.183        0.749            0            0       94.179            0            0            0            0            0            0            0            0            0            0            0     6396.666     3563.578 
     CELL136            0            0            0            0            0            0            0            0            0            0        0.161        0.658            0            0       82.673            0            0            0            0            0            0            0            0            0            0            0     6414.789     4746.195 
     CELL137            0            0            0            0            0            0            0            0            0            0        0.109        0.448            0            0       56.695            0            0            0            0            0            0            0            0            0            0            0     6486.199     3176.982 
     CELL138            0            0            0            0            0            0            0            0            0            0        0.072        0.297            0            0       37.852            0            0            0            0            0            0            0            0            0            0            0     6545.949     3071.894 
     CELL139            0            0            0            0            0            0            0            0            0            0         0.05        0.204            0            0       26.271            0            0            0            0            0            0            0            0            0            0            0     6136.863     3453.211 
     CELL140            0            0            0            0            0            0            0            0            0            0        0.075        0.307            0            0       39.186            0            0            0            0            0            0            0            0            0            0            0     6115.436     3457.866 
     CELL141            0            0            0            0            0            0            0            0            0            0        0.105        0.431            0            0       54.986            0            0            0            0            0            0            0            0            0            0            0     5895.084     4014.356 
     CELL142            0            0            0            0            0            0            0            0            0            0        0.041        0.169            0            0       21.713            0            0            0            0            0            0            0            0            0            0            0     6044.256     3165.493 
     CELL143            0            0            0            0            0            0            0            0            0            0         0.08        0.329            0            0       43.476            0            0            0            0            0            0            0            0            0            0            0     5962.058     3089.609 
     CELL144            0            0            0            0            0            0            0            0            0            0        0.061        0.248            0            0       33.388            0            0            0            0            0            0            0            0            0            0            0     2381.376      993.335 
     CELL145            0            0            0            0            0            0            0            0            0            0        0.045        0.184            0            0       25.081            0            0            0            0            0            0            0            0            0            0            0     2054.169      384.702 
     CELL146            0            0            0            0            0            0            0            0            0            0        0.046        0.189            0            0       26.059            0            0            0            0            0            0            0            0            0            0            0     1029.011      288.126 
     CELL147            0            0            0            0            0            0            0            0            0            0            0        0.204            0            0            0            0            0            0            0            0            0            0            0            0            0            0        7.727        8.201 
     CELL148            0            0            0            0            0            0            0            0            0            0        0.212        0.869            0            0      109.344            0            0            0            0            0            0            0            0            0            0            0     2762.142     2439.108 
     CELL149            0            0            0            0            0            0            0            0            0            0         0.21        0.861            0            0      108.217            0            0            0            0            0            0            0            0            0            0            0     5540.768     4392.245 
     CELL150            0            0            0            0            0            0            0            0            0            0        0.197        0.807            0            0      101.446            0            0            0            0            0            0            0            0            0            0            0      6353.77     3621.009 
     CELL151            0            0            0            0            0            0            0            0            0            0         0.18        0.738            0            0       92.702            0            0            0            0            0            0            0            0            0            0            0     6427.934     3632.807 
     CELL152            0            0            0            0            0            0            0            0            0            0        0.163        0.666            0            0       84.366            0            0            0            0            0            0            0            0            0            0            0     6478.862     3219.586 
     CELL153            0            0            0            0            0            0            0            0            0            0        0.087        0.357            0            0       45.246            0            0            0            0            0            0            0            0            0            0            0     6552.945      2744.54 
     CELL154            0            0            0            0            0            0            0            0            0            0        0.064        0.262            0            0       33.446            0            0            0            0            0            0            0            0            0            0            0      6501.57     2758.717 
     CELL155            0            0            0            0            0            0            0            0            0            0         0.07        0.287            0            0       36.936            0            0            0            0            0            0            0            0            0            0            0     6534.894     2434.117 
     CELL156            0            0            0            0            0            0            0            0            0            0         0.03        0.121            0            0       15.593            0            0            0            0            0            0            0            0            0            0            0     6248.796     3593.207 
     CELL157            0            0            0            0            0            0            0            0            0            0        0.089        0.366            0            0       47.558            0            0            0            0            0            0            0            0            0            0            0     5704.596     4381.882 
     CELL158            0            0            0            0            0            0            0            0            0            0         0.09        0.366            0            0       47.624            0            0            0            0            0            0            0            0            0            0            0     6093.617     4196.429 
     CELL159            0            0            0            0            0            0            0            0            0            0         0.07        0.288            0            0       37.775            0            0            0            0            0            0            0            0            0            0            0     5861.067     4201.585 
     CELL160            0            0            0            0            0            0            0            0            0            0        0.041        0.168            0            0       22.702            0            0            0            0            0            0            0            0            0            0            0     2467.841     2043.336 
     CELL161            0            0            0            0            0            0            0            0            0            0            0        0.223            0            0            0            0            0            0            0            0            0            0            0            0            0            0      199.886       76.648 
     CELL162            0            0            0            0            0            0            0            0            0            0         0.01        0.041            0            0        5.638            0            0            0            0            0            0            0            0            0            0            0       404.25      416.285 
     CELL163            0            0            0            0            0            0            0            0            0            0        0.204        0.837            0            0      105.253            0            0            0            0            0            0            0            0            0            0            0     2339.672      875.753 
     CELL164            0            0            0            0            0            0            0            0            0            0        0.153        0.628            0            0       78.906            0            0            0            0            0            0            0            0            0            0            0     5511.495      943.258 
     CELL165            0            0            0            0            0            0            0            0            0            0        0.156         0.64            0            0       80.547            0            0            0            0            0            0            0            0            0            0            0       6487.7     3140.811 
     CELL166            0            0            0            0            0            0            0            0            0            0        0.126        0.516            0            0       65.436            0            0            0            0            0            0            0            0            0            0            0     6445.852     1975.813 
     CELL167            0            0            0            0            0            0            0            0            0            0        0.102        0.417            0            0       52.815            0            0            0            0            0            0            0            0            0            0            0     6562.762     1894.288 
     CELL168            0            0            0            0            0            0            0            0            0            0        0.047        0.191            0            0       24.269            0            0            0            0            0            0            0            0            0            0            0     6592.339     1256.344 
     CELL169            0            0            0            0            0            0            0            0            0            0        0.073        0.297            0            0       37.952            0            0            0            0            0            0            0            0            0            0            0     6523.402     2242.663 
     CELL170            0            0            0            0            0            0            0            0            0            0        0.036        0.145            0            0        18.75            0            0            0            0            0            0            0            0            0            0            0     6315.183     3077.077 
     CELL171            0            0            0            0            0            0            0            0            0            0        0.082        0.337            0            0       43.795            0            0            0            0            0            0            0            0            0            0            0      6148.77     3366.814 
     CELL172            0            0            0            0            0            0            0            0            0            0        0.055        0.223            0            0       29.243            0            0            0            0            0            0            0            0            0            0            0     6123.557     2422.968 
     CELL173            0            0            0            0            0            0            0            0            0            0        0.072        0.293            0            0       38.562            0            0            0            0            0            0            0            0            0            0            0     5844.157     3282.859 
     CELL174            0            0            0            0            0            0            0            0            0            0        0.049        0.199            0            0       26.585            0            0            0            0            0            0            0            0            0            0            0     4193.218     3204.207 
     CELL175            0            0            0            0            0            0            0            0            0            0            0        0.815            0            0            0            0            0            0            0            0            0            0            0            0            0            0      112.744       25.348 
     CELL176            0            0            0            0            0            0            0            0            0            0            0        0.681            0            0            0            0            0            0            0            0            0            0            0            0            0            0      805.661        44.23 
     CELL177            0            0            0            0            0            0            0            0            0            0        0.143        0.586            0            0       73.748            0            0            0            0            0            0            0            0            0            0            0     2733.745       412.72 
     CELL178            0            0            0            0            0            0            0            0            0            0        0.155        0.634            0            0       79.843            0            0            0            0            0            0            0            0            0            0            0     6019.833     1029.617 
     CELL179            0            0            0            0            0            0            0            0            0            0        0.133        0.542            0            0        68.81            0            0            0            0            0            0            0            0            0            0            0     6025.181     1031.777 
     CELL180            0            0            0            0            0            0            0            0            0            0        0.066        0.271            0            0       34.713            0            0            0            0            0            0            0            0            0            0            0     6311.109      1135.65 
     CELL181            0            0            0            0            0            0            0            0            0            0        0.044        0.179            0            0       22.826            0            0            0            0            0            0            0            0            0            0            0     6567.754     2502.691 
     CELL182            0            0            0            0            0            0            0            0            0            0        0.102        0.419            0            0       53.986            0            0            0            0            0            0            0            0            0            0            0     6377.158     3905.801 
     CELL183            0            0            0            0            0            0            0            0            0            0        0.058        0.237            0            0       30.645            0            0            0            0            0            0            0            0            0            0            0     6290.245     4995.489 
     CELL184            0            0            0            0            0            0            0            0            0            0        0.032        0.131            0            0       17.115            0            0            0            0            0            0            0            0            0            0            0     6011.461     4294.553 
     CELL185            0            0            0            0            0            0            0            0            0            0        0.036        0.148            0            0       19.509            0            0            0            0            0            0            0            0            0            0            0     5881.089      4520.01 
     CELL186            0            0            0            0            0            0            0            0            0            0        0.074        0.303            0            0        40.18            0            0            0            0            0            0            0            0            0            0            0     4950.551     3606.121 
     CELL187            0            0            0            0            0            0            0            0            0            0        0.082        0.335            0            0       42.206            0            0            0            0            0            0            0            0            0            0            0      126.531       26.267 
     CELL188            0            0            0            0            0            0            0            0            0            0         0.15        0.612            0            0       77.062            0            0            0            0            0            0            0            0            0            0            0      126.994       16.971 
     CELL189            0            0            0            0            0            0            0            0            0            0        0.091        0.373            0            0        47.43            0            0            0            0            0            0            0            0            0            0            0      251.979       23.211 
     CELL190            0            0            0            0            0            0            0            0            0            0        0.062        0.252            0            0       32.315            0            0            0            0            0            0            0            0            0            0            0      1151.53      363.467 
     CELL191            0            0            0            0            0            0            0            0            0            0        0.108        0.441            0            0       56.887            0            0            0            0            0            0            0            0            0            0            0     4942.795     2145.792 
     CELL192            0            0            0            0            0            0            0            0            0            0        0.052        0.211            0            0       27.565            0            0            0            0            0            0            0            0            0            0            0     6368.978     4015.247 
     CELL193            0            0            0            0            0            0            0            0            0            0        0.083        0.339            0            0       44.285            0            0            0            0            0            0            0            0            0            0            0     5934.177     4249.829 
     CELL194            0            0            0            0            0            0            0            0            0            0        0.082        0.333            0            0       43.839            0            0            0            0            0            0            0            0            0            0            0     5608.996     4720.947 
     CELL195            0            0            0            0            0            0            0            0            0            0        0.025        0.103            0            0       13.614            0            0            0            0            0            0            0            0            0            0            0     5331.716     3598.024 
     CELL196            0            0            0            0            0            0            0            0            0            0        0.084        0.341            0            0       45.779            0            0            0            0            0            0            0            0            0            0            0     2851.203     2323.304 
     CELL197            0            0            0            0            0            0            0            0            0            0        0.081         0.33            0            0       43.024            0            0            0            0            0            0            0            0            0            0            0     5285.237     2505.327 
     CELL198            0            0            0            0            0            0            0            0            0            0        0.065        0.263            0            0       34.303            0            0            0            0            0            0            0            0            0            0            0     5165.397     3349.042 
     CELL199            0            0            0            0            0            0            0            0            0            0        0.105        0.426            0            0       56.159            0            0            0            0            0            0            0            0            0            0            0      2207.52     1501.131 
     CELL200            0            0            0            0            0            0            0            0            0            0        0.044         0.18            0            0       23.683            0            0            0            0            0            0            0            0            0            0            0     4174.692     3534.097 
     CELL201            0            0            0            0            0            0            0            0            0            0         0.06        0.246            0            0        33.28            0            0            0            0            0            0            0            0            0            0            0     2406.818     2243.225 
     CELL202            0            0            0            0            0            0            0            0            0            0        0.074        0.302            0            0       39.066            0            0            0            0            0            0            0            0            0            0            0      386.834      158.909 
     CELL203            0            0            0            0            0            0            0            0            0            0        0.058        0.237            0            0       31.287            0            0            0            0            0            0            0            0            0            0            0      259.425      155.453 
    TOTAL_AR            0            0            0            0            0            0            0            0            0            0           15           64            0            0     7864.675            0            0            0            0            0            0            0            0            0            0            0 
;

*==============================================================================*
*------------------------------- List of parameters----------------------------*

PARAMETER
  OLDMAT(I,J)        A priori (non adjusted) distribution matrix
  NEWMAT(I,J)        Adjusted matrix
  ZSOL(I2,J2)        Solution values of ZED
  EPSILON            Lower bound on ZED to prevent log(0) and divisions by zero

*==============================================================================*
*-------------------------------- Variable names ------------------------------*

VARIABLE
  ZED(I2,J2)    Correction factors to be applied to the elements of OLDMAT
  OBJ           Objective function
;

* It is not sufficient to declare ZED as a positive variable. It must have a
* lower bound, defined below as EPSILON

*==============================================================================*
*------------------------------- Value assignments ----------------------------*

  OLDMAT(I,J) = DATA(I,J) ;

*  Display "INITIAL VALUES:", OLDMAT ;

  EPSILON=0.000001;

*==============================================================================*
*---------------------------------- Equations ---------------------------------*

EQUATIONS
  EQROW(I2)    Constraint on the adjusted row totals
  EQIRRROW(I2) Constraint on adjusted irrigated row totals
  EQCOL(J2)    Constraint on the adjusted column totals
  EQOBJ        Objective function
  ;

  EQROW(I2)..    SUM(J2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =L= OLDMAT(I2,"CRPLND_AR") ;
                    
  EQIRRROW(I2).. SUM(J3,OLDMAT(I2,J3)*ZED(I2,J3))
                    =L= OLDMAT(I2,"IRRI_AR");
                    
  EQCOL(J2)..    SUM(I2,OLDMAT(I2,J2)*ZED(I2,J2))
                    =E= OLDMAT("TOTAL_AR",J2) ;

* The objective function is defined below:
* the specification minimizes cross-entropy (Kullback-Leibler measure),
* that is, information gain.

   EQOBJ..       OBJ =E=
                  SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)*log(ZED(I2,J2)))
                  / SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2))
                  -log(SUM((I2,J2),ABS(OLDMAT(I2,J2))*ZED(I2,J2)))
                  +log(SUM((I2,J2),ABS(OLDMAT(I2,J2))));

*==============================================================================*
*---------------------------- Model definition --------------------------------*
MODEL ADJUS /ALL/;

*==============================================================================*
*------------------------- Initial value assignment ---------------------------*

* The lower bound assigned to ZED guarantees that there will be no log(0)
  ZED.LO(I2,J2) = EPSILON ;

* Initial value of ZED is set to the ratio of the sum of target marginal row
* totals to the sum of old matrix elements.
  ZED.L(I2,J2) = SUM(I2J,OLDMAT(I2J,"CRPLND_AR")) / SUM((I2J,J2J),OLDMAT(I2J,J2J));
  DISPLAY ZED.L ;

*==============================================================================*
*--------------------------Solution of the problem ----------------------------*

OPTION ITERLIM=100000;
* The following option limits to 5 the number of decimals
* in DISPLAY statement output only.
OPTION DECIMALS=5;
* It is preferable to use the solver CONOPT, which has a greater precision
* than MINOS5
OPTION NLP=CONOPT3;
SOLVE ADJUS USING NLP MINIMIZING OBJ;

*==============================================================================*
*                                  RESULTS
*---------------------- Calculation of adjusted matrix ------------------------*

  NEWMAT(I2,J2) = OLDMAT(I2,J2)*ZED.L(I2,J2) ;

* It is convenient to include row and column totals in NEWMAT
  NEWMAT("TOTAL_AR",J2) = SUM(I2,NEWMAT(I2,J2));
  NEWMAT(I2,"CRPLND_AR") = SUM(J2,NEWMAT(I2,J2));
  NEWMAT(I2,"IRRI_AR") = SUM(J3,NEWMAT(I2,J3));

  ZSOL(I2,J2)   = ZED.L(I2,J2) ;

  Acronym zero;
  NEWMAT(I,J)$(Not NEWMAT(I,J)) = zero;
  Display "&START NEW MATRIX";
  DISPLAY NEWMAT;
  DISPLAY "&END NEW MATRIX";
*  Display ZSOL;

]]></model>
<options><![CDATA[]]></options>
<gdx><![CDATA[]]></gdx>
<comments><![CDATA[]]></comments>
</document>
